From 420461d552ad3989a65385b2f735f6580dc27436 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:15:57 +0200
Subject: [PATCH 001/376] Step 0.2: Remove project files

---
 client/main.css  |  1 -
 client/main.html | 25 -------------------------
 client/main.js   | 22 ----------------------
 server/main.js   |  5 -----
 4 files changed, 53 deletions(-)
 delete mode 100644 client/main.css
 delete mode 100644 client/main.html
 delete mode 100644 client/main.js
 delete mode 100644 server/main.js

diff --git a/client/main.css b/client/main.css
deleted file mode 100644
index b6b4052..0000000
--- a/client/main.css
+++ /dev/null
@@ -1 +0,0 @@
-/* CSS declarations go here */
diff --git a/client/main.html b/client/main.html
deleted file mode 100644
index 203539b..0000000
--- a/client/main.html
+++ /dev/null
@@ -1,25 +0,0 @@
-<head>
-  <title>simple</title>
-</head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-  {{> info}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
-
-<template name="info">
-  <h2>Learn Meteor!</h2>
-  <ul>
-    <li><a href="https://www.meteor.com/try">Do the Tutorial</a></li>
-    <li><a href="http://guide.meteor.com">Follow the Guide</a></li>
-    <li><a href="https://docs.meteor.com">Read the Docs</a></li>
-    <li><a href="https://forums.meteor.com">Discussions</a></li>
-  </ul>
-</template>
\ No newline at end of file
diff --git a/client/main.js b/client/main.js
deleted file mode 100644
index ecb3282..0000000
--- a/client/main.js
+++ /dev/null
@@ -1,22 +0,0 @@
-import { Template } from 'meteor/templating';
-import { ReactiveVar } from 'meteor/reactive-var';
-
-import './main.html';
-
-Template.hello.onCreated(function helloOnCreated() {
-  // counter starts at 0
-  this.counter = new ReactiveVar(0);
-});
-
-Template.hello.helpers({
-  counter() {
-    return Template.instance().counter.get();
-  },
-});
-
-Template.hello.events({
-  'click button'(event, instance) {
-    // increment the counter when button is clicked
-    instance.counter.set(instance.counter.get() + 1);
-  },
-});
diff --git a/server/main.js b/server/main.js
deleted file mode 100644
index 31a9e0e..0000000
--- a/server/main.js
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Meteor } from 'meteor/meteor';
-
-Meteor.startup(() => {
-  // code to run on server at startup
-});
-- 
2.7.4


From cb7f716926bada91e1ade2d2fe201e0af49036ca Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:29:56 +0200
Subject: [PATCH 002/376] Step 0.3: Create an empty html file

---
 client/index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..ef412ef
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,3 @@
+<body>
+  <p>Nothing here</p>
+</body>
-- 
2.7.4


From b3768c3c558fdc7cab8b57112758806e9ae41e4d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:33:17 +0200
Subject: [PATCH 003/376] Step 0.4: Remove `blaze-html-templates` and
 `ecmascript`

---
 .meteor/packages | 2 --
 .meteor/versions | 5 -----
 2 files changed, 7 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index d4c8001..c370be2 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -7,7 +7,6 @@
 meteor-base             # Packages every Meteor app needs to have
 mobile-experience       # Packages for a great mobile UX
 mongo                   # The database Meteor supports right now
-blaze-html-templates    # Compile .html files into Meteor Blaze views
 reactive-var            # Reactive variable for tracker
 jquery                  # Helpful client-side library
 tracker                 # Meteor's client-side reactive programming library
@@ -15,7 +14,6 @@ tracker                 # Meteor's client-side reactive programming library
 standard-minifier-css   # CSS minifier run for production mode
 standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
-ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
diff --git a/.meteor/versions b/.meteor/versions
index 726e24a..e2742f2 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -6,11 +6,8 @@ babel-runtime@0.1.8
 base64@1.0.8
 binary-heap@1.0.8
 blaze@2.1.7
-blaze-html-templates@1.0.4
 blaze-tools@1.0.8
 boilerplate-generator@1.0.8
-caching-compiler@1.0.4
-caching-html-compiler@1.0.6
 callback-hook@1.0.8
 check@1.2.1
 ddp@1.2.5
@@ -59,8 +56,6 @@ spacebars@1.0.11
 spacebars-compiler@1.0.11
 standard-minifier-css@1.0.6
 standard-minifier-js@1.0.6
-templating@1.1.9
-templating-tools@1.0.4
 tracker@1.0.13
 ui@1.0.11
 underscore@1.0.8
-- 
2.7.4


From c861de6ffd11733cd0781350820f5457b75a9971 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:35:22 +0200
Subject: [PATCH 004/376] Step 0.5: Add `angular-templates` and
 `pbastowski:angular-babel`

---
 .meteor/packages | 2 ++
 .meteor/versions | 5 +++++
 2 files changed, 7 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c370be2..d74ee49 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,3 +17,5 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+pbastowski:angular-babel
+angular-templates
diff --git a/.meteor/versions b/.meteor/versions
index e2742f2..5a2d576 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,4 +1,5 @@
 allow-deny@1.0.4
+angular-templates@1.0.2
 autopublish@1.0.7
 autoupdate@1.2.8
 babel-compiler@6.6.4
@@ -8,6 +9,8 @@ binary-heap@1.0.8
 blaze@2.1.7
 blaze-tools@1.0.8
 boilerplate-generator@1.0.8
+caching-compiler@1.0.2
+caching-html-compiler@1.0.4
 callback-hook@1.0.8
 check@1.2.1
 ddp@1.2.5
@@ -46,6 +49,7 @@ mongo-id@1.0.4
 npm-mongo@1.4.43
 observe-sequence@1.0.11
 ordered-dict@1.0.7
+pbastowski:angular-babel@1.3.2
 promise@0.6.7
 random@1.0.9
 reactive-var@1.0.9
@@ -56,6 +60,7 @@ spacebars@1.0.11
 spacebars-compiler@1.0.11
 standard-minifier-css@1.0.6
 standard-minifier-js@1.0.6
+templating-tools@1.0.2
 tracker@1.0.13
 ui@1.0.11
 underscore@1.0.8
-- 
2.7.4


From 99de3c6106411ea9832b5d8e035331ce2dab1515 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:36:09 +0200
Subject: [PATCH 005/376] Step 0.6: Add `angular` and `angular-meteor`

---
 package.json | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/package.json b/package.json
index 196e6e1..1fdb919 100644
--- a/package.json
+++ b/package.json
@@ -5,6 +5,8 @@
     "start": "meteor run"
   },
   "dependencies": {
+    "angular": "^1.5.3",
+    "angular-meteor": "^1.3.9",
     "meteor-node-stubs": "~0.2.0"
   }
 }
-- 
2.7.4


From f9e96ca567a99c08fc70031090c2dec472bfad12 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:38:27 +0200
Subject: [PATCH 006/376] Step 0.7: Move the main content to a new file

---
 client/main.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/main.html

diff --git a/client/main.html b/client/main.html
new file mode 100644
index 0000000..79ed426
--- /dev/null
+++ b/client/main.html
@@ -0,0 +1 @@
+<p>Nothing here</p>
-- 
2.7.4


From aabd9f2dd1087db12624ac0336b5eccc8a8e8759 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:39:02 +0200
Subject: [PATCH 007/376] Step 0.8: Add `ng-include` that loads the main.html
 file

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index ef412ef..6378317 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
 <body>
-  <p>Nothing here</p>
+  <div ng-include src="'client/main.html'"></div>
 </body>
-- 
2.7.4


From 3f79556fd5db89211ae7a51ddce6b372aeb93d04 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:41:54 +0200
Subject: [PATCH 008/376] Step 0.9: Add main.js with angular module

---
 client/main.js | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 client/main.js

diff --git a/client/main.js b/client/main.js
new file mode 100644
index 0000000..558ad57
--- /dev/null
+++ b/client/main.js
@@ -0,0 +1,6 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+angular.module('socially', [
+  angularMeteor
+]);
-- 
2.7.4


From 226031a7f4ffd3d2a832216fe8e0a003145639c9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:42:29 +0200
Subject: [PATCH 009/376] Step 0.10: Add usage of `ng-app` in our app

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 6378317..f6b9ac4 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
-<body>
+<body ng-app="socially">
   <div ng-include src="'client/main.html'"></div>
 </body>
-- 
2.7.4


From 5cac3265abbad339284e93b49225d4de0ad816b1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:47:16 +0200
Subject: [PATCH 010/376] Step 0.11: Add some AngularJS code !

---
 client/main.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/main.html b/client/main.html
index 79ed426..a9c8ddc 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1 +1 @@
-<p>Nothing here</p>
+<p>Nothing here {{ 'yet' + '!' }}</p>
-- 
2.7.4


From fd8645a936979e3a762b50fd2c099ad9c11cac8d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:48:04 +0200
Subject: [PATCH 011/376] Step 1.1: Add some static HTML the to main page

---
 client/main.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/client/main.html b/client/main.html
index a9c8ddc..dd1ef68 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
-- 
2.7.4


From 2b538ab6bac82016cfc49327735590c63bd461c7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:49:31 +0200
Subject: [PATCH 012/376] Step 2.1: Use dynamic template instead of static

---
 client/main.html | 22 ++++++++--------------
 1 file changed, 8 insertions(+), 14 deletions(-)

diff --git a/client/main.html b/client/main.html
index dd1ef68..7f8c6d9 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1,14 +1,8 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
+<div ng-controller="PartiesListCtrl">
+  <ul>
+    <li ng-repeat="party in parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+    </li>
+  </ul>
+</div>
-- 
2.7.4


From 4fa6c20afbe54b9429a7081dca525a3153c04dd6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:50:30 +0200
Subject: [PATCH 013/376] Step 2.2: Add the parties controller

---
 client/main.js | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

diff --git a/client/main.js b/client/main.js
index 558ad57..abc441c 100644
--- a/client/main.js
+++ b/client/main.js
@@ -2,5 +2,17 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 angular.module('socially', [
-  angularMeteor
-]);
+    angularMeteor
+  ])
+  .controller('PartiesListCtrl', ['$scope', function($scope) {
+    $scope.parties = [{
+      'name': 'Dubstep-Free Zone',
+      'description': 'Can we please just for an evening not listen to dubstep.'
+    }, {
+      'name': 'All dubstep all the time',
+      'description': 'Get it on!'
+    }, {
+      'name': 'Savage lounging',
+      'description': 'Leisure suit required. And only fiercest manners.'
+    }];
+  }]);
-- 
2.7.4


From 922ab39357fd941313a31a9c7ca3c1b55d4f6521 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:51:13 +0200
Subject: [PATCH 014/376] Step 2.3: Remove the DI manual decleration

---
 client/main.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/main.js b/client/main.js
index abc441c..feb14f8 100644
--- a/client/main.js
+++ b/client/main.js
@@ -4,7 +4,9 @@ import angularMeteor from 'angular-meteor';
 angular.module('socially', [
     angularMeteor
   ])
-  .controller('PartiesListCtrl', ['$scope', function($scope) {
+  .controller('PartiesListCtrl', function($scope) {
+    'ngInject';
+    
     $scope.parties = [{
       'name': 'Dubstep-Free Zone',
       'description': 'Can we please just for an evening not listen to dubstep.'
@@ -15,4 +17,4 @@ angular.module('socially', [
       'name': 'Savage lounging',
       'description': 'Leisure suit required. And only fiercest manners.'
     }];
-  }]);
+  });
-- 
2.7.4


From cefeff1799fc6268f077a1d9a10100d3f0f0792d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:51:56 +0200
Subject: [PATCH 015/376] Step 2.4: Add ng-strict-di directive to the app

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index f6b9ac4..48c2d09 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
-<body ng-app="socially">
+<body ng-app="socially" ng-strict-di="">
   <div ng-include src="'client/main.html'"></div>
 </body>
-- 
2.7.4


From 3325ec02c22da929d1f2e5fad51df185e245fab4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:56:08 +0200
Subject: [PATCH 016/376] Step 3.1: Add the parties collection

---
 collections/parties.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 collections/parties.js

diff --git a/collections/parties.js b/collections/parties.js
new file mode 100644
index 0000000..f78fa2c
--- /dev/null
+++ b/collections/parties.js
@@ -0,0 +1 @@
+Parties = new Mongo.Collection('parties');
-- 
2.7.4


From e5f7c93c00949ec05864768a985d7e8ec0662c58 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:56:46 +0200
Subject: [PATCH 017/376] Step 3.2: Add the parties collection helper

---
 client/main.js | 17 ++++++-----------
 1 file changed, 6 insertions(+), 11 deletions(-)

diff --git a/client/main.js b/client/main.js
index feb14f8..1b17ade 100644
--- a/client/main.js
+++ b/client/main.js
@@ -6,15 +6,10 @@ angular.module('socially', [
   ])
   .controller('PartiesListCtrl', function($scope) {
     'ngInject';
-    
-    $scope.parties = [{
-      'name': 'Dubstep-Free Zone',
-      'description': 'Can we please just for an evening not listen to dubstep.'
-    }, {
-      'name': 'All dubstep all the time',
-      'description': 'Get it on!'
-    }, {
-      'name': 'Savage lounging',
-      'description': 'Leisure suit required. And only fiercest manners.'
-    }];
+
+    $scope.helpers({
+      parties() {
+        return Parties.find({});
+      }
+    });
   });
-- 
2.7.4


From 918e61256f224de3285a9cd7bfbf2fd085a1cc05 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:00:24 +0200
Subject: [PATCH 018/376] Step 3.3: Add some data to the parties collection

---
 server/startup.js | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 server/startup.js

diff --git a/server/startup.js b/server/startup.js
new file mode 100644
index 0000000..ad3fd85
--- /dev/null
+++ b/server/startup.js
@@ -0,0 +1,18 @@
+Meteor.startup(() => {
+  if (Parties.find().count() === 0) {
+    const parties = [{
+      'name': 'Dubstep-Free Zone',
+      'description': 'Fast just got faster with Nexus S.'
+    }, {
+      'name': 'All dubstep all the time',
+      'description': 'Get it on!'
+    }, {
+      'name': 'Savage lounging',
+      'description': 'Leisure suit required. And only fiercest manners.'
+    }];
+
+    parties.forEach((party) => {
+      Parties.insert(party)
+    });
+  }
+});
-- 
2.7.4


From fb1e74b4167d580ca65f6e69e05441eca97d52ba Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:00:58 +0200
Subject: [PATCH 019/376] Step 3.4: Change to use controllerAs syntax

---
 client/main.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/main.html b/client/main.html
index 7f8c6d9..62eca58 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1,6 +1,6 @@
-<div ng-controller="PartiesListCtrl">
+<div ng-controller="PartiesListCtrl as vm">
   <ul>
-    <li ng-repeat="party in parties">
+    <li ng-repeat="party in vm.parties">
       {{party.name}}
       <p>{{party.description}}</p>
     </li>
-- 
2.7.4


From 4cfdf4574609be98fa62982ad93ac6cfd774e431 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:07:22 +0200
Subject: [PATCH 020/376] Step 3.5: Change the parties controller to use
 $reactive and `this` instead of `$scope`

---
 client/main.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/main.js b/client/main.js
index 1b17ade..58efe3e 100644
--- a/client/main.js
+++ b/client/main.js
@@ -4,10 +4,12 @@ import angularMeteor from 'angular-meteor';
 angular.module('socially', [
     angularMeteor
   ])
-  .controller('PartiesListCtrl', function($scope) {
+  .controller('PartiesListCtrl', function($scope, $reactive) {
     'ngInject';
 
-    $scope.helpers({
+    $reactive(this).attach($scope);
+
+    this.helpers({
       parties() {
         return Parties.find({});
       }
-- 
2.7.4


From 0a39c92a5e51edcd1ab54f5fd4fbd96737c805de Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:12:43 +0200
Subject: [PATCH 021/376] Step 3.6: Refactor PartiesListCtrl to be a component

---
 client/main.js | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

diff --git a/client/main.js b/client/main.js
index 58efe3e..a898321 100644
--- a/client/main.js
+++ b/client/main.js
@@ -4,14 +4,18 @@ import angularMeteor from 'angular-meteor';
 angular.module('socially', [
     angularMeteor
   ])
-  .controller('PartiesListCtrl', function($scope, $reactive) {
-    'ngInject';
+  .component('partiesList', {
+    templateUrl: 'client/partiesList.html',
+    controllerAs: 'partiesList',
+    controller($scope, $reactive) {
+      'ngInject';
 
-    $reactive(this).attach($scope);
+      $reactive(this).attach($scope);
 
-    this.helpers({
-      parties() {
-        return Parties.find({});
-      }
-    });
+      this.helpers({
+        parties() {
+          return Parties.find({});
+        }
+      });
+    }
   });
-- 
2.7.4


From 6b73e14a93b712a816408519ce9d961d136248dd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:13:37 +0200
Subject: [PATCH 022/376] Step 3.7: Change usage from controllerAs to
 components code-style - view

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 48c2d09..84f0ef3 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
 <body ng-app="socially" ng-strict-di="">
-  <div ng-include src="'client/main.html'"></div>
+  <parties-list></parties-list>
 </body>
-- 
2.7.4


From 517087e55276119dbe5afa000cafe3794702b6e4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:14:22 +0200
Subject: [PATCH 023/376] Step 3.8: Move the parties list to a different HTML
 file

---
 client/partiesList.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 client/partiesList.html

diff --git a/client/partiesList.html b/client/partiesList.html
new file mode 100644
index 0000000..64ac441
--- /dev/null
+++ b/client/partiesList.html
@@ -0,0 +1,6 @@
+<ul>
+  <li ng-repeat="party in partiesList.parties">
+    {{party.name}}
+    <p>{{party.description}}</p>
+  </li>
+</ul>
-- 
2.7.4


From e25949f6a484d6cec5a7aa96e4c5dc79f62b67cd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:25:52 +0200
Subject: [PATCH 024/376] Step 3.9: Move PartiesList to imports

---
 imports/ui/components/partiesList/partiesList.js | 27 ++++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 imports/ui/components/partiesList/partiesList.js

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
new file mode 100644
index 0000000..a5a8a27
--- /dev/null
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -0,0 +1,27 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+class PartiesList {
+  constructor($scope, $reactive) {
+    'ngInject';
+
+    $reactive(this).attach($scope);
+
+    this.helpers({
+      parties() {
+        return Parties.find({});
+      }
+    });
+  }
+}
+
+const name = 'partiesList';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  controller: PartiesList
+});
-- 
2.7.4


From bf88c45b5b1cf2f97477def337a1714bd2ec4717 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:26:25 +0200
Subject: [PATCH 025/376] Step 3.10: Move PartiesList view to imports

---
 imports/ui/components/partiesList/partiesList.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partiesList/partiesList.html

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
new file mode 100644
index 0000000..64ac441
--- /dev/null
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -0,0 +1,6 @@
+<ul>
+  <li ng-repeat="party in partiesList.parties">
+    {{party.name}}
+    <p>{{party.description}}</p>
+  </li>
+</ul>
-- 
2.7.4


From 0d2be7e34e07e5933be28b1c009d3c78dd42b70b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:27:59 +0200
Subject: [PATCH 026/376] Step 3.11: Use PartiesList from imports

---
 client/main.js | 22 +++++-----------------
 1 file changed, 5 insertions(+), 17 deletions(-)

diff --git a/client/main.js b/client/main.js
index a898321..d643c33 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,21 +1,9 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
-angular.module('socially', [
-    angularMeteor
-  ])
-  .component('partiesList', {
-    templateUrl: 'client/partiesList.html',
-    controllerAs: 'partiesList',
-    controller($scope, $reactive) {
-      'ngInject';
-
-      $reactive(this).attach($scope);
+import { name as PartiesList } from '../imports/ui/components/partiesList/partiesList';
 
-      this.helpers({
-        parties() {
-          return Parties.find({});
-        }
-      });
-    }
-  });
+angular.module('socially', [
+    angularMeteor,
+    PartiesList
+  ]);
-- 
2.7.4


From d1a9384deaae4a23b8ddd1136e874d1032d2a5af Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:28:46 +0200
Subject: [PATCH 027/376] Step 3.12: Remove old partiesList.html

---
 client/partiesList.html | 6 ------
 1 file changed, 6 deletions(-)
 delete mode 100644 client/partiesList.html

diff --git a/client/partiesList.html b/client/partiesList.html
deleted file mode 100644
index 64ac441..0000000
--- a/client/partiesList.html
+++ /dev/null
@@ -1,6 +0,0 @@
-<ul>
-  <li ng-repeat="party in partiesList.parties">
-    {{party.name}}
-    <p>{{party.description}}</p>
-  </li>
-</ul>
-- 
2.7.4


From ab915906a9c81b03a83c2f392541a8f1ce632951 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:29:23 +0200
Subject: [PATCH 028/376] Step 3.13: Remove unused main.html

---
 client/main.html | 8 --------
 1 file changed, 8 deletions(-)
 delete mode 100644 client/main.html

diff --git a/client/main.html b/client/main.html
deleted file mode 100644
index 62eca58..0000000
--- a/client/main.html
+++ /dev/null
@@ -1,8 +0,0 @@
-<div ng-controller="PartiesListCtrl as vm">
-  <ul>
-    <li ng-repeat="party in vm.parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-    </li>
-  </ul>
-</div>
-- 
2.7.4


From eec58512bd990d4c694fb585d361a65b6c995760 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:29:59 +0200
Subject: [PATCH 029/376] Step 3.14: Import template

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index a5a8a27..ba6973f 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,6 +1,8 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
+import templateUrl from './partiesList.html';
+
 class PartiesList {
   constructor($scope, $reactive) {
     'ngInject';
@@ -21,7 +23,7 @@ const name = 'partiesList';
 export default angular.module(name, [
   angularMeteor
 ]).component(name, {
-  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  templateUrl,
   controllerAs: name,
   controller: PartiesList
 });
-- 
2.7.4


From 11f7418ea1a3910403824ffa267f6bc8076a19cb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 12 May 2016 10:18:38 +0200
Subject: [PATCH 030/376] Step 3.15: Add static-templates

---
 .meteor/packages | 2 +-
 .meteor/versions | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index d74ee49..7474951 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,4 +18,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 pbastowski:angular-babel
-angular-templates
+urigo:static-templates
diff --git a/.meteor/versions b/.meteor/versions
index 5a2d576..4a48923 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -64,6 +64,8 @@ templating-tools@1.0.2
 tracker@1.0.13
 ui@1.0.11
 underscore@1.0.8
+urigo:static-html-compiler@0.0.2
+urigo:static-templates@0.0.2
 url@1.0.9
 webapp@1.2.8
 webapp-hashing@1.0.9
-- 
2.7.4


From 4cd9e91947712a70885c7d7b7803d71d0d98fe2b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 12 May 2016 10:19:21 +0200
Subject: [PATCH 031/376] Step 3.16: Switch from templateUrl to template

---
 imports/ui/components/partiesList/partiesList.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index ba6973f..fc2bdd6 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,7 +1,7 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
-import templateUrl from './partiesList.html';
+import template from './partiesList.html';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -23,7 +23,7 @@ const name = 'partiesList';
 export default angular.module(name, [
   angularMeteor
 ]).component(name, {
-  templateUrl,
+  template,
   controllerAs: name,
   controller: PartiesList
 });
-- 
2.7.4


From dc71f3385bd1c8d47fed9ffb258f0cb1742241fa Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:31:27 +0200
Subject: [PATCH 032/376] Step 3.17: Create view for Socially component

---
 imports/ui/components/socially/socially.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/socially/socially.html

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
new file mode 100644
index 0000000..5e9673b
--- /dev/null
+++ b/imports/ui/components/socially/socially.html
@@ -0,0 +1 @@
+<parties-list></parties-list>
-- 
2.7.4


From f73c0e653e5ead144bf06986877d2df16ca064a1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:32:56 +0200
Subject: [PATCH 033/376] Step 3.18: Create Socially component

---
 imports/ui/components/socially/socially.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
 create mode 100644 imports/ui/components/socially/socially.js

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
new file mode 100644
index 0000000..2a99481
--- /dev/null
+++ b/imports/ui/components/socially/socially.js
@@ -0,0 +1,19 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './socially.html';
+import { name as PartiesList } from '../partiesList/partiesList';
+
+class Socially {}
+
+const name = 'socially';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  PartiesList
+]).component(name, {
+  template,
+  controllerAs: name,
+  controller: Socially
+});
-- 
2.7.4


From 47e0e92411777389f796502bd4745f29cb2b5b2b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:33:26 +0200
Subject: [PATCH 034/376] Step 3.19: Replace parties-list with socially

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 84f0ef3..e6d21ea 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
 <body ng-app="socially" ng-strict-di="">
-  <parties-list></parties-list>
+  <socially></socially>
 </body>
-- 
2.7.4


From d00e4e98509d9047a258492030d5cc8e02805ae6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:34:53 +0200
Subject: [PATCH 035/376] Step 3.20: Import Socially in main.js

---
 client/main.js | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/client/main.js b/client/main.js
index d643c33..212f992 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,9 +1,4 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
-import { name as PartiesList } from '../imports/ui/components/partiesList/partiesList';
-
-angular.module('socially', [
-    angularMeteor,
-    PartiesList
-  ]);
+import { name as Socially } from '../imports/ui/components/socially/socially';
-- 
2.7.4


From 7a6128cd8b213cf0178aa175889983faba56c606 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:35:46 +0200
Subject: [PATCH 036/376] Step 4.1: Create template for PartyAdd component

---
 imports/ui/components/partyAdd/partyAdd.html | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/partyAdd.html

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
new file mode 100644
index 0000000..a61cf04
--- /dev/null
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -0,0 +1,11 @@
+<form>
+  <label>
+    Party Name:
+  </label>
+  <input type="text"/>
+  <label>
+    Description:
+  </label>
+  <input type="text"/>
+  <button>Add Party!</button>
+</form>
-- 
2.7.4


From 697e6b934929446bb4523dc9a66a23b5b5bf9ddd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:36:39 +0200
Subject: [PATCH 037/376] Step 4.2: Create PartyAdd component

---
 imports/ui/components/partyAdd/partyAdd.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/partyAdd.js

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
new file mode 100644
index 0000000..bec462e
--- /dev/null
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -0,0 +1,17 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './partyAdd.html';
+
+class PartyAdd {}
+
+const name = 'partyAdd';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  controller: PartyAdd
+});
-- 
2.7.4


From 0ffc99f7515371bef614794817c166a7a8774275 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:37:19 +0200
Subject: [PATCH 038/376] Step 4.3: Implement PartyAdd to the view

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 64ac441..229908b 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,3 +1,5 @@
+<party-add></party-add>
+
 <ul>
   <li ng-repeat="party in partiesList.parties">
     {{party.name}}
-- 
2.7.4


From b1a8354cad03cf5174f797c597d98b48b7ea3212 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:42:22 +0200
Subject: [PATCH 039/376] Step 4.4: Add PartyAdd to PartiesList

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index fc2bdd6..9acb917 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import template from './partiesList.html';
+import { name as PartyAdd } from '../partyAdd/partyAdd';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -21,7 +22,8 @@ const name = 'partiesList';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  PartyAdd
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 93e2b6e6a7cbd99abd8d06c8843ee9c2ecdacb76 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:43:11 +0200
Subject: [PATCH 040/376] Step 4.5: Add ng-model to the form inputs

---
 imports/ui/components/partyAdd/partyAdd.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index a61cf04..f035ecd 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -2,10 +2,10 @@
   <label>
     Party Name:
   </label>
-  <input type="text"/>
+  <input type="text" ng-model="partyAdd.party.name" />
   <label>
     Description:
   </label>
-  <input type="text"/>
+  <input type="text" ng-model="partyAdd.party.description" />
   <button>Add Party!</button>
 </form>
-- 
2.7.4


From bb5a3e272c4a187c187bcba311207c44ea74407e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:46:01 +0200
Subject: [PATCH 041/376] Step 4.6: Add submit method to the button

---
 imports/ui/components/partyAdd/partyAdd.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index f035ecd..3508bef 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -7,5 +7,5 @@
     Description:
   </label>
   <input type="text" ng-model="partyAdd.party.description" />
-  <button>Add Party!</button>
+  <button ng-click="partyAdd.submit()">Add Party!</button>
 </form>
-- 
2.7.4


From a34818fa68a85a3d925803c1bc0a3951c1538ffe Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:47:30 +0200
Subject: [PATCH 042/376] Step 4.7: Add submit method

---
 imports/ui/components/partyAdd/partyAdd.js | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index bec462e..d864dbb 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -3,7 +3,15 @@ import angularMeteor from 'angular-meteor';
 
 import template from './partyAdd.html';
 
-class PartyAdd {}
+class PartyAdd {
+  constructor() {
+    this.party = {};
+  }
+
+  submit() {
+    console.log('submit:', this.party);
+  }
+}
 
 const name = 'partyAdd';
 
-- 
2.7.4


From a931d2b69f2ae9094752a6ec27d78bd053a59cf9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:52:00 +0200
Subject: [PATCH 043/376] Step 4.8: Move Parties to imports

---
 imports/api/parties.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/api/parties.js

diff --git a/imports/api/parties.js b/imports/api/parties.js
new file mode 100644
index 0000000..e308632
--- /dev/null
+++ b/imports/api/parties.js
@@ -0,0 +1,3 @@
+import { Mongo } from 'meteor/mongo';
+
+export const Parties = new Mongo.Collection('parties');
-- 
2.7.4


From 5d58723966644cf350541d5fc362196c6a601b01 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:52:33 +0200
Subject: [PATCH 044/376] Step 4.9: Remove old collection

---
 collections/parties.js | 1 -
 1 file changed, 1 deletion(-)
 delete mode 100644 collections/parties.js

diff --git a/collections/parties.js b/collections/parties.js
deleted file mode 100644
index f78fa2c..0000000
--- a/collections/parties.js
+++ /dev/null
@@ -1 +0,0 @@
-Parties = new Mongo.Collection('parties');
-- 
2.7.4


From 32ac4f780167180f6feb5709b6bacde10d7b87b4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:56:28 +0200
Subject: [PATCH 045/376] Step 4.10: Import new module with Parties collection

---
 server/startup.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/server/startup.js b/server/startup.js
index ad3fd85..6ce39cd 100644
--- a/server/startup.js
+++ b/server/startup.js
@@ -1,3 +1,6 @@
+import { Meteor } from 'meteor/meteor';
+import { Parties } from '../imports/api/parties';
+
 Meteor.startup(() => {
   if (Parties.find().count() === 0) {
     const parties = [{
-- 
2.7.4


From 9698012c8c0ac6f1d0625a6f560d7948e497e112 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:57:41 +0200
Subject: [PATCH 046/376] Step 4.11: Import new module with Parties to
 PartiesList

---
 imports/ui/components/partiesList/partiesList.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 9acb917..b9ef5c8 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import template from './partiesList.html';
+import { Parties } from '../../../api/parties';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 
 class PartiesList {
-- 
2.7.4


From c3d9a79ed73cd2d563fe001803582984643ba43a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:00:20 +0200
Subject: [PATCH 047/376] Step 4.12: Insert new party

---
 imports/ui/components/partyAdd/partyAdd.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index d864dbb..aa9b76f 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import template from './partyAdd.html';
+import { Parties } from '../../../api/parties';
 
 class PartyAdd {
   constructor() {
@@ -9,7 +10,12 @@ class PartyAdd {
   }
 
   submit() {
-    console.log('submit:', this.party);
+    Parties.insert(this.party);
+    this.reset();
+  }
+
+  reset() {
+    this.party = {};
   }
 }
 
-- 
2.7.4


From 77945ac196256c247bffa4e313f38280c0a0de21 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:01:18 +0200
Subject: [PATCH 048/376] Step 4.13: Create view for PartyRemove component

---
 imports/ui/components/partyRemove/partyRemove.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/partyRemove/partyRemove.html

diff --git a/imports/ui/components/partyRemove/partyRemove.html b/imports/ui/components/partyRemove/partyRemove.html
new file mode 100644
index 0000000..1295105
--- /dev/null
+++ b/imports/ui/components/partyRemove/partyRemove.html
@@ -0,0 +1 @@
+<button ng-click="partyRemove.remove()">X</button>
-- 
2.7.4


From 9c848f38c7cb8866fa21b976638d0aeaa44859f9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:04:08 +0200
Subject: [PATCH 049/376] Step 4.14: Create PartyRemove component

---
 imports/ui/components/partyRemove/partyRemove.js | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 imports/ui/components/partyRemove/partyRemove.js

diff --git a/imports/ui/components/partyRemove/partyRemove.js b/imports/ui/components/partyRemove/partyRemove.js
new file mode 100644
index 0000000..646d78d
--- /dev/null
+++ b/imports/ui/components/partyRemove/partyRemove.js
@@ -0,0 +1,21 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './partyRemove.html';
+
+class PartyRemove {
+  remove() {
+    console.log('remove party');
+  }
+}
+
+const name = 'partyRemove';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  controller: PartyRemove
+});
-- 
2.7.4


From c201df4ef0b5a94d4af0701f0f7684433ba3b2f6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:05:10 +0200
Subject: [PATCH 050/376] Step 4.15: Add party binding

---
 imports/ui/components/partyRemove/partyRemove.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyRemove/partyRemove.js b/imports/ui/components/partyRemove/partyRemove.js
index 646d78d..fb007aa 100644
--- a/imports/ui/components/partyRemove/partyRemove.js
+++ b/imports/ui/components/partyRemove/partyRemove.js
@@ -16,6 +16,9 @@ export default angular.module(name, [
   angularMeteor
 ]).component(name, {
   template,
+  bindings: {
+    party: '<'
+  },
   controllerAs: name,
   controller: PartyRemove
 });
-- 
2.7.4


From d1cea368206b3cb0e5b3fd13a9ec3811d1075c2a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:06:30 +0200
Subject: [PATCH 051/376] Step 4.16: Remove party from collection

---
 imports/ui/components/partyRemove/partyRemove.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyRemove/partyRemove.js b/imports/ui/components/partyRemove/partyRemove.js
index fb007aa..ab73562 100644
--- a/imports/ui/components/partyRemove/partyRemove.js
+++ b/imports/ui/components/partyRemove/partyRemove.js
@@ -2,10 +2,13 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import template from './partyRemove.html';
+import { Parties } from '../../../api/parties';
 
 class PartyRemove {
   remove() {
-    console.log('remove party');
+    if (this.party) {
+      Parties.remove(this.party._id);
+    }
   }
 }
 
-- 
2.7.4


From 4ecfdc8130668f9f23f2826d80462844a65f3bd8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:07:06 +0200
Subject: [PATCH 052/376] Step 4.17: Add PartyRemove

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index b9ef5c8..d5d132a 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -4,6 +4,7 @@ import angularMeteor from 'angular-meteor';
 import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
+import { name as PartyRemove } from '../partyRemove/partyRemove';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -24,7 +25,8 @@ const name = 'partiesList';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  PartyAdd
+  PartyAdd,
+  PartyRemove
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 1d703dcd6d903e5ffc2d9bccffe8f0bc87617b9d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:08:02 +0200
Subject: [PATCH 053/376] Step 4.18: Implement component

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 229908b..24dedb1 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -4,5 +4,6 @@
   <li ng-repeat="party in partiesList.parties">
     {{party.name}}
     <p>{{party.description}}</p>
+    <party-remove party="party"></party-remove>
   </li>
 </ul>
-- 
2.7.4


From 4a684506c942c14a627a4d41fc3fd0e10f67de5f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:21:49 +0200
Subject: [PATCH 054/376] Step 4.19: Add `sanjo:jasmine` and reporters

---
 .meteor/packages | 3 +++
 .meteor/versions | 9 +++++++++
 2 files changed, 12 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7474951..026de87 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,6 @@ autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 pbastowski:angular-babel
 urigo:static-templates
+sanjo:jasmine
+velocity:html-reporter
+velocity:console-reporter
diff --git a/.meteor/versions b/.meteor/versions
index 4a48923..ce085a3 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,4 +1,5 @@
 allow-deny@1.0.4
+amplify@1.0.0
 angular-templates@1.0.2
 autopublish@1.0.7
 autoupdate@1.2.8
@@ -33,6 +34,7 @@ id-map@1.0.7
 insecure@1.0.7
 jquery@1.11.8
 launch-screen@1.0.11
+less@2.5.6
 livedata@1.0.18
 logging@1.0.12
 meteor@1.1.14
@@ -52,14 +54,18 @@ ordered-dict@1.0.7
 pbastowski:angular-babel@1.3.2
 promise@0.6.7
 random@1.0.9
+reactive-dict@1.1.5
 reactive-var@1.0.9
 reload@1.1.8
 retry@1.0.7
 routepolicy@1.0.10
+sanjo:jasmine@1.0.1
+session@1.1.3
 spacebars@1.0.11
 spacebars-compiler@1.0.11
 standard-minifier-css@1.0.6
 standard-minifier-js@1.0.6
+templating@1.1.7
 templating-tools@1.0.2
 tracker@1.0.13
 ui@1.0.11
@@ -67,5 +73,8 @@ underscore@1.0.8
 urigo:static-html-compiler@0.0.2
 urigo:static-templates@0.0.2
 url@1.0.9
+velocity:console-reporter@0.2.1
+velocity:html-reporter@0.10.0
+velocity:reports@1.0.0
 webapp@1.2.8
 webapp-hashing@1.0.9
-- 
2.7.4


From 5bfcb6c257be35f01103d7c3fa3d7b97261706a4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:23:16 +0200
Subject: [PATCH 055/376] Step 4.20: Add `test:watch` npm script

---
 package.json | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 1fdb919..af9f43d 100644
--- a/package.json
+++ b/package.json
@@ -2,7 +2,8 @@
   "name": "socially",
   "private": true,
   "scripts": {
-    "start": "meteor run"
+    "start": "meteor run",
+    "test:watch": "meteor test --driver-package sanjo:jasmine"
   },
   "dependencies": {
     "angular": "^1.5.3",
-- 
2.7.4


From 78d39659783dec56a94a4a2d7059699ecce832cb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:24:39 +0200
Subject: [PATCH 056/376] Step 4.21: Install `angular-mocks`

---
 package.json | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/package.json b/package.json
index af9f43d..1555b86 100644
--- a/package.json
+++ b/package.json
@@ -9,5 +9,8 @@
     "angular": "^1.5.3",
     "angular-meteor": "^1.3.9",
     "meteor-node-stubs": "~0.2.0"
+  },
+  "devDependencies": {
+    "angular-mocks": "^1.5.3"
   }
 }
-- 
2.7.4


From 0700fe2daec45d1e3fbd5a03baaeb67f46a39fab Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:45:42 +0200
Subject: [PATCH 057/376] Step 4.22: Tests of PartyAdd

---
 .../components/partyAdd/client/partyAdd.tests.js   | 53 ++++++++++++++++++++++
 1 file changed, 53 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/client/partyAdd.tests.js

diff --git a/imports/ui/components/partyAdd/client/partyAdd.tests.js b/imports/ui/components/partyAdd/client/partyAdd.tests.js
new file mode 100644
index 0000000..cc1d35e
--- /dev/null
+++ b/imports/ui/components/partyAdd/client/partyAdd.tests.js
@@ -0,0 +1,53 @@
+import { name as PartyAdd } from '../partyAdd';
+import { Parties } from '../../../../api/parties';
+import 'angular-mocks';
+
+describe('PartyAdd', () => {
+  beforeEach(() => {
+    window.module(PartyAdd);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const party = {
+      name: 'Foo',
+      description: 'Birthday of Foo'
+    };
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartyAdd, {
+          $scope: $rootScope.$new(true)
+        });
+      });
+    });
+
+    describe('reset()', () => {
+      it('should clean up party object', () => {
+        controller.party = party;
+        controller.reset();
+
+        expect(controller.party).toEqual({});
+      });
+    });
+
+    describe('submit()', () => {
+      beforeEach(() => {
+        spyOn(Parties, 'insert');
+        spyOn(controller, 'reset').and.callThrough();
+
+        controller.party = party;
+
+        controller.submit();
+      });
+
+      it('should insert a new party', () => {
+        expect(Parties.insert).toHaveBeenCalledWith(party);
+      });
+
+      it('should call reset()', () => {
+        expect(controller.reset).toHaveBeenCalled();
+      });
+    });
+  });
+});
-- 
2.7.4


From b1c3fee149f1aec4f81f316576723457f16f1549 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:50:11 +0200
Subject: [PATCH 058/376] Step 4.23: Tests of PartyRemove

---
 .../partyRemove/client/partyRemove.tests.js        | 37 ++++++++++++++++++++++
 1 file changed, 37 insertions(+)
 create mode 100644 imports/ui/components/partyRemove/client/partyRemove.tests.js

diff --git a/imports/ui/components/partyRemove/client/partyRemove.tests.js b/imports/ui/components/partyRemove/client/partyRemove.tests.js
new file mode 100644
index 0000000..e8b6e97
--- /dev/null
+++ b/imports/ui/components/partyRemove/client/partyRemove.tests.js
@@ -0,0 +1,37 @@
+import { name as PartyRemove } from '../partyRemove';
+import { Parties } from '../../../../api/parties';
+import 'angular-mocks';
+
+describe('PartyRemove', () => {
+  beforeEach(() => {
+    window.module(PartyRemove);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const party = {
+      _id: 'partyId'
+    };
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartyRemove, {
+          $scope: $rootScope.$new(true)
+        }, {
+          party
+        });
+      });
+    });
+
+    describe('remove()', () => {
+      beforeEach(() => {
+        spyOn(Parties, 'remove');
+        controller.remove();
+      });
+
+      it('should remove a party', () => {
+        expect(Parties.remove).toHaveBeenCalledWith(party._id);
+      });
+    });
+  });
+});
-- 
2.7.4


From f2d5ab98c07a3428308e0e4eb8c5aa28e2b262aa Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:09:16 +0200
Subject: [PATCH 059/376] Step 5.1: Add ui-router

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 1555b86..b8cdb95 100644
--- a/package.json
+++ b/package.json
@@ -8,6 +8,7 @@
   "dependencies": {
     "angular": "^1.5.3",
     "angular-meteor": "^1.3.9",
+    "angular-ui-router": "^0.2.18",
     "meteor-node-stubs": "~0.2.0"
   },
   "devDependencies": {
-- 
2.7.4


From a2330cecba89227af6ed39a1e087d8b25e31e276 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:10:34 +0200
Subject: [PATCH 060/376] Step 5.2: Add uiRouter to Socially

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 2a99481..7cd7e96 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
 
 import template from './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
@@ -11,6 +12,7 @@ const name = 'socially';
 // create a module
 export default angular.module(name, [
   angularMeteor,
+  uiRouter,
   PartiesList
 ]).component(name, {
   template,
-- 
2.7.4


From cfbcc8cef73c202131e8c865f7a2721611c41269 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:11:08 +0200
Subject: [PATCH 061/376] Step 5.3: Add base tag to main template

---
 client/index.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/index.html b/client/index.html
index e6d21ea..806f6ab 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,6 @@
+<head>
+  <base href="/">
+</head>
 <body ng-app="socially" ng-strict-di="">
   <socially></socially>
 </body>
-- 
2.7.4


From 27bb55418ed5170f41b8c3392a0781753f7f4bd2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:11:52 +0200
Subject: [PATCH 062/376] Step 5.4: Add uiView to Socially view

---
 imports/ui/components/socially/socially.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 5e9673b..19b303a 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1 +1 @@
-<parties-list></parties-list>
+<div ui-view=""></div>
-- 
2.7.4


From ac0164a1360047912fd388137901ca1fe96d248f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:13:54 +0200
Subject: [PATCH 063/376] Step 5.5: Define `parties` route

---
 imports/ui/components/partiesList/partiesList.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index d5d132a..54e8ad3 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
 
 import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
@@ -25,10 +26,21 @@ const name = 'partiesList';
 // create a module
 export default angular.module(name, [
   angularMeteor,
+  uiRouter,
   PartyAdd,
   PartyRemove
 ]).component(name, {
   template,
   controllerAs: name,
   controller: PartiesList
-});
+})
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+  $stateProvider
+    .state('parties', {
+      url: '/parties',
+      template: '<parties-list></parties-list>'
+    });
+}
-- 
2.7.4


From 5d10c3130ded825745559a4d79b6fcda32c9ad52 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:15:19 +0200
Subject: [PATCH 064/376] Step 5.6: Set html5Mode and `parties` as default
 route

---
 imports/ui/components/socially/socially.js | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 7cd7e96..b064f0d 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -18,4 +18,13 @@ export default angular.module(name, [
   template,
   controllerAs: name,
   controller: Socially
-});
+})
+  .config(config);
+
+function config($locationProvider, $urlRouterProvider) {
+  'ngInject';
+
+  $locationProvider.html5Mode(true);
+
+  $urlRouterProvider.otherwise('/parties');
+}
-- 
2.7.4


From eabe8694b595056c528bcb0676f3a3412def0759 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:16:09 +0200
Subject: [PATCH 065/376] Step 5.7: Create view for Navigation component

---
 imports/ui/components/navigation/navigation.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/navigation/navigation.html

diff --git a/imports/ui/components/navigation/navigation.html b/imports/ui/components/navigation/navigation.html
new file mode 100644
index 0000000..def2640
--- /dev/null
+++ b/imports/ui/components/navigation/navigation.html
@@ -0,0 +1,3 @@
+<h1>
+  <a href="/parties">Home</a>
+</h1>
-- 
2.7.4


From dd13d3ebe0c2eca3f334ae497f49168d9417217a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:17:01 +0200
Subject: [PATCH 066/376] Step 5.8: Create Navigation component

---
 imports/ui/components/navigation/navigation.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 imports/ui/components/navigation/navigation.js

diff --git a/imports/ui/components/navigation/navigation.js b/imports/ui/components/navigation/navigation.js
new file mode 100644
index 0000000..5e33f59
--- /dev/null
+++ b/imports/ui/components/navigation/navigation.js
@@ -0,0 +1,14 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './navigation.html';
+
+const name = 'navigation';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name
+});
-- 
2.7.4


From 5c8c9ae52824c5b41ca258c7f3b528e043bf757c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:17:37 +0200
Subject: [PATCH 067/376] Step 5.9: Implement Navigation in the view

---
 imports/ui/components/socially/socially.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 19b303a..7fdb2de 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1 +1,3 @@
+<navigation></navigation>
+
 <div ui-view=""></div>
-- 
2.7.4


From d9571bbf4485b1b1353436d685f61e6291918494 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:18:12 +0200
Subject: [PATCH 068/376] Step 5.10: Add Navigation to Socially

---
 imports/ui/components/socially/socially.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index b064f0d..c035c49 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -4,6 +4,7 @@ import uiRouter from 'angular-ui-router';
 
 import template from './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
+import { name as Navigation } from '../navigation/navigation';
 
 class Socially {}
 
@@ -13,7 +14,8 @@ const name = 'socially';
 export default angular.module(name, [
   angularMeteor,
   uiRouter,
-  PartiesList
+  PartiesList,
+  Navigation
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 30ff7a6a96b701b99c8a5fb16a925ec3f3665e6d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:19:42 +0200
Subject: [PATCH 069/376] Step 5.11: Create view for the PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/partyDetails/partyDetails.html

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
new file mode 100644
index 0000000..3ea8425
--- /dev/null
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -0,0 +1 @@
+The party your selected is: {{ partyDetails.partyId }}
-- 
2.7.4


From f9870ab040f7801048adafd19ca8b876fdcbce66 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:21:42 +0200
Subject: [PATCH 070/376] Step 5.12: Create PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.js | 24 ++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 imports/ui/components/partyDetails/partyDetails.js

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
new file mode 100644
index 0000000..de7b7bb
--- /dev/null
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -0,0 +1,24 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
+
+import template from './partyDetails.html';
+
+class PartyDetails {
+  constructor($stateParams) {
+    'ngInject';
+
+    this.partyId = $stateParams.partyId;
+  }
+}
+
+const name = 'partyDetails';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  controller: PartyDetails
+});
-- 
2.7.4


From eedab4f81f09d037033c621aae7fd2f31fa1c194 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:22:56 +0200
Subject: [PATCH 071/376] Step 5.13: Set partyDetails state

---
 imports/ui/components/partyDetails/partyDetails.js | 15 +++++++++++++--
 1 file changed, 13 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index de7b7bb..89b01b2 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -16,9 +16,20 @@ const name = 'partyDetails';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  uiRouter
 ]).component(name, {
   template,
   controllerAs: name,
   controller: PartyDetails
-});
+})
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+
+  $stateProvider.state('partyDetails', {
+    url: '/parties/:partyId',
+    template: '<party-details></party-details>'
+  });
+}
-- 
2.7.4


From 9220f2bff8a45132d765c66d378d6d98652baa01 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:23:41 +0200
Subject: [PATCH 072/376] Step 5.14: Add PartyDetails to Socially

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index c035c49..db55196 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -4,6 +4,7 @@ import uiRouter from 'angular-ui-router';
 
 import template from './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
+import { name as PartyDetails } from '../partyDetails/partyDetails';
 import { name as Navigation } from '../navigation/navigation';
 
 class Socially {}
@@ -15,6 +16,7 @@ export default angular.module(name, [
   angularMeteor,
   uiRouter,
   PartiesList,
+  PartyDetails,
   Navigation
 ]).component(name, {
   template,
-- 
2.7.4


From c8532cb8a79026bd86855fe4eb25e3de9553c04e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:25:15 +0200
Subject: [PATCH 073/376] Step 5.15: Add link

---
 imports/ui/components/partiesList/partiesList.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 24dedb1..c1b07e2 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -2,7 +2,9 @@
 
 <ul>
   <li ng-repeat="party in partiesList.parties">
-    {{party.name}}
+    <a ui-sref="partyDetails({ partyId: party._id })">
+      {{party.name}}
+    </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
   </li>
-- 
2.7.4


From 8595e2858ce911221e016d511164fcab4c5e4f21 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:30:15 +0200
Subject: [PATCH 074/376] Step 6.1: Add party helper

---
 imports/ui/components/partyDetails/partyDetails.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 89b01b2..8027663 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -3,12 +3,23 @@ import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
 
 import template from './partyDetails.html';
+import { Parties } from '../../../api/parties';
 
 class PartyDetails {
-  constructor($stateParams) {
+  constructor($stateParams, $scope, $reactive) {
     'ngInject';
 
+    $reactive(this).attach($scope);
+
     this.partyId = $stateParams.partyId;
+
+    this.helpers({
+      party() {
+        return Parties.findOne({
+          _id: $stateParams.partyId
+        });
+      }
+    });
   }
 }
 
-- 
2.7.4


From f59189332b08044fa46f0defc1cd262d179051d3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:33:34 +0200
Subject: [PATCH 075/376] Step 6.2: Add form with the party details to the
 party details page

---
 imports/ui/components/partyDetails/partyDetails.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 3ea8425..8c1201f 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -1 +1,5 @@
-The party your selected is: {{ partyDetails.partyId }}
+The party your selected is:
+<form>
+  Party name: <input type="text" ng-model="partyDetails.party.name" />
+  Description: <input type="text" ng-model="partyDetails.party.description" />
+</form>
-- 
2.7.4


From 2529e5c4bb83efd0d6b661b493737d02b1bbefa6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:34:10 +0200
Subject: [PATCH 076/376] Step 6.3: Add save and back buttons to the view

---
 imports/ui/components/partyDetails/partyDetails.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 8c1201f..b5c939b 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -2,4 +2,7 @@ The party your selected is:
 <form>
   Party name: <input type="text" ng-model="partyDetails.party.name" />
   Description: <input type="text" ng-model="partyDetails.party.description" />
+  <button ng-click="partyDetails.save()">Save</button>
 </form>
+
+<button ui-sref="parties">Back</button>
-- 
2.7.4


From 3eeb93ee7e15a45646657bd6ff7671e98fe20614 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:35:38 +0200
Subject: [PATCH 077/376] Step 6.4: Implement save button on the component
 logic

---
 imports/ui/components/partyDetails/partyDetails.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 8027663..af77e46 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -21,6 +21,17 @@ class PartyDetails {
       }
     });
   }
+
+  save() {
+    Parties.update({
+      _id: this.party._id
+    }, {
+      $set: {
+        name: this.party.name,
+        description: this.party.description
+      }
+    });
+  }
 }
 
 const name = 'partyDetails';
-- 
2.7.4


From 5873acddfcd9b3e8f4e5cc01a6dd5e2e1e5188c0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:36:24 +0200
Subject: [PATCH 078/376] Step 6.5: Handle success and fail for data actions

---
 imports/ui/components/partyDetails/partyDetails.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index af77e46..e63b6ef 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -30,6 +30,12 @@ class PartyDetails {
         name: this.party.name,
         description: this.party.description
       }
+    }, (error) => {
+      if (error) {
+        console.log('Oops, unable to update the party...');
+      } else {
+        console.log('Done!');
+      }
     });
   }
 }
-- 
2.7.4


From c01f6a58ef0e3707adc6a6a3712dc9604d9848eb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:11:57 +0200
Subject: [PATCH 079/376] Step 6.6: Tests of PartyDetails

---
 .../partyDetails/client/partyDetails.tests.js      | 49 ++++++++++++++++++++++
 1 file changed, 49 insertions(+)
 create mode 100644 imports/ui/components/partyDetails/client/partyDetails.tests.js

diff --git a/imports/ui/components/partyDetails/client/partyDetails.tests.js b/imports/ui/components/partyDetails/client/partyDetails.tests.js
new file mode 100644
index 0000000..997304e
--- /dev/null
+++ b/imports/ui/components/partyDetails/client/partyDetails.tests.js
@@ -0,0 +1,49 @@
+import { name as PartyDetails } from '../partyDetails';
+import { Parties } from '../../../../api/parties';
+import 'angular-mocks';
+
+describe('PartyDetails', () => {
+  beforeEach(() => {
+    window.module(PartyDetails);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const party = {
+      _id: 'partyId',
+      name: 'Foo',
+      description: 'Birthday of Foo'
+    };
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartyDetails, {
+          $scope: $rootScope.$new(true)
+        });
+      });
+    });
+
+    describe('save()', () => {
+      beforeEach(() => {
+        spyOn(Parties, 'update');
+        controller.party = party;
+        controller.save();
+      });
+
+      it('should update a proper party', () => {
+        expect(Parties.update.calls.mostRecent().args[0]).toEqual({
+          _id: party._id
+        });
+      });
+
+      it('should update with proper modifier', () => {
+        expect(Parties.update.calls.mostRecent().args[1]).toEqual({
+          $set: {
+            name: party.name,
+            description: party.description
+          }
+        });
+      });
+    });
+  });
+});
-- 
2.7.4


From 7327ad3993827ed13cf8882f0acd475555532c36 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:38:12 +0200
Subject: [PATCH 080/376] Step 7.1: Move startup to imports

---
 imports/startup/fixtures.js | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 imports/startup/fixtures.js

diff --git a/imports/startup/fixtures.js b/imports/startup/fixtures.js
new file mode 100644
index 0000000..d92fb48
--- /dev/null
+++ b/imports/startup/fixtures.js
@@ -0,0 +1,21 @@
+import { Meteor } from 'meteor/meteor';
+import { Parties } from '../api/parties';
+
+Meteor.startup(() => {
+  if (Parties.find().count() === 0) {
+    const parties = [{
+      'name': 'Dubstep-Free Zone',
+      'description': 'Fast just got faster with Nexus S.'
+    }, {
+      'name': 'All dubstep all the time',
+      'description': 'Get it on!'
+    }, {
+      'name': 'Savage lounging',
+      'description': 'Leisure suit required. And only fiercest manners.'
+    }];
+
+    parties.forEach((party) => {
+      Parties.insert(party)
+    });
+  }
+});
-- 
2.7.4


From 1834eafac9fc55b5eabae26c0a5ba01a1853255a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:39:27 +0200
Subject: [PATCH 081/376] Step 7.2: Create main entry point on server-side

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 server/main.js

diff --git a/server/main.js b/server/main.js
new file mode 100644
index 0000000..40efcd1
--- /dev/null
+++ b/server/main.js
@@ -0,0 +1 @@
+import '../imports/startup/fixtures';
-- 
2.7.4


From 84d83dff48aff6d2e75035eed1626f9dd5fada44 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:40:16 +0200
Subject: [PATCH 082/376] Step 7.3: Import Parties on server-side to be
 synchronized

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.js b/server/main.js
index 40efcd1..d4c97f0 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1 +1,2 @@
 import '../imports/startup/fixtures';
+import '../imports/api/parties';
-- 
2.7.4


From 95b61033057fca345346e3d04cbb7268e83cca12 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:40:34 +0200
Subject: [PATCH 083/376] Step 7.4: Remove old startup.js

---
 server/startup.js | 21 ---------------------
 1 file changed, 21 deletions(-)
 delete mode 100644 server/startup.js

diff --git a/server/startup.js b/server/startup.js
deleted file mode 100644
index 6ce39cd..0000000
--- a/server/startup.js
+++ /dev/null
@@ -1,21 +0,0 @@
-import { Meteor } from 'meteor/meteor';
-import { Parties } from '../imports/api/parties';
-
-Meteor.startup(() => {
-  if (Parties.find().count() === 0) {
-    const parties = [{
-      'name': 'Dubstep-Free Zone',
-      'description': 'Fast just got faster with Nexus S.'
-    }, {
-      'name': 'All dubstep all the time',
-      'description': 'Get it on!'
-    }, {
-      'name': 'Savage lounging',
-      'description': 'Leisure suit required. And only fiercest manners.'
-    }];
-
-    parties.forEach((party) => {
-      Parties.insert(party)
-    });
-  }
-});
-- 
2.7.4


From 0e2a9ec2247866e877ce05efd6cd004549c9c015 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:41:57 +0200
Subject: [PATCH 084/376] Step 8.1: Remove `insecure` package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 026de87..1b00904 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,7 +16,6 @@ standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 pbastowski:angular-babel
 urigo:static-templates
 sanjo:jasmine
diff --git a/.meteor/versions b/.meteor/versions
index ce085a3..c1a5619 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -31,7 +31,6 @@ html-tools@1.0.9
 htmljs@1.0.9
 http@1.1.5
 id-map@1.0.7
-insecure@1.0.7
 jquery@1.11.8
 launch-screen@1.0.11
 less@2.5.6
-- 
2.7.4


From c030e6b76c7fec05c12bbd013929ef495293bdd1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:42:53 +0200
Subject: [PATCH 085/376] Step 8.2: Add `accounts-password`

---
 .meteor/packages |  1 +
 .meteor/versions | 10 ++++++++++
 2 files changed, 11 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 1b00904..8bac382 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ urigo:static-templates
 sanjo:jasmine
 velocity:html-reporter
 velocity:console-reporter
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index c1a5619..b62f4a5 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.4
+accounts-password@1.1.6
 allow-deny@1.0.4
 amplify@1.0.0
 angular-templates@1.0.2
@@ -17,12 +19,14 @@ check@1.2.1
 ddp@1.2.5
 ddp-client@1.2.5
 ddp-common@1.2.5
+ddp-rate-limiter@1.0.2
 ddp-server@1.2.6
 deps@1.0.12
 diff-sequence@1.0.5
 ecmascript@0.4.3
 ecmascript-runtime@0.2.10
 ejson@1.0.11
+email@1.0.10
 es5-shim@4.5.10
 fastclick@1.0.11
 geojson-utils@1.0.8
@@ -35,6 +39,7 @@ jquery@1.11.8
 launch-screen@1.0.11
 less@2.5.6
 livedata@1.0.18
+localstorage@1.0.7
 logging@1.0.12
 meteor@1.1.14
 meteor-base@1.0.4
@@ -47,6 +52,7 @@ modules@0.6.1
 modules-runtime@0.6.3
 mongo@1.1.7
 mongo-id@1.0.4
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.43
 observe-sequence@1.0.11
 ordered-dict@1.0.7
@@ -54,14 +60,18 @@ pbastowski:angular-babel@1.3.2
 promise@0.6.7
 random@1.0.9
 reactive-dict@1.1.5
+rate-limit@1.0.2
 reactive-var@1.0.9
 reload@1.1.8
 retry@1.0.7
 routepolicy@1.0.10
 sanjo:jasmine@1.0.1
 session@1.1.3
+service-configuration@1.0.7
+sha@1.0.5
 spacebars@1.0.11
 spacebars-compiler@1.0.11
+srp@1.0.6
 standard-minifier-css@1.0.6
 standard-minifier-js@1.0.6
 templating@1.1.7
-- 
2.7.4


From ea55f818771a57e89eba1bcf41b838c894fbbc75 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:44:10 +0200
Subject: [PATCH 086/376] Step 8.3: Add `dotansimha:accounts-ui-angular`

---
 .meteor/packages | 1 +
 .meteor/versions | 7 +++++++
 2 files changed, 8 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 8bac382..6069c29 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ sanjo:jasmine
 velocity:html-reporter
 velocity:console-reporter
 accounts-password
+dotansimha:accounts-ui-angular
diff --git a/.meteor/versions b/.meteor/versions
index b62f4a5..578225c 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,7 @@
 accounts-base@1.2.4
 accounts-password@1.1.6
+accounts-ui@1.1.7
+accounts-ui-unstyled@1.1.10
 allow-deny@1.0.4
 amplify@1.0.0
 angular-templates@1.0.2
@@ -10,6 +12,7 @@ babel-runtime@0.1.8
 base64@1.0.8
 binary-heap@1.0.8
 blaze@2.1.7
+blaze-html-templates@1.0.2
 blaze-tools@1.0.8
 boilerplate-generator@1.0.8
 caching-compiler@1.0.2
@@ -23,6 +26,7 @@ ddp-rate-limiter@1.0.2
 ddp-server@1.2.6
 deps@1.0.12
 diff-sequence@1.0.5
+dotansimha:accounts-ui-angular@0.0.4
 ecmascript@0.4.3
 ecmascript-runtime@0.2.10
 ejson@1.0.11
@@ -61,6 +65,7 @@ promise@0.6.7
 random@1.0.9
 reactive-dict@1.1.5
 rate-limit@1.0.2
+reactive-dict@1.1.5
 reactive-var@1.0.9
 reload@1.1.8
 retry@1.0.7
@@ -68,6 +73,7 @@ routepolicy@1.0.10
 sanjo:jasmine@1.0.1
 session@1.1.3
 service-configuration@1.0.7
+session@1.1.3
 sha@1.0.5
 spacebars@1.0.11
 spacebars-compiler@1.0.11
@@ -76,6 +82,7 @@ standard-minifier-css@1.0.6
 standard-minifier-js@1.0.6
 templating@1.1.7
 templating-tools@1.0.2
+tmeasday:check-npm-versions@0.1.1
 tracker@1.0.13
 ui@1.0.11
 underscore@1.0.8
-- 
2.7.4


From 65ce20d4a5c9633899920293fe4be55ec5d532b9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:44:45 +0200
Subject: [PATCH 087/376] Step 8.4: Add a dependecy for accounts-ui package

---
 imports/ui/components/socially/socially.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index db55196..e539bf1 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -17,7 +17,8 @@ export default angular.module(name, [
   uiRouter,
   PartiesList,
   PartyDetails,
-  Navigation
+  Navigation,
+  'accounts.ui'
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 179cd72b9578f7e73acf97d6cefd54b838cb5426 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:45:52 +0200
Subject: [PATCH 088/376] Step 8.5: Add usage for login-buttons directive

---
 imports/ui/components/socially/socially.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 7fdb2de..83c40e7 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1,3 +1,5 @@
+<login-buttons></login-buttons>
+
 <navigation></navigation>
 
 <div ui-view=""></div>
-- 
2.7.4


From a70f293b0f3dca1bcfcf0eadbddf46395389d487 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:01:43 +0200
Subject: [PATCH 089/376] Step 8.6: Add allow logic to the model

---
 imports/api/parties.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/imports/api/parties.js b/imports/api/parties.js
index e308632..3e283c1 100644
--- a/imports/api/parties.js
+++ b/imports/api/parties.js
@@ -1,3 +1,15 @@
 import { Mongo } from 'meteor/mongo';
 
 export const Parties = new Mongo.Collection('parties');
+
+Parties.allow({
+  insert(userId, party) {
+    return userId && party.owner === userId;
+  },
+  update(userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove(userId, party) {
+    return userId && party.owner === userId;
+  }
+});
-- 
2.7.4


From 5a653eac44000df491e1339fcfdff1adcda67741 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:02:37 +0200
Subject: [PATCH 090/376] Step 8.7: Add current user to the new party

---
 imports/ui/components/partyAdd/partyAdd.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index aa9b76f..4c9052a 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -1,6 +1,8 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
+import { Meteor } from 'meteor/meteor';
+
 import template from './partyAdd.html';
 import { Parties } from '../../../api/parties';
 
@@ -10,6 +12,7 @@ class PartyAdd {
   }
 
   submit() {
+    this.party.owner = Meteor.user()._id;
     Parties.insert(this.party);
     this.reset();
   }
-- 
2.7.4


From 4b48860893720de900d3ba64b588bcdd5f777370 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:03:33 +0200
Subject: [PATCH 091/376] Step 8.8: Add facebook and twitter

---
 .meteor/packages | 2 ++
 .meteor/versions | 8 ++++++++
 2 files changed, 10 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 6069c29..8ae4a69 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,5 @@ velocity:html-reporter
 velocity:console-reporter
 accounts-password
 dotansimha:accounts-ui-angular
+accounts-facebook
+accounts-twitter
diff --git a/.meteor/versions b/.meteor/versions
index 578225c..3f4624d 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,8 @@
 accounts-base@1.2.4
+accounts-facebook@1.0.7
+accounts-oauth@1.1.10
 accounts-password@1.1.6
+accounts-twitter@1.0.7
 accounts-ui@1.1.7
 accounts-ui-unstyled@1.1.10
 allow-deny@1.0.4
@@ -32,6 +35,7 @@ ecmascript-runtime@0.2.10
 ejson@1.0.11
 email@1.0.10
 es5-shim@4.5.10
+facebook@1.2.4
 fastclick@1.0.11
 geojson-utils@1.0.8
 hot-code-push@1.0.4
@@ -58,6 +62,9 @@ mongo@1.1.7
 mongo-id@1.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.43
+oauth@1.1.8
+oauth1@1.1.7
+oauth2@1.1.7
 observe-sequence@1.0.11
 ordered-dict@1.0.7
 pbastowski:angular-babel@1.3.2
@@ -84,6 +91,7 @@ templating@1.1.7
 templating-tools@1.0.2
 tmeasday:check-npm-versions@0.1.1
 tracker@1.0.13
+twitter@1.1.7
 ui@1.0.11
 underscore@1.0.8
 urigo:static-html-compiler@0.0.2
-- 
2.7.4


From e8cb788730de29c3c9920174ee62196618deac6c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:05:29 +0200
Subject: [PATCH 092/376] Step 8.9: Add permissions limit to the party details
 page

---
 imports/ui/components/partyDetails/partyDetails.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index e63b6ef..565aa4b 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -2,6 +2,8 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
 
+import { Meteor } from 'meteor/meteor';
+
 import template from './partyDetails.html';
 import { Parties } from '../../../api/parties';
 
@@ -58,6 +60,15 @@ function config($stateProvider) {
 
   $stateProvider.state('partyDetails', {
     url: '/parties/:partyId',
-    template: '<party-details></party-details>'
+    template: '<party-details></party-details>',
+    resolve: {
+      currentUser($q) {
+        if (Meteor.userId() === null) {
+          return $q.reject();
+        } else {
+          return $q.resolve();
+        }
+      }
+    }
   });
 }
-- 
2.7.4


From e98a5eea188d33687015c366d9679c26913dd882 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Tue, 26 Apr 2016 13:20:33 +0200
Subject: [PATCH 093/376] Step 8.10: Add the reason of rejection

---
 imports/ui/components/partyDetails/partyDetails.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 565aa4b..1767720 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -64,7 +64,7 @@ function config($stateProvider) {
     resolve: {
       currentUser($q) {
         if (Meteor.userId() === null) {
-          return $q.reject();
+          return $q.reject('AUTH_REQUIRED');
         } else {
           return $q.resolve();
         }
-- 
2.7.4


From 6b3e528cdeddc15666e16d1b18cd12faa6a163e9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Tue, 26 Apr 2016 13:22:23 +0200
Subject: [PATCH 094/376] Step 8.11: Handle `AUTH_REQUIRED`

---
 imports/ui/components/socially/socially.js | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index e539bf1..dec6060 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -24,7 +24,8 @@ export default angular.module(name, [
   controllerAs: name,
   controller: Socially
 })
-  .config(config);
+  .config(config)
+  .run(run);
 
 function config($locationProvider, $urlRouterProvider) {
   'ngInject';
@@ -33,3 +34,15 @@ function config($locationProvider, $urlRouterProvider) {
 
   $urlRouterProvider.otherwise('/parties');
 }
+
+function run($rootScope, $state) {
+  'ngInject';
+
+  $rootScope.$on('$stateChangeError',
+    (event, toState, toParams, fromState, fromParams, error) => {
+      if (error === 'AUTH_REQUIRED') {
+        $state.go('parties');
+      }
+    }
+  );
+}
-- 
2.7.4


From 428ede3306dbae2bf46a7f106727744a7fa312ab Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:08:59 +0200
Subject: [PATCH 095/376] Step 9.1: Remove `autopublish`

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 8ae4a69..9e4bf08 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,7 +15,6 @@ standard-minifier-css   # CSS minifier run for production mode
 standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
-autopublish             # Publish all data to the clients (for prototyping)
 pbastowski:angular-babel
 urigo:static-templates
 sanjo:jasmine
diff --git a/.meteor/versions b/.meteor/versions
index 3f4624d..c871ca9 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,7 +8,6 @@ accounts-ui-unstyled@1.1.10
 allow-deny@1.0.4
 amplify@1.0.0
 angular-templates@1.0.2
-autopublish@1.0.7
 autoupdate@1.2.8
 babel-compiler@6.6.4
 babel-runtime@0.1.8
-- 
2.7.4


From 4e92bdb3f1d1dbf88aaf5c2ea6617f66d47c9c4c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:14:30 +0200
Subject: [PATCH 096/376] Step 9.2: Add the `parties` publication to the server

---
 imports/api/parties/publish.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 imports/api/parties/publish.js

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
new file mode 100644
index 0000000..590f23b
--- /dev/null
+++ b/imports/api/parties/publish.js
@@ -0,0 +1,31 @@
+import { Meteor } from 'meteor/meteor';
+
+import { Parties } from './collection';
+
+if (Meteor.isServer) {
+  Meteor.publish('parties', function() {
+    const selector = {
+      $or: [{
+        // the public parties
+        $and: [{
+          public: true
+        }, {
+          public: {
+            $exists: true
+          }
+        }]
+      }, {
+        // when logged in user is the owner
+        $and: [{
+          owner: this.userId
+        }, {
+          owner: {
+            $exists: true
+          }
+        }]
+      }]
+    };
+
+    return Parties.find(selector);
+  });
+}
-- 
2.7.4


From e668d08432e3bb235b981731a47a08d78ae6d205 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:15:16 +0200
Subject: [PATCH 097/376] Step 9.3: Move Parties to collection.js

---
 imports/api/parties/collection.js | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 imports/api/parties/collection.js

diff --git a/imports/api/parties/collection.js b/imports/api/parties/collection.js
new file mode 100644
index 0000000..3e283c1
--- /dev/null
+++ b/imports/api/parties/collection.js
@@ -0,0 +1,15 @@
+import { Mongo } from 'meteor/mongo';
+
+export const Parties = new Mongo.Collection('parties');
+
+Parties.allow({
+  insert(userId, party) {
+    return userId && party.owner === userId;
+  },
+  update(userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove(userId, party) {
+    return userId && party.owner === userId;
+  }
+});
-- 
2.7.4


From a246103a60e5e43cd4749e396c06ffd468d73572 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:15:55 +0200
Subject: [PATCH 098/376] Step 9.4: Create entry point for Parties

---
 imports/api/parties/index.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/api/parties/index.js

diff --git a/imports/api/parties/index.js b/imports/api/parties/index.js
new file mode 100644
index 0000000..5f7ae00
--- /dev/null
+++ b/imports/api/parties/index.js
@@ -0,0 +1,3 @@
+import './publish';
+
+export * from './collection';
-- 
2.7.4


From 23adb197d4904c0f9391399dcdb7532816edf55f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:16:11 +0200
Subject: [PATCH 099/376] Step 9.5: Remove old parties.js

---
 imports/api/parties.js | 15 ---------------
 1 file changed, 15 deletions(-)
 delete mode 100644 imports/api/parties.js

diff --git a/imports/api/parties.js b/imports/api/parties.js
deleted file mode 100644
index 3e283c1..0000000
--- a/imports/api/parties.js
+++ /dev/null
@@ -1,15 +0,0 @@
-import { Mongo } from 'meteor/mongo';
-
-export const Parties = new Mongo.Collection('parties');
-
-Parties.allow({
-  insert(userId, party) {
-    return userId && party.owner === userId;
-  },
-  update(userId, party, fields, modifier) {
-    return userId && party.owner === userId;
-  },
-  remove(userId, party) {
-    return userId && party.owner === userId;
-  }
-});
-- 
2.7.4


From 8dc27c8d247d6b0b7f9828fff3dbf5746c2b41da Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:18:56 +0200
Subject: [PATCH 100/376] Step 9.6: Add the `parties` subscription

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 54e8ad3..7aced57 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -13,6 +13,8 @@ class PartiesList {
 
     $reactive(this).attach($scope);
 
+    this.subscribe('parties');
+
     this.helpers({
       parties() {
         return Parties.find({});
-- 
2.7.4


From 5a715f8fb25c570909cc6d4afca0bd3fe4431bb2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:20:20 +0200
Subject: [PATCH 101/376] Step 9.7: Add public party checkbox to the add new
 party form

---
 imports/ui/components/partyAdd/partyAdd.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index 3508bef..4db1888 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -7,5 +7,9 @@
     Description:
   </label>
   <input type="text" ng-model="partyAdd.party.description" />
+  <label>
+    Public Party?
+  </label>
+  <input type="checkbox" ng-model="partyAdd.party.public">
   <button ng-click="partyAdd.submit()">Add Party!</button>
 </form>
-- 
2.7.4


From 7dfebf8f40cc761575e71cf663ca189e1b4d2e4f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:20:49 +0200
Subject: [PATCH 102/376] Step 9.8: Add is public checkbox to the party details
 view

---
 imports/ui/components/partyDetails/partyDetails.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index b5c939b..4e0cc68 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -2,6 +2,7 @@ The party your selected is:
 <form>
   Party name: <input type="text" ng-model="partyDetails.party.name" />
   Description: <input type="text" ng-model="partyDetails.party.description" />
+  Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
   <button ng-click="partyDetails.save()">Save</button>
 </form>
 
-- 
2.7.4


From 5909a51fd55da54b58a3fa0b59be36fdbd775cc3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:21:31 +0200
Subject: [PATCH 103/376] Step 9.9: Add is public checkbox to the party details
 component

---
 imports/ui/components/partyDetails/partyDetails.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 1767720..903ec9d 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -30,7 +30,8 @@ class PartyDetails {
     }, {
       $set: {
         name: this.party.name,
-        description: this.party.description
+        description: this.party.description,
+        public: this.party.public
       }
     }, (error) => {
       if (error) {
-- 
2.7.4


From 9c8cd2d20f4446f70078a7f70e9050556ac3e3ed Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:22:34 +0200
Subject: [PATCH 104/376] Step 9.10: Add `parties` subscription to the
 PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 903ec9d..9c6a6f7 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -15,6 +15,8 @@ class PartyDetails {
 
     this.partyId = $stateParams.partyId;
 
+    this.subscribe('parties');
+
     this.helpers({
       party() {
         return Parties.findOne({
-- 
2.7.4


From e39661107f22343a297d5e44ee14f06226b14815 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:24:09 +0200
Subject: [PATCH 105/376] Step 9.11: Create the users publication

---
 imports/api/users.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 imports/api/users.js

diff --git a/imports/api/users.js b/imports/api/users.js
new file mode 100644
index 0000000..4c9fee9
--- /dev/null
+++ b/imports/api/users.js
@@ -0,0 +1,12 @@
+import { Meteor } from 'meteor/meteor';
+
+if (Meteor.isServer) {
+  Meteor.publish('users', function() {
+    return Meteor.users.find({}, {
+      fields: {
+        emails: 1,
+        profile: 1
+      }
+    });
+  });
+}
-- 
2.7.4


From e3a07b49c9db0f15826d277295a0116270af2785 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:24:32 +0200
Subject: [PATCH 106/376] Step 9.12: Add `users` publication to the server-side

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.js b/server/main.js
index d4c97f0..1acdc6c 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1,2 +1,3 @@
 import '../imports/startup/fixtures';
 import '../imports/api/parties';
+import '../imports/api/users';
-- 
2.7.4


From c3001f540f2191ef4e3b692efbd89c2a827887d1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:26:29 +0200
Subject: [PATCH 107/376] Step 9.13: Add `users` subscription and helper

---
 imports/ui/components/partyDetails/partyDetails.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 9c6a6f7..a526c43 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -16,12 +16,16 @@ class PartyDetails {
     this.partyId = $stateParams.partyId;
 
     this.subscribe('parties');
+    this.subscribe('users');
 
     this.helpers({
       party() {
         return Parties.findOne({
           _id: $stateParams.partyId
         });
+      },
+      users() {
+        return Meteor.users.find({});
       }
     });
   }
-- 
2.7.4


From 6ff05602519534e73a94fdd36216599b85c87a90 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:27:20 +0200
Subject: [PATCH 108/376] Step 9.14: Add the users list to the party details
 view

---
 imports/ui/components/partyDetails/partyDetails.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 4e0cc68..99de077 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -7,3 +7,10 @@ The party your selected is:
 </form>
 
 <button ui-sref="parties">Back</button>
+
+<ul>
+  Users:
+  <li ng-repeat="user in partyDetails.users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
-- 
2.7.4


From ef64cb97401234555871b75a182609f4dcd6857b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:44:26 +0200
Subject: [PATCH 109/376] Step 9.15: Update tests of PartyAdd

---
 imports/ui/components/partyAdd/client/partyAdd.tests.js | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyAdd/client/partyAdd.tests.js b/imports/ui/components/partyAdd/client/partyAdd.tests.js
index cc1d35e..3d27875 100644
--- a/imports/ui/components/partyAdd/client/partyAdd.tests.js
+++ b/imports/ui/components/partyAdd/client/partyAdd.tests.js
@@ -1,3 +1,4 @@
+import { Meteor } from 'meteor/meteor';
 import { name as PartyAdd } from '../partyAdd';
 import { Parties } from '../../../../api/parties';
 import 'angular-mocks';
@@ -11,7 +12,11 @@ describe('PartyAdd', () => {
     let controller;
     const party = {
       name: 'Foo',
-      description: 'Birthday of Foo'
+      description: 'Birthday of Foo',
+      public: true
+    };
+    const user = {
+      _id: 'userId'
     };
 
     beforeEach(() => {
@@ -20,6 +25,8 @@ describe('PartyAdd', () => {
           $scope: $rootScope.$new(true)
         });
       });
+
+      spyOn(Meteor, 'user').and.returnValue(user);
     });
 
     describe('reset()', () => {
@@ -42,7 +49,12 @@ describe('PartyAdd', () => {
       });
 
       it('should insert a new party', () => {
-        expect(Parties.insert).toHaveBeenCalledWith(party);
+        expect(Parties.insert).toHaveBeenCalledWith({
+          name: party.name,
+          description: party.description,
+          public: party.public,
+          owner: user._id
+        });
       });
 
       it('should call reset()', () => {
-- 
2.7.4


From 1d7ddee2b68e4cb86c6f72120498a35e495dbc8e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:45:37 +0200
Subject: [PATCH 110/376] Step 9.16: Update tests of PartyDetails

---
 imports/ui/components/partyDetails/client/partyDetails.tests.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyDetails/client/partyDetails.tests.js b/imports/ui/components/partyDetails/client/partyDetails.tests.js
index 997304e..0f3aa3b 100644
--- a/imports/ui/components/partyDetails/client/partyDetails.tests.js
+++ b/imports/ui/components/partyDetails/client/partyDetails.tests.js
@@ -12,7 +12,8 @@ describe('PartyDetails', () => {
     const party = {
       _id: 'partyId',
       name: 'Foo',
-      description: 'Birthday of Foo'
+      description: 'Birthday of Foo',
+      public: true
     };
 
     beforeEach(() => {
@@ -40,7 +41,8 @@ describe('PartyDetails', () => {
         expect(Parties.update.calls.mostRecent().args[1]).toEqual({
           $set: {
             name: party.name,
-            description: party.description
+            description: party.description,
+            public: party.public
           }
         });
       });
-- 
2.7.4


From 37ab9b218367964f9842d36a8f13b71af4c718f4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:29:01 +0200
Subject: [PATCH 111/376] Step 11.1: Update the module initialization

---
 client/main.js | 17 ++++++++++++++++-
 1 file changed, 16 insertions(+), 1 deletion(-)

diff --git a/client/main.js b/client/main.js
index 212f992..06731e1 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,4 +1,19 @@
 import angular from 'angular';
-import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
 
 import { name as Socially } from '../imports/ui/components/socially/socially';
+
+function onReady() {
+  angular.bootstrap(document, [
+    Socially
+  ], {
+    strictDi: true
+  });
+}
+
+if (Meteor.isCordova) {
+  angular.element(document).on('deviceready', onReady);
+} else {
+  angular.element(document).ready(onReady);
+}
-- 
2.7.4


From f4b291260f98ed03e998884a13ba2c487738e5b7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:29:45 +0200
Subject: [PATCH 112/376] Step 11.2: Remove the ngApp and ngStrictDi

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 806f6ab..0a26426 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,6 +1,6 @@
 <head>
   <base href="/">
 </head>
-<body ng-app="socially" ng-strict-di="">
+<body>
   <socially></socially>
 </body>
-- 
2.7.4


From 8d12d0bc5a4a0bf1057930459843a006d5ef9a76 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:32:51 +0200
Subject: [PATCH 113/376] Step 12.1: Add options to the parties publish

---
 imports/api/parties/publish.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 590f23b..65b8f38 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -3,7 +3,7 @@ import { Meteor } from 'meteor/meteor';
 import { Parties } from './collection';
 
 if (Meteor.isServer) {
-  Meteor.publish('parties', function() {
+  Meteor.publish('parties', function(options) {
     const selector = {
       $or: [{
         // the public parties
@@ -26,6 +26,6 @@ if (Meteor.isServer) {
       }]
     };
 
-    return Parties.find(selector);
+    return Parties.find(selector, options);
   });
 }
-- 
2.7.4


From 36c35a497e0c6d1666e21661640d471fc5391597 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:33:40 +0200
Subject: [PATCH 114/376] Step 12.2: Add the pagination default params

---
 imports/ui/components/partiesList/partiesList.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 7aced57..a68c32d 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -13,6 +13,12 @@ class PartiesList {
 
     $reactive(this).attach($scope);
 
+    this.perPage = 3;
+    this.page = 1;
+    this.sort = {
+      name: 1
+    };
+
     this.subscribe('parties');
 
     this.helpers({
-- 
2.7.4


From 9d02d30d8df7f592d96dc50a186bcdaafd085b2b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:35:13 +0200
Subject: [PATCH 115/376] Step 12.3: Add the params to the subscription

---
 imports/ui/components/partiesList/partiesList.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index a68c32d..8c04090 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -19,7 +19,11 @@ class PartiesList {
       name: 1
     };
 
-    this.subscribe('parties');
+    this.subscribe('parties', () => [{
+      limit: parseInt(this.perPage),
+      skip: parseInt((this.getReactively('page') - 1) * this.perPage),
+      sort: this.getReactively('sort')}
+    ]);
 
     this.helpers({
       parties() {
-- 
2.7.4


From 7636ca2cb1a2d21f2e81b736df86072b54d65e56 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:36:07 +0200
Subject: [PATCH 116/376] Step 12.4: Add the sort parameter to the collection
 helper

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 8c04090..9d3493a 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -27,7 +27,9 @@ class PartiesList {
 
     this.helpers({
       parties() {
-        return Parties.find({});
+        return Parties.find({}, {
+          sort : this.getReactively('sort')
+        });
       }
     });
   }
-- 
2.7.4


From 53d773087658e803d702a3a8c287baf8b649202a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:37:39 +0200
Subject: [PATCH 117/376] Step 12.5: Install `angular-utils-pagination`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index b8cdb95..3df8d27 100644
--- a/package.json
+++ b/package.json
@@ -9,6 +9,7 @@
     "angular": "^1.5.3",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
+    "angular-utils-pagination": "^0.11.1",
     "meteor-node-stubs": "~0.2.0"
   },
   "devDependencies": {
-- 
2.7.4


From 08bfdd588387311d9be2a5d39d349954e0cdb087 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:38:35 +0200
Subject: [PATCH 118/376] Step 12.6: Add new dependency

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 9d3493a..cae9853 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,6 +1,7 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
+import utilsPagination from 'angular-utils-pagination';
 
 import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
@@ -41,6 +42,7 @@ const name = 'partiesList';
 export default angular.module(name, [
   angularMeteor,
   uiRouter,
+  utilsPagination,
   PartyAdd,
   PartyRemove
 ]).component(name, {
-- 
2.7.4


From ccf9ad4edbef364aaab971798e67240b68459db8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:39:32 +0200
Subject: [PATCH 119/376] Step 12.7: Add usage to the dir-pagination directive

---
 imports/ui/components/partiesList/partiesList.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index c1b07e2..71b36ae 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,7 +1,7 @@
 <party-add></party-add>
 
 <ul>
-  <li ng-repeat="party in partiesList.parties">
+  <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     <a ui-sref="partyDetails({ partyId: party._id })">
       {{party.name}}
     </a>
-- 
2.7.4


From 0c709aa46244dd7a268d645d4e4a3ea4bf0845c6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:39:54 +0200
Subject: [PATCH 120/376] Step 12.8: Add the pagination controls to the view

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 71b36ae..d4206d6 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -9,3 +9,5 @@
     <party-remove party="party"></party-remove>
   </li>
 </ul>
+
+<dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-- 
2.7.4


From ca13fd2572fd1fad512f2a0e60ac61625d0ac5c7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:40:29 +0200
Subject: [PATCH 121/376] Step 12.9: Add the pageChanged method to the
 component

---
 imports/ui/components/partiesList/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index cae9853..1d73e64 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -34,6 +34,10 @@ class PartiesList {
       }
     });
   }
+
+  pageChanged(newPage) {
+    this.page = newPage;
+  }
 }
 
 const name = 'partiesList';
-- 
2.7.4


From f0cbce3c394c92c280b44b12a74e03b97dac50fa Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:41:20 +0200
Subject: [PATCH 122/376] Step 12.10: Add `tmeasday:publish-counts`

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 9e4bf08..f33cc77 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -24,3 +24,4 @@ accounts-password
 dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index c871ca9..8c637d3 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -89,6 +89,7 @@ standard-minifier-js@1.0.6
 templating@1.1.7
 templating-tools@1.0.2
 tmeasday:check-npm-versions@0.1.1
+tmeasday:publish-counts@0.7.3
 tracker@1.0.13
 twitter@1.1.7
 ui@1.0.11
-- 
2.7.4


From 1c2322346e0ce3b50e08e63d69dceda4dda5a6fa Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:42:27 +0200
Subject: [PATCH 123/376] Step 12.11: Add usage of Counts

---
 imports/api/parties/publish.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 65b8f38..4932df2 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -1,4 +1,5 @@
 import { Meteor } from 'meteor/meteor';
+import { Counts } from 'meteor/tmeasday:publish-counts';
 
 import { Parties } from './collection';
 
@@ -26,6 +27,10 @@ if (Meteor.isServer) {
       }]
     };
 
+    Counts.publish(this, 'numberOfParties', Parties.find(selector), {
+      noReady: true
+    });
+
     return Parties.find(selector, options);
   });
 }
-- 
2.7.4


From df37c7b2a8c6cd73a2ab7cbf9db2f239fd81d216 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:44:44 +0200
Subject: [PATCH 124/376] Step 12.12: Add the Count usage in the component

---
 imports/ui/components/partiesList/partiesList.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 1d73e64..6282160 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -3,6 +3,8 @@ import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
 import utilsPagination from 'angular-utils-pagination';
 
+import { Counts } from 'meteor/tmeasday:publish-counts';
+
 import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
@@ -31,6 +33,9 @@ class PartiesList {
         return Parties.find({}, {
           sort : this.getReactively('sort')
         });
+      },
+      partiesCount() {
+        return Counts.get('numberOfParties');
       }
     });
   }
-- 
2.7.4


From b8b8643c2d717be44ed8377371855bdc29027b3d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:47:04 +0200
Subject: [PATCH 125/376] Step 12.13: Create view for PartiesSort component

---
 imports/ui/components/partiesSort/partiesSort.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partiesSort/partiesSort.html

diff --git a/imports/ui/components/partiesSort/partiesSort.html b/imports/ui/components/partiesSort/partiesSort.html
new file mode 100644
index 0000000..cf2102b
--- /dev/null
+++ b/imports/ui/components/partiesSort/partiesSort.html
@@ -0,0 +1,6 @@
+<div>
+  <select ng-model="partiesSort.order" ng-change="partiesSort.changed()">
+    <option value="1">Ascending</option>
+    <option value="-1">Descending</option>
+  </select>
+</div>
-- 
2.7.4


From b93e344ebff255f6a01bbd18b68b66db5a454f83 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:48:25 +0200
Subject: [PATCH 126/376] Step 12.14: Create PartiesSort component

---
 imports/ui/components/partiesSort/partiesSort.js | 34 ++++++++++++++++++++++++
 1 file changed, 34 insertions(+)
 create mode 100644 imports/ui/components/partiesSort/partiesSort.js

diff --git a/imports/ui/components/partiesSort/partiesSort.js b/imports/ui/components/partiesSort/partiesSort.js
new file mode 100644
index 0000000..d5ff3fb
--- /dev/null
+++ b/imports/ui/components/partiesSort/partiesSort.js
@@ -0,0 +1,34 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './partiesSort.html';
+
+class PartiesSort {
+  constructor() {
+    this.changed();
+  }
+
+  changed() {
+    this.onChange({
+      sort: {
+        [this.property]: parseInt(this.order)
+      }
+    });
+  }
+}
+
+const name = 'partiesSort';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  bindings: {
+    onChange: '&',
+    property: '@',
+    order: '@'
+  },
+  controllerAs: name,
+  controller: PartiesSort
+});
-- 
2.7.4


From c5e09bd4633beb75a72ee5398bc7c79eb6239d67 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:49:26 +0200
Subject: [PATCH 127/376] Step 12.15: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 6282160..3fa1641 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -7,6 +7,7 @@ import { Counts } from 'meteor/tmeasday:publish-counts';
 
 import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
+import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 
@@ -52,6 +53,7 @@ export default angular.module(name, [
   angularMeteor,
   uiRouter,
   utilsPagination,
+  PartiesSort,
   PartyAdd,
   PartyRemove
 ]).component(name, {
-- 
2.7.4


From d79df3e2986af6124a94eebab993371b5ef4a5c8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:50:20 +0200
Subject: [PATCH 128/376] Step 12.16: Implement component

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index d4206d6..0fe847e 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,5 +1,7 @@
 <party-add></party-add>
 
+<parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
+
 <ul>
   <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     <a ui-sref="partyDetails({ partyId: party._id })">
-- 
2.7.4


From 0cfe1ccf6ebadc4368ccb761e514e3b5692d0765 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:51:09 +0200
Subject: [PATCH 129/376] Step 12.17: Handle sort changes

---
 imports/ui/components/partiesList/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 3fa1641..199a0b8 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -44,6 +44,10 @@ class PartiesList {
   pageChanged(newPage) {
     this.page = newPage;
   }
+
+  sortChanged(sort) {
+    this.sort = sort;
+  }
 }
 
 const name = 'partiesList';
-- 
2.7.4


From 74a8b45fd6c061147b876eb39267f2632813dd7a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:12:35 +0200
Subject: [PATCH 130/376] Step 12.18: Add searchString to `parties` publication

---
 imports/api/parties/publish.js | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 4932df2..67c9bdb 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -4,7 +4,7 @@ import { Counts } from 'meteor/tmeasday:publish-counts';
 import { Parties } from './collection';
 
 if (Meteor.isServer) {
-  Meteor.publish('parties', function(options) {
+  Meteor.publish('parties', function(options, searchString) {
     const selector = {
       $or: [{
         // the public parties
@@ -27,6 +27,13 @@ if (Meteor.isServer) {
       }]
     };
 
+    if (typeof searchString === 'string' && searchString.length) {
+      selector.name = {
+        $regex: `.*${searchString}.*`,
+        $options : 'i'
+      };
+    }
+
     Counts.publish(this, 'numberOfParties', Parties.find(selector), {
       noReady: true
     });
-- 
2.7.4


From f53925abff4f492ade7ff4e5fb9ca4f2cd146614 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:15:46 +0200
Subject: [PATCH 131/376] Step 12.19: Add searchText to subscription

---
 imports/ui/components/partiesList/partiesList.js | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 199a0b8..c7221df 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -22,11 +22,13 @@ class PartiesList {
     this.sort = {
       name: 1
     };
+    this.searchText = '';
 
     this.subscribe('parties', () => [{
-      limit: parseInt(this.perPage),
-      skip: parseInt((this.getReactively('page') - 1) * this.perPage),
-      sort: this.getReactively('sort')}
+        limit: parseInt(this.perPage),
+        skip: parseInt((this.getReactively('page') - 1) * this.perPage),
+        sort: this.getReactively('sort')
+      }, this.getReactively('searchText')
     ]);
 
     this.helpers({
-- 
2.7.4


From 7fa807def06f2aaa92a354ebea17e3723c58dbb2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:16:30 +0200
Subject: [PATCH 132/376] Step 12.20: Add input with searchText as ngModel

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 0fe847e..3c411fe 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,5 +1,7 @@
 <party-add></party-add>
 
+<input type="search" ng-model="partiesList.searchText" placeholder="Search" />
+
 <parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
 
 <ul>
-- 
2.7.4


From 243cd2f3837d28ea6fad0614148d8d06c644d3f7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:59:07 +0200
Subject: [PATCH 133/376] Step 12.21: Tests of PartiesSort

---
 .../partiesSort/client/partiesSort.tests.js        | 54 ++++++++++++++++++++++
 1 file changed, 54 insertions(+)
 create mode 100644 imports/ui/components/partiesSort/client/partiesSort.tests.js

diff --git a/imports/ui/components/partiesSort/client/partiesSort.tests.js b/imports/ui/components/partiesSort/client/partiesSort.tests.js
new file mode 100644
index 0000000..09d81b4
--- /dev/null
+++ b/imports/ui/components/partiesSort/client/partiesSort.tests.js
@@ -0,0 +1,54 @@
+import { name as PartiesSort } from '../partiesSort';
+import 'angular-mocks';
+
+describe('PartiesSort', () => {
+  beforeEach(() => {
+    window.module(PartiesSort);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const onChange = function() {};
+    const property = 'name';
+    const order = -1;
+
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartiesSort, {
+          $scope: $rootScope.$new(true)
+        }, {
+          onChange,
+          property,
+          order
+        });
+      });
+    });
+
+    it('should set property', () => {
+      expect(controller.property).toEqual(property);
+    });
+
+    it('should set order', () => {
+      expect(controller.order).toEqual(order);
+    });
+
+    it('should set onChange', () => {
+      expect(controller.onChange).toBe(onChange);
+    });
+
+    describe('changed()', () => {
+      it('should call onChange expression', () => {
+        spyOn(controller, 'onChange');
+
+        controller.changed();
+
+        expect(controller.onChange).toHaveBeenCalledWith({
+          sort: {
+            [property]: order
+          }
+        });
+      });
+    });
+  });
+});
-- 
2.7.4


From cfbaf2ed485678bd88c7922a870ac7a271ae7649 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:07:14 +0200
Subject: [PATCH 134/376] Step 12.22: Tests of PartiesList

---
 .../partiesList/client/partiesList.tests.js        | 50 ++++++++++++++++++++++
 1 file changed, 50 insertions(+)
 create mode 100644 imports/ui/components/partiesList/client/partiesList.tests.js

diff --git a/imports/ui/components/partiesList/client/partiesList.tests.js b/imports/ui/components/partiesList/client/partiesList.tests.js
new file mode 100644
index 0000000..176da85
--- /dev/null
+++ b/imports/ui/components/partiesList/client/partiesList.tests.js
@@ -0,0 +1,50 @@
+import { name as PartiesList } from '../partiesList';
+import 'angular-mocks';
+
+describe('PartiesList', () => {
+  beforeEach(() => {
+    window.module(PartiesList);
+  });
+
+  describe('controller', () => {
+    let controller;
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartiesList, {
+          $scope: $rootScope.$new(true)
+        });
+      });
+    });
+
+    it('should have perPage that equals 3 by default', () => {
+      expect(controller.perPage).toEqual(3);
+    });
+
+    it('should have page that equals 1 by default', () => {
+      expect(controller.page).toEqual(1);
+    });
+
+    it('should sort by name - ASC', () => {
+      expect(controller.sort).toEqual({
+        name: 1
+      });
+    });
+
+    it('should be able to change sorting', () => {
+      controller.sortChanged({
+        name: -1
+      });
+
+      expect(controller.sort).toEqual({
+        name: -1
+      });
+    });
+
+    it('should be able to change page', () => {
+      controller.pageChanged(2);
+
+      expect(controller.page).toEqual(2);
+    });
+  });
+});
-- 
2.7.4


From ad76e3f778c6d568a88a2a1662f92c0d70a978f1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:23:07 +0200
Subject: [PATCH 135/376] Step 13.1: Create UninvitedFilter

---
 imports/ui/filters/uninvitedFilter.js | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 imports/ui/filters/uninvitedFilter.js

diff --git a/imports/ui/filters/uninvitedFilter.js b/imports/ui/filters/uninvitedFilter.js
new file mode 100644
index 0000000..77528fc
--- /dev/null
+++ b/imports/ui/filters/uninvitedFilter.js
@@ -0,0 +1,20 @@
+import angular from 'angular';
+
+const name = 'uninvitedFilter';
+
+function UninvitedFilter(users, party) {
+  if (!party) {
+    return false;
+  }
+
+  return users.filter((user) => {
+    // if not the owner and not invited
+    return user._id !== party.owner && (party.invited || []).indexOf(user._id) === -1;
+  });
+}
+
+// create a module
+export default angular.module(name, [])
+  .filter(name, () => {
+    return UninvitedFilter;
+  });
-- 
2.7.4


From 938cf6af22bb2f6d5206ca53e36b0cf6a9ec9da1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:24:04 +0200
Subject: [PATCH 136/376] Step 13.2: Install `underscore`

---
 package.json | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 3df8d27..9e6806d 100644
--- a/package.json
+++ b/package.json
@@ -10,7 +10,8 @@
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
     "angular-utils-pagination": "^0.11.1",
-    "meteor-node-stubs": "~0.2.0"
+    "meteor-node-stubs": "~0.2.0",
+    "underscore": "^1.8.3"
   },
   "devDependencies": {
     "angular-mocks": "^1.5.3"
-- 
2.7.4


From 026206e0a08cdda5d2fe65315deceff3e38587a2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:24:21 +0200
Subject: [PATCH 137/376] Step 13.3: Use underscore

---
 imports/ui/filters/uninvitedFilter.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/filters/uninvitedFilter.js b/imports/ui/filters/uninvitedFilter.js
index 77528fc..cfe8d2d 100644
--- a/imports/ui/filters/uninvitedFilter.js
+++ b/imports/ui/filters/uninvitedFilter.js
@@ -1,4 +1,5 @@
 import angular from 'angular';
+import _ from 'underscore';
 
 const name = 'uninvitedFilter';
 
@@ -9,7 +10,7 @@ function UninvitedFilter(users, party) {
 
   return users.filter((user) => {
     // if not the owner and not invited
-    return user._id !== party.owner && (party.invited || []).indexOf(user._id) === -1;
+    return user._id !== party.owner && !_.contains(party.invited, user._id);
   });
 }
 
-- 
2.7.4


From 451fdf9b6fa863e7fbb82ef56503607eee4f19a3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:26:20 +0200
Subject: [PATCH 138/376] Step 13.4: Move list of users to separate component

---
 imports/ui/components/partyUninvited/partyUninvited.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partyUninvited/partyUninvited.html

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
new file mode 100644
index 0000000..ac0bbc7
--- /dev/null
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -0,0 +1,6 @@
+<ul>
+  Users:
+  <li ng-repeat="user in partyUninvited.users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
-- 
2.7.4


From 32736adde8cb6f88adf05e20884adf112e07c0fe Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:30:02 +0200
Subject: [PATCH 139/376] Step 13.5: Create PartyUninvited component

---
 .../ui/components/partyUninvited/partyUninvited.js | 34 ++++++++++++++++++++++
 1 file changed, 34 insertions(+)
 create mode 100644 imports/ui/components/partyUninvited/partyUninvited.js

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
new file mode 100644
index 0000000..8ae1e9b
--- /dev/null
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -0,0 +1,34 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './partyUninvited.html';
+
+class PartyUninvited {
+  constructor($scope) {
+    'ngInject';
+
+    $scope.viewModel(this);
+
+    this.helpers({
+      users() {
+        return Meteor.users.find({});
+      }
+    });
+  }
+}
+
+const name = 'partyUninvited';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyUninvited
+});
-- 
2.7.4


From aabbea3430d34aea8e9e87791d0abd721d2ddee3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:30:46 +0200
Subject: [PATCH 140/376] Step 13.6: Add UninvitedFilter

---
 imports/ui/components/partyUninvited/partyUninvited.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
index 8ae1e9b..2489fc2 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.js
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -4,6 +4,7 @@ import angularMeteor from 'angular-meteor';
 import { Meteor } from 'meteor/meteor';
 
 import template from './partyUninvited.html';
+import { name as UninvitedFilter } from '../../filters/uninvitedFilter';
 
 class PartyUninvited {
   constructor($scope) {
@@ -23,7 +24,8 @@ const name = 'partyUninvited';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  UninvitedFilter
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 2bd5ce21382983a51f6c54a475fd4ae0079a1768 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:31:26 +0200
Subject: [PATCH 141/376] Step 13.7: Implement filter

---
 imports/ui/components/partyUninvited/partyUninvited.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index ac0bbc7..c1ccda5 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -1,6 +1,6 @@
 <ul>
-  Users:
-  <li ng-repeat="user in partyUninvited.users">
+  Users to invite:
+  <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
     <div>{{ user.emails[0].address }}</div>
   </li>
 </ul>
-- 
2.7.4


From 56b33b6375844123485bd7dae36d1ebdda9a9fea Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:32:22 +0200
Subject: [PATCH 142/376] Step 13.8: Implement component in PartyDetails view

---
 imports/ui/components/partyDetails/partyDetails.html | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 99de077..916f23e 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -8,9 +8,4 @@ The party your selected is:
 
 <button ui-sref="parties">Back</button>
 
-<ul>
-  Users:
-  <li ng-repeat="user in partyDetails.users">
-    <div>{{ user.emails[0].address }}</div>
-  </li>
-</ul>
+<party-uninvited party="partyDetails.party"></party-uninvited>
-- 
2.7.4


From 8d583524f5013340fd941e8c5e9d21f597a2774a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:33:20 +0200
Subject: [PATCH 143/376] Step 13.9: Add to dependencies

---
 imports/ui/components/partyDetails/partyDetails.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index a526c43..5443915 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -6,6 +6,7 @@ import { Meteor } from 'meteor/meteor';
 
 import template from './partyDetails.html';
 import { Parties } from '../../../api/parties';
+import { name as PartyUninvited } from '../partyUninvited/partyUninvited';
 
 class PartyDetails {
   constructor($stateParams, $scope, $reactive) {
@@ -54,7 +55,8 @@ const name = 'partyDetails';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  uiRouter
+  uiRouter,
+  PartyUninvited
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From ae5ae766940937f3107f4051acc194f610d16881 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:40:30 +0200
Subject: [PATCH 144/376] Step 13.10: Create DisplayNameFilter

---
 imports/ui/filters/displayNameFilter.js | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 imports/ui/filters/displayNameFilter.js

diff --git a/imports/ui/filters/displayNameFilter.js b/imports/ui/filters/displayNameFilter.js
new file mode 100644
index 0000000..57d9250
--- /dev/null
+++ b/imports/ui/filters/displayNameFilter.js
@@ -0,0 +1,25 @@
+import angular from 'angular';
+
+const name = 'displayNameFilter';
+
+function DisplayNameFilter(user) {
+  if (!user) {
+    return '';
+  }
+
+  if (user.profile && user.profile.name) {
+    return user.profile.name;
+  }
+
+  if (user.emails) {
+    return user.emails[0].address;
+  }
+
+  return user;
+}
+
+// create a module
+export default angular.module(name, [])
+  .filter(name, () => {
+    return DisplayNameFilter;
+  });
-- 
2.7.4


From e7901ce287f78f41d484e035c2362e2d6e25fab3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:41:15 +0200
Subject: [PATCH 145/376] Step 13.11: Add as a dependency

---
 imports/ui/components/partyUninvited/partyUninvited.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
index 2489fc2..ca195d5 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.js
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -5,6 +5,7 @@ import { Meteor } from 'meteor/meteor';
 
 import template from './partyUninvited.html';
 import { name as UninvitedFilter } from '../../filters/uninvitedFilter';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
 
 class PartyUninvited {
   constructor($scope) {
@@ -25,7 +26,8 @@ const name = 'partyUninvited';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  UninvitedFilter
+  UninvitedFilter,
+  DisplayNameFilter
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From b588c9a5b05389f224e123d448a0f7c1faba3355 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:41:54 +0200
Subject: [PATCH 146/376] Step 13.12: Use filter

---
 imports/ui/components/partyUninvited/partyUninvited.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index c1ccda5..9603f3a 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -1,6 +1,6 @@
 <ul>
   Users to invite:
   <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayNameFilter }}</div>
   </li>
 </ul>
-- 
2.7.4


From c080ca3ead8a0d504d98f12e1c026b3b126bad80 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:45:34 +0200
Subject: [PATCH 147/376] Step 13.13: Create template for PartyCreator
 component

---
 imports/ui/components/partyCreator/partyCreator.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/partyCreator.html

diff --git a/imports/ui/components/partyCreator/partyCreator.html b/imports/ui/components/partyCreator/partyCreator.html
new file mode 100644
index 0000000..de986fb
--- /dev/null
+++ b/imports/ui/components/partyCreator/partyCreator.html
@@ -0,0 +1,5 @@
+<p>
+  <small>
+    Posted by {{ partyCreator.creator | displayNameFilter }}
+  </small>
+</p>
-- 
2.7.4


From 83876f0cebe600d7fc64ffa0eaf87dc5c03ddf56 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:45:54 +0200
Subject: [PATCH 148/376] Step 13.14: Create PartyCreator component

---
 imports/ui/components/partyCreator/partyCreator.js | 49 ++++++++++++++++++++++
 1 file changed, 49 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/partyCreator.js

diff --git a/imports/ui/components/partyCreator/partyCreator.js b/imports/ui/components/partyCreator/partyCreator.js
new file mode 100644
index 0000000..416d637
--- /dev/null
+++ b/imports/ui/components/partyCreator/partyCreator.js
@@ -0,0 +1,49 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './partyCreator.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+/**
+ * PartyCreator component
+ */
+class PartyCreator {
+  constructor($scope) {
+    'ngInject';
+
+    $scope.viewModel(this);
+
+    this.helpers({
+      creator() {
+        if (!this.party) {
+          return '';
+        }
+
+        const owner = this.party.owner;
+
+        if (Meteor.userId() !== null && owner === Meteor.userId()) {
+          return 'me';
+        }
+
+        return Meteor.users.findOne(owner) || 'nobody';
+      }
+    });
+  }
+}
+
+const name = 'partyCreator';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyCreator
+});
-- 
2.7.4


From dec4157557e595f92141b34df7e5d0cb63d21848 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:46:14 +0200
Subject: [PATCH 149/376] Step 13.15: Implement component

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 3c411fe..2b18723 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -11,6 +11,7 @@
     </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
+    <party-creator party="party"></party-creator>
   </li>
 </ul>
 
-- 
2.7.4


From e5a7ab2ce40ac566950e6da06479c5ac7ecf9468 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:46:39 +0200
Subject: [PATCH 150/376] Step 13.16: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index c7221df..919bf88 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -10,6 +10,7 @@ import { Parties } from '../../../api/parties';
 import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
+import { name as PartyCreator } from '../partyCreator/partyCreator';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -61,7 +62,8 @@ export default angular.module(name, [
   utilsPagination,
   PartiesSort,
   PartyAdd,
-  PartyRemove
+  PartyRemove,
+  PartyCreator
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From df5b1f6c26dfa1ce9ed6925e735c194e8cd077fd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:06:21 +0200
Subject: [PATCH 151/376] Step 13.17: Tests of PartyCreator

---
 .../partyCreator/client/partyCreator.tests.js      | 81 ++++++++++++++++++++++
 1 file changed, 81 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/client/partyCreator.tests.js

diff --git a/imports/ui/components/partyCreator/client/partyCreator.tests.js b/imports/ui/components/partyCreator/client/partyCreator.tests.js
new file mode 100644
index 0000000..dabb0b5
--- /dev/null
+++ b/imports/ui/components/partyCreator/client/partyCreator.tests.js
@@ -0,0 +1,81 @@
+import { name as PartyCreator } from '../partyCreator';
+import { Meteor } from 'meteor/meteor';
+import 'angular-mocks';
+
+describe('PartyCreator', () => {
+  beforeEach(() => {
+    window.module(PartyCreator);
+  });
+
+  describe('controller', () => {
+    let $rootScope;
+    let $componentController;
+    const party = {
+      _id: 'partyId'
+    };
+
+    beforeEach(() => {
+      inject((_$rootScope_, _$componentController_) => {
+        $rootScope = _$rootScope_;
+        $componentController = _$componentController_;
+      });
+    });
+
+    function component(bindings) {
+      return $componentController(PartyCreator, {
+        $scope: $rootScope.$new(true)
+      }, bindings);
+    }
+
+    it('should return an empty string if there is no party', () => {
+      const controller = component({
+        party: undefined
+      });
+
+      expect(controller.creator).toEqual('');
+    });
+
+    it('should say `me` if logged in is the owner', () => {
+      const owner = 'userId';
+      // logged in
+      spyOn(Meteor, 'userId').and.returnValue(owner);
+      const controller = component({
+        party: {
+          owner
+        }
+      });
+
+      expect(controller.creator).toEqual('me');
+    });
+
+    it('should say `nobody` if user does not exist', () => {
+      const owner = 'userId';
+      // not logged in
+      spyOn(Meteor, 'userId').and.returnValue(null);
+      // no user found
+      spyOn(Meteor.users, 'findOne').and.returnValue(undefined);
+      const controller = component({
+        party: {
+          owner
+        }
+      });
+
+      expect(controller.creator).toEqual('nobody');
+    });
+
+    it('should return user data if user exists and it is not logged one', () => {
+      const owner = 'userId';
+      // not logged in
+      spyOn(Meteor, 'userId').and.returnValue(null);
+      // user found
+      spyOn(Meteor.users, 'findOne').and.returnValue('found');
+      const controller = component({
+        party: {
+          owner
+        }
+      });
+
+      expect(controller.creator).toEqual('found');
+    });
+  });
+});
-- 
2.7.4


From 32297c9ff2f85440edf5f98454025fbdaa78af97 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:18:32 +0200
Subject: [PATCH 152/376] Step 14.1: Add `check` package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index f33cc77..054963d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,3 +25,4 @@ dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
 tmeasday:publish-counts
+check
-- 
2.7.4


From c46dcad61910eed15d44f1289c32ea1be7fc6eb2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:21:04 +0200
Subject: [PATCH 153/376] Step 14.2: Create invite method

---
 imports/api/parties/methods.js | 66 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 66 insertions(+)
 create mode 100644 imports/api/parties/methods.js

diff --git a/imports/api/parties/methods.js b/imports/api/parties/methods.js
new file mode 100644
index 0000000..dd75692
--- /dev/null
+++ b/imports/api/parties/methods.js
@@ -0,0 +1,66 @@
+import _ from 'underscore';
+import { Meteor } from 'meteor/meteor';
+import { check } from 'meteor/check';
+
+import { Parties } from './collection';
+
+function getContactEmail(user) {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+
+  if (user.services && user.services.facebook && user.services.facebook.email)
+    return user.services.facebook.email;
+
+  return null;
+}
+
+export function invite(partyId, userId) {
+  check(partyId, String);
+  check(userId, String);
+
+  if (!this.userId) {
+    throw new Meteor.Error(400, 'You have to be logged in!');
+  }
+
+  const party = Parties.findOne(partyId);
+
+  if (!party) {
+    throw new Meteor.Error(404, 'No such party!');
+  }
+
+  if (party.owner !== this.userId) {
+    throw new Meteor.Error(404, 'No permissions!');
+  }
+
+  if (party.public) {
+    throw new Meteor.Error(400, 'That party is public. No need to invite people.');
+  }
+
+  if (userId !== party.owner && ! _.contains(party.invited, userId)) {
+    Parties.update(partyId, {
+      $addToSet: {
+        invited: userId
+      }
+    });
+
+    const replyTo = getContactEmail(Meteor.users.findOne(this.userId));
+    const to = getContactEmail(Meteor.users.findOne(userId));
+
+    if (Meteor.isServer && to) {
+      Email.send({
+        to,
+        replyTo,
+        from: 'noreply@socially.com',
+        subject: `PARTY: ${party.title}`,
+        text: `
+          Hey, I just invited you to ${party.title} on Socially.
+          Come check it out: ${Meteor.absoluteUrl()}
+        `
+      });
+    }
+  }
+}
+
+Meteor.methods({
+  invite
+});
-- 
2.7.4


From 8ebf02edb1416b7a61b1a3ac7884cc62d0828169 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:21:28 +0200
Subject: [PATCH 154/376] Step 14.3: Import methods

---
 imports/api/parties/index.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/api/parties/index.js b/imports/api/parties/index.js
index 5f7ae00..96b72b2 100644
--- a/imports/api/parties/index.js
+++ b/imports/api/parties/index.js
@@ -1,3 +1,4 @@
 import './publish';
+import './methods';
 
 export * from './collection';
-- 
2.7.4


From 07564d613f95edd4de21aa161217680c920ce136 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:23:05 +0200
Subject: [PATCH 155/376] Step 14.4: Add `email` package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 054963d..27dfd39 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,3 +26,4 @@ accounts-facebook
 accounts-twitter
 tmeasday:publish-counts
 check
+email
-- 
2.7.4


From 5956bd83ee49da97c682d1fbf19623d70892ba6f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:23:49 +0200
Subject: [PATCH 156/376] Step 14.5: Import email from module

---
 imports/api/parties/methods.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/api/parties/methods.js b/imports/api/parties/methods.js
index dd75692..054b42a 100644
--- a/imports/api/parties/methods.js
+++ b/imports/api/parties/methods.js
@@ -1,6 +1,7 @@
 import _ from 'underscore';
 import { Meteor } from 'meteor/meteor';
 import { check } from 'meteor/check';
+import { Email } from 'meteor/email';
 
 import { Parties } from './collection';
 
-- 
2.7.4


From c30c396cf6a61ef0c1763dfc562ea2fbb47972db Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:25:59 +0200
Subject: [PATCH 157/376] Step 14.6: Add invite method to PartyUninvited

---
 imports/ui/components/partyUninvited/partyUninvited.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
index ca195d5..7958f5a 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.js
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -19,6 +19,18 @@ class PartyUninvited {
       }
     });
   }
+
+  invite(user) {
+    Meteor.call('invite', this.party._id, user._id,
+      (error) => {
+        if (error) {
+          console.log('Oops, unable to invite!');
+        } else {
+          console.log('Invited!');
+        }
+      }
+    );
+  }
 }
 
 const name = 'partyUninvited';
-- 
2.7.4


From fb4336ccc73cc00de0b3738bbc8de5d6ce4717e8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:26:36 +0200
Subject: [PATCH 158/376] Step 14.7: Add invite button

---
 imports/ui/components/partyUninvited/partyUninvited.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index 9603f3a..0cbb435 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -2,5 +2,6 @@
   Users to invite:
   <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
     <div>{{ user | displayNameFilter }}</div>
+    <button ng-click="partyUninvited.invite(user)">Invite</button>
   </li>
 </ul>
-- 
2.7.4


From 8b319d7ac1a1f409050b0098f066b51d4a689e29 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:28:47 +0200
Subject: [PATCH 159/376] Step 14.8: Update the parties subscription to include
 invited

---
 imports/api/parties/publish.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 67c9bdb..0d4d340 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -24,6 +24,15 @@ if (Meteor.isServer) {
             $exists: true
           }
         }]
+      }, {
+        // when logged in user is one of invited
+        $and: [{
+          invited: this.userId
+        }, {
+          invited: {
+            $exists: true
+          }
+        }]
       }]
     };
 
-- 
2.7.4


From 9a9a9b83f8e939c9fdca017ffb9099d06bd6bd50 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:42:35 +0200
Subject: [PATCH 160/376] Step 14.9: Add rsvp method

---
 imports/api/parties/methods.js | 79 +++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 78 insertions(+), 1 deletion(-)

diff --git a/imports/api/parties/methods.js b/imports/api/parties/methods.js
index 054b42a..e8aa1ad 100644
--- a/imports/api/parties/methods.js
+++ b/imports/api/parties/methods.js
@@ -62,6 +62,83 @@ export function invite(partyId, userId) {
   }
 }
 
+export function rsvp(partyId, rsvp) {
+  check(partyId, String);
+  check(rsvp, String);
+
+  if (!this.userId) {
+    throw new Meteor.Error(403, 'You must be logged in to RSVP');
+  }
+
+  if (!_.contains(['yes', 'no', 'maybe'], rsvp)) {
+    throw new Meteor.Error(400, 'Invalid RSVP');
+  }
+
+  const party = Parties.findOne({
+    _id: partyId,
+    $or: [{
+      // is public
+      $and: [{
+        public: true
+      }, {
+        public: {
+          $exists: true
+        }
+      }]
+    },{
+      // is owner
+      $and: [{
+        owner: this.userId
+      }, {
+        owner: {
+          $exists: true
+        }
+      }]
+    }, {
+      // is invited
+      $and: [{
+        invited: this.userId
+      }, {
+        invited: {
+          $exists: true
+        }
+      }]
+    }]
+  });
+
+  if (!party) {
+    throw new Meteor.Error(404, 'No such party');
+  }
+
+  const hasUserRsvp = _.findWhere(party.rsvps, {
+    user: this.userId
+  });
+
+  if (!hasUserRsvp) {
+    // add new rsvp entry
+    Parties.update(partyId, {
+      $push: {
+        rsvps: {
+          rsvp,
+          user: this.userId
+        }
+      }
+    });
+  } else {
+    // update rsvp entry
+    const userId = this.userId;
+    Parties.update({
+      _id: partyId,
+      'rsvps.user': userId
+    }, {
+      $set: {
+        'rsvps.$.rsvp': rsvp
+      }
+    });
+  }
+}
+
 Meteor.methods({
-  invite
+  invite,
+  rsvp
 });
-- 
2.7.4


From be17785171c49d1c54ff9056bce7f46d35e0e3cb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:45:36 +0200
Subject: [PATCH 161/376] Step 14.10: Create PartyRsvp component

---
 imports/ui/components/partyRsvp/partyRsvp.js | 44 ++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)
 create mode 100644 imports/ui/components/partyRsvp/partyRsvp.js

diff --git a/imports/ui/components/partyRsvp/partyRsvp.js b/imports/ui/components/partyRsvp/partyRsvp.js
new file mode 100644
index 0000000..17aeb99
--- /dev/null
+++ b/imports/ui/components/partyRsvp/partyRsvp.js
@@ -0,0 +1,44 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './partyRsvp.html';
+
+class PartyRsvp {
+  yes() {
+    this.answer('yes');
+  }
+
+  maybe() {
+    this.answer('maybe');
+  }
+
+  no() {
+    this.answer('no');
+  }
+
+  answer(answer) {
+    Meteor.call('rsvp', this.party._id, answer, (error) => {
+      if (error) {
+        console.error('Oops, unable to rsvp!');
+      } else {
+        console.log('RSVP done!')
+      }
+    });
+  }
+}
+
+const name = 'partyRsvp';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyRsvp
+});
-- 
2.7.4


From cc078c80254e17967d89a546d86ae943953eb88b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:46:38 +0200
Subject: [PATCH 162/376] Step 14.11: Create template

---
 imports/ui/components/partyRsvp/partyRsvp.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/partyRsvp/partyRsvp.html

diff --git a/imports/ui/components/partyRsvp/partyRsvp.html b/imports/ui/components/partyRsvp/partyRsvp.html
new file mode 100644
index 0000000..ca15260
--- /dev/null
+++ b/imports/ui/components/partyRsvp/partyRsvp.html
@@ -0,0 +1,3 @@
+<input type="button" value="I'm going!" ng-click="partyRsvp.yes()"/>
+<input type="button" value="Maybe" ng-click="partyRsvp.maybe()"/>
+<input type="button" value="No" ng-click="partyRsvp.no()"/>
-- 
2.7.4


From 6c1be904085ed32f1ebdce9c3e56566dc2e72a4c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:48:22 +0200
Subject: [PATCH 163/376] Step 14.12: Add component to the view

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 2b18723..bced521 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -11,6 +11,7 @@
     </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
+    <party-rsvp party="party"></party-rsvp>
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.7.4


From ae2499052a24e9749d93100a5708d22ba953d482 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:48:36 +0200
Subject: [PATCH 164/376] Step 14.13: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 919bf88..14efe13 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -11,6 +11,7 @@ import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
+import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -63,7 +64,8 @@ export default angular.module(name, [
   PartiesSort,
   PartyAdd,
   PartyRemove,
-  PartyCreator
+  PartyCreator,
+  PartyRsvp
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From f0f142ff979047bbf7ba84119809898c7c7defb3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:02 +0200
Subject: [PATCH 165/376] Step 14.14: Create view for PartyRsvpsList component

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpsList/partyRsvpsList.html

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.html b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
new file mode 100644
index 0000000..efc38ed
--- /dev/null
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
@@ -0,0 +1,6 @@
+Who is coming: Yes -
+{{ (partyRsvpsList.rsvps | filter:{rsvp:'yes'}).length }}
+Maybe -
+{{ (partyRsvpsList.rsvps | filter:{rsvp:'maybe'}).length }}
+No -
+{{ (partyRsvpsList.rsvps | filter:{rsvp:'no'}).length }}
-- 
2.7.4


From 0321ca3bf524de23a8d82c87558db219ed6079bb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:16 +0200
Subject: [PATCH 166/376] Step 14.15: Create component

---
 .../ui/components/partyRsvpsList/partyRsvpsList.js   | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpsList/partyRsvpsList.js

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.js b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
new file mode 100644
index 0000000..755c9f9
--- /dev/null
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
@@ -0,0 +1,20 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './partyRsvpsList.html';
+
+class PartyRsvpsList { }
+
+const name = 'partyRsvpsList';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    rsvps: '<'
+  },
+  controller: PartyRsvpsList
+});
-- 
2.7.4


From 1cb604c9dd8343976bb04992c38aadfc48a90003 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:32 +0200
Subject: [PATCH 167/376] Step 14.16: Add to the view

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index bced521..60dbea3 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -12,6 +12,7 @@
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
     <party-rsvp party="party"></party-rsvp>
+    <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.7.4


From 516d1e859f358f03d9912cba927410db3237af9e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:47 +0200
Subject: [PATCH 168/376] Step 14.17: Also as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 14efe13..42342ca 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -12,6 +12,7 @@ import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
+import { name as PartyRsvpsList } from '../partyRsvpsList/partyRsvpsList';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -65,7 +66,8 @@ export default angular.module(name, [
   PartyAdd,
   PartyRemove,
   PartyCreator,
-  PartyRsvp
+  PartyRsvp,
+  PartyRsvpsList
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 0199246a5433bd430e099774aa0980e511549072 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:57:13 +0200
Subject: [PATCH 169/376] Step 14.18: Create view for PartyRsvpUsers component

---
 imports/ui/components/partyRsvpUsers/partyRsvpUsers.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpUsers/partyRsvpUsers.html

diff --git a/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html
new file mode 100644
index 0000000..445d426
--- /dev/null
+++ b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html
@@ -0,0 +1,5 @@
+<div ng-repeat="rsvp in partyRsvpUsers.rsvps | filter:{ rsvp: partyRsvpUsers.type }">
+  {{ partyRsvpUsers.getUserById(rsvp.user) | displayNameFilter }}
+  -
+  {{ partyRsvpUsers.type }}
+</div>
-- 
2.7.4


From 7fbb84d3849a3311ff7d38bf34e1597fcff49897 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:57:30 +0200
Subject: [PATCH 170/376] Step 14.19: Create component

---
 .../ui/components/partyRsvpUsers/partyRsvpUsers.js | 29 ++++++++++++++++++++++
 1 file changed, 29 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpUsers/partyRsvpUsers.js

diff --git a/imports/ui/components/partyRsvpUsers/partyRsvpUsers.js b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.js
new file mode 100644
index 0000000..1b4f1fa
--- /dev/null
+++ b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.js
@@ -0,0 +1,29 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './partyRsvpUsers.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+class PartyRsvpUsers {
+  getUserById(userId) {
+    return Meteor.users.findOne(userId);
+  }
+}
+
+const name = 'partyRsvpUsers';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    rsvps: '<',
+    type: '@'
+  },
+  controller: PartyRsvpUsers
+});
-- 
2.7.4


From 884998880508088c998d81f2095c52176d82c98e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:57:56 +0200
Subject: [PATCH 171/376] Step 14.20: Use recently created component

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.html b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
index efc38ed..2e1749d 100644
--- a/imports/ui/components/partyRsvpsList/partyRsvpsList.html
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
@@ -4,3 +4,7 @@ Maybe -
 {{ (partyRsvpsList.rsvps | filter:{rsvp:'maybe'}).length }}
 No -
 {{ (partyRsvpsList.rsvps | filter:{rsvp:'no'}).length }}
+
+<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="yes"></party-rsvp-users>
+<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="maybe"></party-rsvp-users>
+<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="no"></party-rsvp-users>
-- 
2.7.4


From 19452b8d8743f6d1dabee2a73f9cb07b942ae481 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:58:15 +0200
Subject: [PATCH 172/376] Step 14.21: Add as a dependency

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.js b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
index 755c9f9..c1ebd92 100644
--- a/imports/ui/components/partyRsvpsList/partyRsvpsList.js
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import template from './partyRsvpsList.html';
+import { name as PartyRsvpUsers } from '../partyRsvpUsers/partyRsvpUsers';
 
 class PartyRsvpsList { }
 
@@ -9,7 +10,8 @@ const name = 'partyRsvpsList';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  PartyRsvpUsers
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From bdf3d987690788131a8ae04e9891a0acc451bab4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:59:25 +0200
Subject: [PATCH 173/376] Step 14.22: Create view for PartyUnanswered

---
 imports/ui/components/partyUnanswered/partyUnanswered.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyUnanswered/partyUnanswered.html

diff --git a/imports/ui/components/partyUnanswered/partyUnanswered.html b/imports/ui/components/partyUnanswered/partyUnanswered.html
new file mode 100644
index 0000000..ecc1b45
--- /dev/null
+++ b/imports/ui/components/partyUnanswered/partyUnanswered.html
@@ -0,0 +1,5 @@
+<ul>
+  <li ng-repeat="invitedUser in partyUnanswered.getUnanswered()">
+    {{ partyUnanswered.getUserById(invitedUser) | displayNameFilter }}
+  </li>
+</ul>
-- 
2.7.4


From a09bd8f605b449bafcefa4c9cc5f52ce0e059181 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:02:22 +0200
Subject: [PATCH 174/376] Step 14.23: Create component

---
 .../components/partyUnanswered/partyUnanswered.js  | 39 ++++++++++++++++++++++
 1 file changed, 39 insertions(+)
 create mode 100644 imports/ui/components/partyUnanswered/partyUnanswered.js

diff --git a/imports/ui/components/partyUnanswered/partyUnanswered.js b/imports/ui/components/partyUnanswered/partyUnanswered.js
new file mode 100644
index 0000000..39f2115
--- /dev/null
+++ b/imports/ui/components/partyUnanswered/partyUnanswered.js
@@ -0,0 +1,39 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import _ from 'underscore';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './partyUnanswered.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+class PartyUnanswered {
+  getUnanswered() {
+    if (!this.party || !this.party.invited) {
+      return;
+    }
+
+    return this.party.invited.filter((user) => {
+      return !_.findWhere(this.party.rsvps, { user });
+    });
+  }
+
+  getUserById(userId) {
+    return Meteor.users.findOne(userId)
+  }
+}
+
+const name = 'partyUnanswered';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyUnanswered
+});
-- 
2.7.4


From 518f4251a678988ac746843fbe3d2b249fdef38f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:02:52 +0200
Subject: [PATCH 175/376] Step 14.24: Use recently created component

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 60dbea3..4881e5c 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -13,6 +13,7 @@
     <party-remove party="party"></party-remove>
     <party-rsvp party="party"></party-rsvp>
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
+    <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.7.4


From ff32473a0bbccdae229035bb8a539f729e648262 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:03:12 +0200
Subject: [PATCH 176/376] Step 14.25: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 42342ca..a20e777 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -13,6 +13,7 @@ import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
 import { name as PartyRsvpsList } from '../partyRsvpsList/partyRsvpsList';
+import { name as PartyUnanswered } from '../partyUnanswered/partyUnanswered';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -67,7 +68,8 @@ export default angular.module(name, [
   PartyRemove,
   PartyCreator,
   PartyRsvp,
-  PartyRsvpsList
+  PartyRsvpsList,
+  PartyUnanswered
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From b7c5b6cc4ca3420b8d62d05cd059643b7dde2be8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:03:38 +0200
Subject: [PATCH 177/376] Step 14.26: Subscribe `users`

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index a20e777..e745b39 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -35,6 +35,8 @@ class PartiesList {
       }, this.getReactively('searchText')
     ]);
 
+    this.subscribe('users');
+
     this.helpers({
       parties() {
         return Parties.find({}, {
-- 
2.7.4


From ae4544a4ff6cc8f2f02eecfa65423f80e4ec56c2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 19:50:23 +0200
Subject: [PATCH 178/376] Step 14.27: Tests of invite method

---
 imports/api/parties/methods.tests.js | 126 +++++++++++++++++++++++++++++++++++
 1 file changed, 126 insertions(+)
 create mode 100644 imports/api/parties/methods.tests.js

diff --git a/imports/api/parties/methods.tests.js b/imports/api/parties/methods.tests.js
new file mode 100644
index 0000000..56e770c
--- /dev/null
+++ b/imports/api/parties/methods.tests.js
@@ -0,0 +1,126 @@
+import { invite } from './methods';
+import { Parties } from './collection';
+
+import { Meteor } from 'meteor/meteor';
+
+if (Meteor.isServer) {
+  describe('Parties / Methods', () => {
+    describe('invite', () => {
+      function loggedIn(userId = 'userId') {
+        return {
+          userId
+        };
+      }
+
+      it('should be called from Method', () => {
+        spyOn(invite, 'apply');
+
+        try {
+          Meteor.call('invite');
+        } catch (e) {}
+
+        expect(invite.apply).toHaveBeenCalled();
+      });
+
+      it('should fail on missing partyId', () => {
+        expect(() => {
+          invite.call({});
+        }).toThrowError();
+      });
+
+      it('should fail on missing userId', () => {
+        expect(() => {
+          invite.call({}, 'partyId');
+        }).toThrowError();
+      });
+
+      it('should fail on not logged in', () => {
+        expect(() => {
+          invite.call({}, 'partyId', 'userId');
+        }).toThrowError(/logged in/i);
+      });
+
+      it('should look for a party', () => {
+        const partyId = 'partyId';
+        spyOn(Parties, 'findOne');
+
+        try {
+          invite.call(loggedIn(), partyId, 'userId');
+        } catch (e) {}
+
+        expect(Parties.findOne).toHaveBeenCalledWith(partyId);
+      });
+
+      it('should fail if party does not exist', () => {
+        spyOn(Parties, 'findOne').and.returnValue(undefined);
+
+        expect(() => {
+          invite.call(loggedIn(), 'partyId', 'userId');
+        }).toThrowError(/404/);
+      });
+
+      it('should fail if logged in user is not the owner', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'notUserId'
+        });
+
+        expect(() => {
+          invite.call(loggedIn(), 'partyId', 'userId');
+        }).toThrowError(/404/);
+      });
+
+      it('should fail on public party', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId',
+          public: true
+        });
+
+        expect(() => {
+          invite.call(loggedIn(), 'partyId', 'userId');
+        }).toThrowError(/400/);
+      });
+
+      it('should NOT invite user who is the owner', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId'
+        });
+        spyOn(Parties, 'update');
+
+        invite.call(loggedIn(), 'partyId', 'userId');
+
+        expect(Parties.update).not.toHaveBeenCalled();
+      });
+
+      it('should NOT invite user who has been already invited', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId',
+          invited: ['invitedId']
+        });
+        spyOn(Parties, 'update');
+
+        invite.call(loggedIn(), 'partyId', 'invitedId');
+
+        expect(Parties.update).not.toHaveBeenCalled();
+      });
+
+      it('should invite user who has not been invited and is not the owner', () => {
+        const partyId = 'partyId';
+        const userId = 'notInvitedId';
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId',
+          invited: ['invitedId']
+        });
+        spyOn(Parties, 'update');
+        spyOn(Meteor.users, 'findOne').and.returnValue({});
+
+        invite.call(loggedIn(), partyId, userId);
+
+        expect(Parties.update).toHaveBeenCalledWith(partyId, {
+          $addToSet: {
+            invited: userId
+          }
+        });
+      });
+    });
+  });
+}
-- 
2.7.4


From 2c81e8a6ef4f34f01dc10d77afc2626386503de0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:00:03 +0200
Subject: [PATCH 179/376] Step 14.28: Tests of rsvp Method

---
 imports/api/parties/methods.tests.js | 54 +++++++++++++++++++++++++++++++++++-
 1 file changed, 53 insertions(+), 1 deletion(-)

diff --git a/imports/api/parties/methods.tests.js b/imports/api/parties/methods.tests.js
index 56e770c..536a2b0 100644
--- a/imports/api/parties/methods.tests.js
+++ b/imports/api/parties/methods.tests.js
@@ -1,4 +1,4 @@
-import { invite } from './methods';
+import { invite, rsvp } from './methods';
 import { Parties } from './collection';
 
 import { Meteor } from 'meteor/meteor';
@@ -122,5 +122,57 @@ if (Meteor.isServer) {
         });
       });
     });
+
+    describe('rsvp', () => {
+      function loggedIn(userId = 'userId') {
+        return {
+          userId
+        };
+      }
+
+      it('should be called from Method', () => {
+        spyOn(rsvp, 'apply');
+
+        try {
+          Meteor.call('rsvp');
+        } catch (e) {}
+
+        expect(rsvp.apply).toHaveBeenCalled();
+      });
+
+      it('should fail on missing partyId', () => {
+        expect(() => {
+          rsvp.call({});
+        }).toThrowError();
+      });
+
+      it('should fail on missing rsvp', () => {
+        expect(() => {
+          rsvp.call({}, 'partyId');
+        }).toThrowError();
+      });
+
+      it('should fail if not logged in', () => {
+        expect(() => {
+          rsvp.call({}, 'partyId', 'rsvp');
+        }).toThrowError(/403/);
+      });
+
+      it('should fail on wrong answer', () => {
+        expect(() => {
+          rsvp.call(loggedIn(), 'partyId', 'wrong');
+        }).toThrowError(/400/);
+      });
+
+      ['yes', 'maybe', 'no'].forEach((answer) => {
+        it(`should pass on '${answer}'`, () => {
+          expect(() => {
+            rsvp.call(loggedIn(), 'partyId', answer);
+          }).not.toThrowError(/400/);
+        });
+      });
+
+      // TODO: more tests  
+    });
   });
 }
-- 
2.7.4


From 063925b265bf7f7ba610f24e8efdf620c9dcc1c8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:07:36 +0200
Subject: [PATCH 180/376] Step 15.1: Add ngShow to PartyAdd

---
 imports/ui/components/partiesList/partiesList.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 4881e5c..d6d4c83 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,4 +1,4 @@
-<party-add></party-add>
+<party-add ng-show="partiesList.isLoggedIn"></party-add>
 
 <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
 
-- 
2.7.4


From ff82877ba573f709a47aee3443a4718bf8d30aa7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:09:16 +0200
Subject: [PATCH 181/376] Step 15.2: Add isLoggedIn helper

---
 imports/ui/components/partiesList/partiesList.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index e745b39..fcf7bbf 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -45,6 +45,9 @@ class PartiesList {
       },
       partiesCount() {
         return Counts.get('numberOfParties');
+      },
+      isLoggedIn() {
+        return !!Meteor.userId();
       }
     });
   }
-- 
2.7.4


From 73775d65ac0b2a3dbe6cbc29cb8979496d78490c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:09:45 +0200
Subject: [PATCH 182/376] Step 15.3: Add usage for ng-hide

---
 imports/ui/components/partiesList/partiesList.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index d6d4c83..c3006d3 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,4 +1,7 @@
 <party-add ng-show="partiesList.isLoggedIn"></party-add>
+<div ng-hide="partiesList.isLoggedIn">
+  Log in to create a party!
+</div>
 
 <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
 
-- 
2.7.4


From ec15e1c1f1cc6679f82bdda04c77ac77aba242ec Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:10:23 +0200
Subject: [PATCH 183/376] Step 15.4: Add ngShow to PartyRsvp

---
 imports/ui/components/partiesList/partiesList.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index c3006d3..07d331f 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -14,7 +14,7 @@
     </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
-    <party-rsvp party="party"></party-rsvp>
+    <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
-- 
2.7.4


From 44ca51b948bd06afba3bb97577f71d8e7b75fd93 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:10:48 +0200
Subject: [PATCH 184/376] Step 15.5: Add message for not-logged in users on the
 RSVP buttons

---
 imports/ui/components/partiesList/partiesList.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 07d331f..3b4a085 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -15,6 +15,10 @@
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
     <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
+    <div ng-hide="partiesList.isLoggedIn">
+      <i>Sign in to RSVP for this party.</i>
+    </div>
+    
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
-- 
2.7.4


From 82a17ce8ba665586032dd78b05bfd17cb0a8f7c2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:12:56 +0200
Subject: [PATCH 185/376] Step 15.6: Add isOwner method

---
 imports/ui/components/partiesList/partiesList.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index fcf7bbf..58dd939 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -48,10 +48,17 @@ class PartiesList {
       },
       isLoggedIn() {
         return !!Meteor.userId();
+      },
+      currentUserId() {
+        return Meteor.userId();
       }
     });
   }
 
+  isOwner(party) {
+    return this.isLoggedIn && party.owner === this.currentUserId;
+  }
+
   pageChanged(newPage) {
     this.page = newPage;
   }
-- 
2.7.4


From 7a0c3d9780d58115a1ba9ad7324180889f563574 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:13:51 +0200
Subject: [PATCH 186/376] Step 15.7: Add ngShow to PartyRemove

---
 imports/ui/components/partiesList/partiesList.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 3b4a085..fbc61a9 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -13,12 +13,12 @@
       {{party.name}}
     </a>
     <p>{{party.description}}</p>
-    <party-remove party="party"></party-remove>
+    <party-remove party="party" ng-show="partiesList.isOwner(party)"></party-remove>
     <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
     <div ng-hide="partiesList.isLoggedIn">
       <i>Sign in to RSVP for this party.</i>
     </div>
-    
+
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
-- 
2.7.4


From 509389f08ad4627bb1c27e68869346cdb3ed7c21 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:15:08 +0200
Subject: [PATCH 187/376] Step 15.8: Add ngIf to PartyUnanswered

---
 imports/ui/components/partiesList/partiesList.html | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index fbc61a9..c4cc2c1 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -20,7 +20,12 @@
     </div>
 
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
-    <party-unanswered party="party"></party-unanswered>
+
+    <party-unanswered party="party" ng-if="!party.public"></party-unanswered>
+    <div ng-if="party.public">
+      Everyone is invited
+    </div>
+
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.7.4


From 1a4445b4868e5f6affae49af0a4eb5ea8ac88eac Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:16:17 +0200
Subject: [PATCH 188/376] Step 15.9: Add canInvite method to the component

---
 imports/ui/components/partyDetails/partyDetails.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 5443915..aa4faf4 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -31,6 +31,14 @@ class PartyDetails {
     });
   }
 
+  canInvite() {
+    if (!this.party) {
+      return false;
+    }
+
+    return !this.party.public && this.party.owner === Meteor.userId();
+  }
+
   save() {
     Parties.update({
       _id: this.party._id
-- 
2.7.4


From 2589affcb628d6c6881a0dbb6b9e74a61808c243 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:18:07 +0200
Subject: [PATCH 189/376] Step 15.10: Add ngShow to PartyUninvited

---
 imports/ui/components/partyDetails/partyDetails.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 916f23e..ab7abd9 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -8,4 +8,4 @@ The party your selected is:
 
 <button ui-sref="parties">Back</button>
 
-<party-uninvited party="partyDetails.party"></party-uninvited>
+<party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
-- 
2.7.4


From fce268bfa80ded5eb1bcbb53062698a41bd8126c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:18:54 +0200
Subject: [PATCH 190/376] Step 15.11: Add info that everyone are already
 invited

---
 imports/ui/components/partyUninvited/partyUninvited.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index 0cbb435..86d2519 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -4,4 +4,7 @@
     <div>{{ user | displayNameFilter }}</div>
     <button ng-click="partyUninvited.invite(user)">Invite</button>
   </li>
+  <li ng-if="(partyUninvited.users | uninvitedFilter:partyUninvited.party).length <= 0">
+    Everyone are already invited.
+  </li>
 </ul>
-- 
2.7.4


From 217b7e3b65b028c6af33e33e52b0ac868b2da03a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:19:54 +0200
Subject: [PATCH 191/376] Step 15.12: Add isLoggedIn helper to the party
 details component

---
 imports/ui/components/partyDetails/partyDetails.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index aa4faf4..351d9a8 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -27,6 +27,9 @@ class PartyDetails {
       },
       users() {
         return Meteor.users.find({});
+      },
+      isLoggedIn() {
+        return !!Meteor.userId();
       }
     });
   }
-- 
2.7.4


From 9ae685893372324480b4f3c6c2d0e1fa94551d6d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:20:39 +0200
Subject: [PATCH 192/376] Step 15.13: Add usage for ng-disabled

---
 imports/ui/components/partyDetails/partyDetails.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index ab7abd9..e53812d 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -1,8 +1,8 @@
 The party your selected is:
 <form>
-  Party name: <input type="text" ng-model="partyDetails.party.name" />
-  Description: <input type="text" ng-model="partyDetails.party.description" />
-  Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
+  Party name: <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn"/>
+  Description: <input type="text" ng-model="partyDetails.party.description" ng-disabled="!partyDetails.isLoggedIn"/>
+  Public Party? <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="!partyDetails.isLoggedIn"/>
   <button ng-click="partyDetails.save()">Save</button>
 </form>
 
-- 
2.7.4


From 30e71d5ae4890241fd7c17b786108af00484d3b1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:22:55 +0200
Subject: [PATCH 193/376] Step 16.1: Install `angular-google-maps`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 9e6806d..46fd0f7 100644
--- a/package.json
+++ b/package.json
@@ -7,6 +7,7 @@
   },
   "dependencies": {
     "angular": "^1.5.3",
+    "angular-google-maps": "^2.3.2",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
     "angular-utils-pagination": "^0.11.1",
-- 
2.7.4


From aece03da3670458e89cc94dcc41e77da1359cce7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:23:36 +0200
Subject: [PATCH 194/376] Step 16.2: Install `angular-simple-logger`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 46fd0f7..af5599d 100644
--- a/package.json
+++ b/package.json
@@ -10,6 +10,7 @@
     "angular-google-maps": "^2.3.2",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
+    "angular-simple-logger": "^0.1.7",
     "angular-utils-pagination": "^0.11.1",
     "meteor-node-stubs": "~0.2.0",
     "underscore": "^1.8.3"
-- 
2.7.4


From 2a42a2d80f3b819b18ee2a87127522a184a0e3e0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:24:57 +0200
Subject: [PATCH 195/376] Step 16.3: Create template for PartyMap

---
 imports/ui/components/partyMap/partyMap.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.html

diff --git a/imports/ui/components/partyMap/partyMap.html b/imports/ui/components/partyMap/partyMap.html
new file mode 100644
index 0000000..e590420
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.html
@@ -0,0 +1,5 @@
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="partyMap.location || partyMap.map.center" events="partyMap.map.events" zoom="partyMap.map.zoom">
+    <ui-gmap-marker coords="partyMap.location" options="partyMap.marker.options" events="partyMapmarker.events" idKey="party-location"></ui-gmap-marker>
+  </ui-gmap-google-map>
+</div>
-- 
2.7.4


From 9d788bbee355dba4a546d2f69ea398fecbfafd12 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:25:56 +0200
Subject: [PATCH 196/376] Step 16.4: Create component

---
 imports/ui/components/partyMap/partyMap.js | 44 ++++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.js

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
new file mode 100644
index 0000000..824df5c
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -0,0 +1,44 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import 'angular-simple-logger';
+import 'angular-google-maps';
+
+import template from './partyMap.html';
+
+class PartyMap {
+  constructor($scope) {
+    'ngInject';
+
+    this.map = {
+      center: {
+        latitude: 45,
+        longitude: -73
+      },
+      zoom: 8,
+      events: {}
+    };
+
+    this.marker = {
+      options: {
+        draggable: true
+      },
+      events: {}
+    };
+  }
+}
+
+const name = 'partyMap';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  'nemLogging', // https://github.com/angular-ui/angular-google-maps/issues/1633
+  'uiGmapgoogle-maps'
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    location: '='
+  },
+  controller: PartyMap
+});
-- 
2.7.4


From 8da6f8c22ed303cf7c566f72b96f848383027b43 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:27:32 +0200
Subject: [PATCH 197/376] Step 16.5: Add some class

---
 imports/ui/components/partyMap/partyMap.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.css

diff --git a/imports/ui/components/partyMap/partyMap.css b/imports/ui/components/partyMap/partyMap.css
new file mode 100644
index 0000000..f4b49f5
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+  height: 400px;
+  width: 400px;
+}
-- 
2.7.4


From f4ac7dd0fd289af51aab9aeeb9c33598cc541f1a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:28:08 +0200
Subject: [PATCH 198/376] Step 16.6: Import styles

---
 imports/ui/components/partyMap/partyMap.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
index 824df5c..d240c5b 100644
--- a/imports/ui/components/partyMap/partyMap.js
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -3,6 +3,7 @@ import angularMeteor from 'angular-meteor';
 import 'angular-simple-logger';
 import 'angular-google-maps';
 
+import './partyMap.css';
 import template from './partyMap.html';
 
 class PartyMap {
-- 
2.7.4


From 50c3b23335f087f82eb6017dc03e68b1de485bba Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:29:34 +0200
Subject: [PATCH 199/376] Step 16.7: Add as a dependency to PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 351d9a8..a81a8fa 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -7,6 +7,7 @@ import { Meteor } from 'meteor/meteor';
 import template from './partyDetails.html';
 import { Parties } from '../../../api/parties';
 import { name as PartyUninvited } from '../partyUninvited/partyUninvited';
+import { name as PartyMap } from '../partyMap/partyMap';
 
 class PartyDetails {
   constructor($stateParams, $scope, $reactive) {
@@ -67,7 +68,8 @@ const name = 'partyDetails';
 export default angular.module(name, [
   angularMeteor,
   uiRouter,
-  PartyUninvited
+  PartyUninvited,
+  PartyMap
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 79406a5c0b707c44628a59b7ff7afad03f709b8b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:42:54 +0200
Subject: [PATCH 200/376] Step 16.8: Use in the view

---
 imports/ui/components/partyDetails/partyDetails.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index e53812d..7354dd6 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -9,3 +9,5 @@ The party your selected is:
 <button ui-sref="parties">Back</button>
 
 <party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
+
+<party-map location="partyDetails.party.location"></party-map>
-- 
2.7.4


From 14322d7e692cc59b21537613c85e587b71e772c3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:44:36 +0200
Subject: [PATCH 201/376] Step 16.9: Add actions

---
 imports/ui/components/partyMap/partyMap.js | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
index d240c5b..9db5069 100644
--- a/imports/ui/components/partyMap/partyMap.js
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -16,14 +16,31 @@ class PartyMap {
         longitude: -73
       },
       zoom: 8,
-      events: {}
+      events: {
+        click: (mapModel, eventName, originalEventArgs) => {
+          this.setLocation(originalEventArgs[0].latLng.lat(), originalEventArgs[0].latLng.lng());
+          $scope.$apply();
+        }
+      }
     };
 
     this.marker = {
       options: {
         draggable: true
       },
-      events: {}
+      events: {
+        dragend: (marker, eventName, args) => {
+          this.setLocation(marker.getPosition().lat(), marker.getPosition().lng());
+          $scope.$apply();
+        }
+      }
+    };
+  }
+
+  setLocation(latitude, longitude) {
+    this.location = {
+      latitude,
+      longitude
     };
   }
 }
-- 
2.7.4


From 03c3baed1d04b8eae8341b75cc059d11f7188f4e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:45:34 +0200
Subject: [PATCH 202/376] Step 16.10: Add location to be updated with a party

---
 imports/ui/components/partyDetails/partyDetails.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index a81a8fa..471edc1 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -50,7 +50,8 @@ class PartyDetails {
       $set: {
         name: this.party.name,
         description: this.party.description,
-        public: this.party.public
+        public: this.party.public,
+        location: this.party.location
       }
     }, (error) => {
       if (error) {
-- 
2.7.4


From 405b5ec5a79c4ede70e5d37c3724fa9d3b26becc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:49:27 +0200
Subject: [PATCH 203/376] Step 16.11: Create view for PartiesMap

---
 imports/ui/components/partiesMap/partiesMap.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partiesMap/partiesMap.html

diff --git a/imports/ui/components/partiesMap/partiesMap.html b/imports/ui/components/partiesMap/partiesMap.html
new file mode 100644
index 0000000..a488738
--- /dev/null
+++ b/imports/ui/components/partiesMap/partiesMap.html
@@ -0,0 +1,5 @@
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="partiesMap.map.center" zoom="partiesMap.map.zoom">
+    <ui-gmap-markers models="partiesMap.parties" coords="'location'" fit="true" idkey="'_id'" doRebuildAll="true"></ui-gmap-markers>
+  </ui-gmap-google-map>
+</div>
-- 
2.7.4


From 3f5a07d2607eb06968c1efd5200a49bca6d15fe2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:49:42 +0200
Subject: [PATCH 204/376] Step 16.12: Create component

---
 imports/ui/components/partiesMap/partiesMap.js | 37 ++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)
 create mode 100644 imports/ui/components/partiesMap/partiesMap.js

diff --git a/imports/ui/components/partiesMap/partiesMap.js b/imports/ui/components/partiesMap/partiesMap.js
new file mode 100644
index 0000000..1c94faf
--- /dev/null
+++ b/imports/ui/components/partiesMap/partiesMap.js
@@ -0,0 +1,37 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import 'angular-simple-logger';
+import 'angular-google-maps';
+
+import template from './partiesMap.html';
+
+/**
+ * PartiesMap component
+ */
+class PartiesMap {
+  constructor() {
+    this.map = {
+      center: {
+        latitude: 45,
+        longitude: -73
+      },
+      zoom: 8
+    };
+  }
+}
+
+const name = 'partiesMap';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  'nemLogging', // https://github.com/angular-ui/angular-google-maps/issues/1633
+  'uiGmapgoogle-maps'
+]).component(name, {
+  template,
+  controllerAs: name,
+  bindings: {
+    parties: '='
+  },
+  controller: PartiesMap
+});
-- 
2.7.4


From ac0b9515ee694a17cfa6f282d5b9cbde9bcdb56e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:49:56 +0200
Subject: [PATCH 205/376] Step 16.13: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 58dd939..a8e8e0f 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -8,6 +8,7 @@ import { Counts } from 'meteor/tmeasday:publish-counts';
 import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartiesSort } from '../partiesSort/partiesSort';
+import { name as PartiesMap } from '../partiesMap/partiesMap';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
@@ -76,6 +77,7 @@ export default angular.module(name, [
   uiRouter,
   utilsPagination,
   PartiesSort,
+  PartiesMap,
   PartyAdd,
   PartyRemove,
   PartyCreator,
-- 
2.7.4


From ca156734f73ec0770e9861ab0afc30649b64eac8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:50:10 +0200
Subject: [PATCH 206/376] Step 16.14: Implement in the view

---
 imports/ui/components/partiesList/partiesList.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index c4cc2c1..a7984f6 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -31,3 +31,6 @@
 </ul>
 
 <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+
+
+<parties-map parties="partiesList.parties"></parties-map>
-- 
2.7.4


From b552ed2dc4175275cfcbcc8d0b938c1939648c3b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 00:31:49 +0200
Subject: [PATCH 207/376] Step 17.1: Install `bootstrap`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index af5599d..158bf82 100644
--- a/package.json
+++ b/package.json
@@ -12,6 +12,7 @@
     "angular-ui-router": "^0.2.18",
     "angular-simple-logger": "^0.1.7",
     "angular-utils-pagination": "^0.11.1",
+    "bootstrap": "^4.0.0-alpha.2",
     "meteor-node-stubs": "~0.2.0",
     "underscore": "^1.8.3"
   },
-- 
2.7.4


From dcbe9efd703ec94a428f9651fd66fbadbc0b88a2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 00:32:37 +0200
Subject: [PATCH 208/376] Step 17.2: Add `less` package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 27dfd39..4e35175 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ accounts-twitter
 tmeasday:publish-counts
 check
 email
+less
-- 
2.7.4


From 04c09984b93cd4c6ec3b6fbce053622b17cbf580 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 00:34:27 +0200
Subject: [PATCH 209/376] Step 17.3: Add main.less

---
 client/main.less | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/main.less

diff --git a/client/main.less b/client/main.less
new file mode 100644
index 0000000..1c1bc90
--- /dev/null
+++ b/client/main.less
@@ -0,0 +1,3 @@
+body {
+  background-color: #f9f9f9;
+}
-- 
2.7.4


From fd30676e86888688bc1fff70bfbd2da338c71ce3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:03:30 +0200
Subject: [PATCH 210/376] Step 17.4: Import bootstrap

---
 client/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/main.js b/client/main.js
index 06731e1..52cb827 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,4 +1,5 @@
 import angular from 'angular';
+import 'bootstrap/dist/css/bootstrap.css';
 
 import { Meteor } from 'meteor/meteor';
 
-- 
2.7.4


From 288b9b53e22771719d2865af4980db55ff326d27 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:04:28 +0200
Subject: [PATCH 211/376] Step 17.5: Import future Socially less file

---
 client/main.less | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/main.less b/client/main.less
index 1c1bc90..4368004 100644
--- a/client/main.less
+++ b/client/main.less
@@ -1,3 +1,5 @@
 body {
   background-color: #f9f9f9;
 }
+
+@import "../imports/ui/components/socially/socially.less";
-- 
2.7.4


From 94965a414c08c2450cd3388883702f1c8ed6a12c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:05:42 +0200
Subject: [PATCH 212/376] Step 17.6: Refactor Socially

---
 imports/ui/components/socially/socially.html | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 83c40e7..2e91050 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1,5 +1,3 @@
-<login-buttons></login-buttons>
+<navigation class="navbar navbar-static-top navbar-dark bg-inverse"></navigation>
 
-<navigation></navigation>
-
-<div ui-view=""></div>
+<div ui-view="" class="container-fluid"></div>
-- 
2.7.4


From 97234f4e5a9392738938e164da51c9a23829bba8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:06:24 +0200
Subject: [PATCH 213/376] Step 17.7: Styles for Socially

---
 imports/ui/components/socially/socially.less | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/socially/socially.less

diff --git a/imports/ui/components/socially/socially.less b/imports/ui/components/socially/socially.less
new file mode 100644
index 0000000..eec0480
--- /dev/null
+++ b/imports/ui/components/socially/socially.less
@@ -0,0 +1,3 @@
+socially {
+  display: block;
+}
-- 
2.7.4


From 27f6adb6c5919897bc5e3936cb1d4cea05036288 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:06:51 +0200
Subject: [PATCH 214/376] Step 17.8: Refactor index.html

---
 client/index.html | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/index.html b/client/index.html
index 0a26426..d4505ca 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,5 +1,10 @@
 <head>
+  <meta charset="utf-8">
+  <meta http-equiv="X-UA-Compatible" content="IE=edge">
+  <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
+  <title>Socially</title>
+  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
 </head>
 <body>
   <socially></socially>
-- 
2.7.4


From c1af639c636f1bce12a8c1561eb4c8536a7a1769 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:07:16 +0200
Subject: [PATCH 215/376] Step 17.9: Refactor Navigation

---
 imports/ui/components/navigation/navigation.html | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/navigation/navigation.html b/imports/ui/components/navigation/navigation.html
index def2640..2bcae64 100644
--- a/imports/ui/components/navigation/navigation.html
+++ b/imports/ui/components/navigation/navigation.html
@@ -1,3 +1,6 @@
-<h1>
-  <a href="/parties">Home</a>
-</h1>
+<div class="fluid-container">
+  <div class="navbar-header">
+    <a href="/parties" class="navbar-brand">Socially</a>
+    <login-buttons class="navbar-brand"></login-buttons>
+  </div>
+</div>
-- 
2.7.4


From 964092d849fae756cd970bc2c957f7b248a9360e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:08:18 +0200
Subject: [PATCH 216/376] Step 17.10: Styles for Navigation

---
 imports/ui/components/navigation/navigation.less | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/navigation/navigation.less

diff --git a/imports/ui/components/navigation/navigation.less b/imports/ui/components/navigation/navigation.less
new file mode 100644
index 0000000..4035b7b
--- /dev/null
+++ b/imports/ui/components/navigation/navigation.less
@@ -0,0 +1,3 @@
+navigation {
+  display: block;
+}
-- 
2.7.4


From 690471a64c614e25ec155fa7579246214d060789 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:08:50 +0200
Subject: [PATCH 217/376] Step 17.11: Refactor PartiesList

---
 imports/ui/components/partiesList/partiesList.html | 94 ++++++++++++++--------
 1 file changed, 62 insertions(+), 32 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index a7984f6..29c4c69 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,36 +1,66 @@
-<party-add ng-show="partiesList.isLoggedIn"></party-add>
-<div ng-hide="partiesList.isLoggedIn">
-  Log in to create a party!
-</div>
-
-<input type="search" ng-model="partiesList.searchText" placeholder="Search" />
-
-<parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
+<div class="container-fluid">
+  <div class="row">
+    <div class="col-md-12">
+      <party-add ng-show="partiesList.isLoggedIn"></party-add>
 
-<ul>
-  <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
-    <a ui-sref="partyDetails({ partyId: party._id })">
-      {{party.name}}
-    </a>
-    <p>{{party.description}}</p>
-    <party-remove party="party" ng-show="partiesList.isOwner(party)"></party-remove>
-    <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
-    <div ng-hide="partiesList.isLoggedIn">
-      <i>Sign in to RSVP for this party.</i>
+      <div class="alert alert-warning" role="alert" ng-hide="partiesList.isLoggedIn">
+        <strong>Warning!</strong>
+        Log in to create a party!
+      </div>
     </div>
-
-    <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
-
-    <party-unanswered party="party" ng-if="!party.public"></party-unanswered>
-    <div ng-if="party.public">
-      Everyone is invited
+  </div>
+  <div class="row">
+    <div class="col-md-12">
+      <h2>List of parties:</h2>
+      <form class="form-inline">
+        <div class="form-group">
+          <input type="search" ng-model="partiesList.searchText" placeholder="Search" class="form-control"/>
+        </div>
+        <parties-sort class="form-group" on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
+      </form>
     </div>
+  </div>
+  <div class="row">
+    <div class="col-md-6">
+      <ul class="parties">
+        <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
+          <div class="row">
+            <div class="col-sm-8">
+              <h3 class="party-name">
+                <a ui-sref="partyDetails({ partyId: party._id })">{{party.name}}</a>
+              </h3>
+              <p class="party-description">
+                {{party.description}}
+              </p>
+            </div>
+            <div class="col-sm-4">
+              <party-remove party="party" ng-show="partiesList.isOwner(party)"></party-remove>
+            </div>
+          </div>
+          <div class="row">
+            <div class="col-md-12">
+              <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
+              <div class="alert alert-warning" role="alert" ng-hide="partiesList.isLoggedIn">
+                <strong>Warning!</strong>
+                <i>Sign in to RSVP for this party.</i>
+              </div>
+            </div>
+          </div>
+          <div class="row">
+            <div class="col-md-4">
+              <party-creator party="party"></party-creator>
+            </div>
+            <div class="col-md-8">
+              <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
+            </div>
+          </div>
+        </li>
+      </ul>
 
-    <party-creator party="party"></party-creator>
-  </li>
-</ul>
-
-<dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-
-
-<parties-map parties="partiesList.parties"></parties-map>
+      <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+    </div>
+    <div class="col-md-6">
+      <parties-map parties="partiesList.parties"></parties-map>
+    </div>
+  </div>
+</div>
-- 
2.7.4


From 8a5934e148c4c46a462d560f45c5f50c97ebf8ff Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:09:21 +0200
Subject: [PATCH 218/376] Step 17.12: Styles for PartiesList

---
 imports/ui/components/partiesList/partiesList.less | 30 ++++++++++++++++++++++
 1 file changed, 30 insertions(+)
 create mode 100644 imports/ui/components/partiesList/partiesList.less

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
new file mode 100644
index 0000000..6cd14df
--- /dev/null
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -0,0 +1,30 @@
+parties-list {
+  display: block;
+  padding: 25px 0;
+
+  ul.parties {
+    padding-left: 0;
+    list-style-type: none;
+
+    > li {
+      padding: 15px;
+      background-color: #fff;
+      margin: 15px 0;
+      border: 3px solid #eaeaea;
+
+     .party-name {
+       margin-top: 0px;
+       margin-bottom: 20px;
+       a {
+         text-decoration: none !important;
+         font-weight: 400;
+       }
+     }
+     .party-description {
+       font-weight: 300;
+       padding-left: 18px;
+       font-size: 14px;
+     }
+    }
+  }
+}
-- 
2.7.4


From acc217df9ecea8f59e32d0fa9dd683c2fcd2dab7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:09:54 +0200
Subject: [PATCH 219/376] Step 17.13: Refactor PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.html | 31 ++++++++++++++++------------
 1 file changed, 18 insertions(+), 13 deletions(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index 4db1888..7c4d284 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -1,15 +1,20 @@
 <form>
-  <label>
-    Party Name:
-  </label>
-  <input type="text" ng-model="partyAdd.party.name" />
-  <label>
-    Description:
-  </label>
-  <input type="text" ng-model="partyAdd.party.description" />
-  <label>
-    Public Party?
-  </label>
-  <input type="checkbox" ng-model="partyAdd.party.public">
-  <button ng-click="partyAdd.submit()">Add Party!</button>
+  <div class="form-group">
+    <label>
+      Party Name:
+    </label>
+    <input type="text" ng-model="partyAdd.party.name" class="form-control"/>
+  </div>
+  <div class="form-group">
+    <label>
+      Description:
+    </label>
+    <input type="text" ng-model="partyAdd.party.description" class="form-control"/>
+  </div>
+  <div class="checkbox">
+    <label>
+      <input type="checkbox" ng-model="partyAdd.party.public"/> Public Party?
+    </label>
+  </div>
+  <button ng-click="partyAdd.submit()" class="btn btn-success">Add Party!</button>
 </form>
-- 
2.7.4


From 8a5a6865690971476f5a2a227adba5b65e7f0022 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:10:22 +0200
Subject: [PATCH 220/376] Step 17.14: Styles for PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.less | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/partyAdd.less

diff --git a/imports/ui/components/partyAdd/partyAdd.less b/imports/ui/components/partyAdd/partyAdd.less
new file mode 100644
index 0000000..90b24c1
--- /dev/null
+++ b/imports/ui/components/partyAdd/partyAdd.less
@@ -0,0 +1,10 @@
+party-add {
+  display: block;
+}
+
+party-add > form {
+  padding: 15px;
+  margin-bottom: 25px;
+  background-color: #fff;
+  border: 3px solid #EAEAEC;
+}
-- 
2.7.4


From 4340fbf25466691a097c03deab1febbffd544125 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:11:05 +0200
Subject: [PATCH 221/376] Step 17.15: Import PartyAdd

---
 imports/ui/components/partiesList/partiesList.less | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index 6cd14df..645d165 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -28,3 +28,5 @@ parties-list {
     }
   }
 }
+
+@import "../partyAdd/partyAdd.less";
-- 
2.7.4


From ba92b25846c8a3d1a524e26370c2da5920390672 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:11:45 +0200
Subject: [PATCH 222/376] Step 17.16: Refactor PartiesMap

---
 imports/ui/components/partiesMap/partiesMap.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesMap/partiesMap.html b/imports/ui/components/partiesMap/partiesMap.html
index a488738..870b2f7 100644
--- a/imports/ui/components/partiesMap/partiesMap.html
+++ b/imports/ui/components/partiesMap/partiesMap.html
@@ -1,3 +1,6 @@
+<h4>
+  See all the parties:
+</h4>
 <div class="angular-google-map-container">
   <ui-gmap-google-map center="partiesMap.map.center" zoom="partiesMap.map.zoom">
     <ui-gmap-markers models="partiesMap.parties" coords="'location'" fit="true" idkey="'_id'" doRebuildAll="true"></ui-gmap-markers>
-- 
2.7.4


From a27f3054625b4286b4d3121226c6fa2839964f0e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:12:13 +0200
Subject: [PATCH 223/376] Step 17.17: Styles for PartiesMap

---
 imports/ui/components/partiesMap/partiesMap.less | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 imports/ui/components/partiesMap/partiesMap.less

diff --git a/imports/ui/components/partiesMap/partiesMap.less b/imports/ui/components/partiesMap/partiesMap.less
new file mode 100644
index 0000000..020e970
--- /dev/null
+++ b/imports/ui/components/partiesMap/partiesMap.less
@@ -0,0 +1,9 @@
+parties-map {
+  display: block;
+  margin: 15px 5px;
+
+  .angular-google-map-container {
+    width: 100%;
+    height: 400px;
+  }
+}
-- 
2.7.4


From 657aa89e9a92e1ebaee0e2e96a3fe62ad7ea8487 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:12:38 +0200
Subject: [PATCH 224/376] Step 17.18: Import PartiesMap

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index 645d165..374d741 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -30,3 +30,4 @@ parties-list {
 }
 
 @import "../partyAdd/partyAdd.less";
+@import "../partiesMap/partiesMap.less";
-- 
2.7.4


From 7f6c01b7c81b7f500606f5f0f59503be349dbab1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:13:05 +0200
Subject: [PATCH 225/376] Step 17.19: Refactor PartiesSort

---
 imports/ui/components/partiesSort/partiesSort.html | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

diff --git a/imports/ui/components/partiesSort/partiesSort.html b/imports/ui/components/partiesSort/partiesSort.html
index cf2102b..b2a52b3 100644
--- a/imports/ui/components/partiesSort/partiesSort.html
+++ b/imports/ui/components/partiesSort/partiesSort.html
@@ -1,6 +1,4 @@
-<div>
-  <select ng-model="partiesSort.order" ng-change="partiesSort.changed()">
-    <option value="1">Ascending</option>
-    <option value="-1">Descending</option>
-  </select>
-</div>
+<select ng-model="partiesSort.order" ng-change="partiesSort.changed()" class="form-control">
+  <option value="1">Ascending</option>
+  <option value="-1">Descending</option>
+</select>
-- 
2.7.4


From 9e78504b63d61df63a1d9159fd063d2366b1266c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:13:38 +0200
Subject: [PATCH 226/376] Step 17.20: Refactor PartyCreator

---
 imports/ui/components/partyCreator/partyCreator.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyCreator/partyCreator.html b/imports/ui/components/partyCreator/partyCreator.html
index de986fb..077739d 100644
--- a/imports/ui/components/partyCreator/partyCreator.html
+++ b/imports/ui/components/partyCreator/partyCreator.html
@@ -1,5 +1,5 @@
 <p>
   <small>
-    Posted by {{ partyCreator.creator | displayNameFilter }}
+    <i class="fa fa-user fa-lg"></i> {{ partyCreator.creator | displayNameFilter }}
   </small>
 </p>
-- 
2.7.4


From e6f590c48a4677b9c194411109bc3169367d547c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:14:04 +0200
Subject: [PATCH 227/376] Step 17.21: Styles for PartyCreator

---
 imports/ui/components/partyCreator/partyCreator.less | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/partyCreator.less

diff --git a/imports/ui/components/partyCreator/partyCreator.less b/imports/ui/components/partyCreator/partyCreator.less
new file mode 100644
index 0000000..4679f1f
--- /dev/null
+++ b/imports/ui/components/partyCreator/partyCreator.less
@@ -0,0 +1,6 @@
+party-creator {
+  i.fa {
+    margin-left: 5px;
+    margin-right: 10px;
+  }
+}
-- 
2.7.4


From dcc418a6a59e1c90ef57e4ece3dda21c4b1b4eb8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:14:40 +0200
Subject: [PATCH 228/376] Step 17.22: Import PartyCreator

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index 374d741..e73e928 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -31,3 +31,4 @@ parties-list {
 
 @import "../partyAdd/partyAdd.less";
 @import "../partiesMap/partiesMap.less";
+@import "../partyCreator/partyCreator.less";
-- 
2.7.4


From fb5098c698ba8f00a382861716f944424f750d04 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:15:08 +0200
Subject: [PATCH 229/376] Step 17.23: Refactor PartyRemove

---
 imports/ui/components/partyRemove/partyRemove.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyRemove/partyRemove.html b/imports/ui/components/partyRemove/partyRemove.html
index 1295105..ebe46ea 100644
--- a/imports/ui/components/partyRemove/partyRemove.html
+++ b/imports/ui/components/partyRemove/partyRemove.html
@@ -1 +1 @@
-<button ng-click="partyRemove.remove()">X</button>
+<button type="button" class="close" aria-label="Close" ng-click="partyRemove.remove()"><span aria-hidden="true">&times;</span></button>
-- 
2.7.4


From 6dc899b39355e3a8a529e34c155dab7329ff91d3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:15:48 +0200
Subject: [PATCH 230/376] Step 17.24: Refactor PartyRsvp

---
 imports/ui/components/partyRsvp/partyRsvp.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partyRsvp/partyRsvp.html b/imports/ui/components/partyRsvp/partyRsvp.html
index ca15260..e4c078c 100644
--- a/imports/ui/components/partyRsvp/partyRsvp.html
+++ b/imports/ui/components/partyRsvp/partyRsvp.html
@@ -1,3 +1,3 @@
-<input type="button" value="I'm going!" ng-click="partyRsvp.yes()"/>
-<input type="button" value="Maybe" ng-click="partyRsvp.maybe()"/>
-<input type="button" value="No" ng-click="partyRsvp.no()"/>
+<input type="button" value="I'm going!" ng-click="partyRsvp.yes()" class="btn btn-default" ng-class="{'btn-primary' : partyRsvp.isYes()}"/>
+<input type="button" value="Maybe" ng-click="partyRsvp.maybe()" class="btn btn-default" ng-class="{'btn-primary' : partyRsvp.isMaybe()}"/>
+<input type="button" value="No" ng-click="partyRsvp.no()" class="btn btn-default" ng-class="{'btn-primary' : partyRsvp.isNo()}"/>
-- 
2.7.4


From 7ded6bd873e269a77d17e8b21cffa49e601e6cc5 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:16:13 +0200
Subject: [PATCH 231/376] Step 17.25: Styles for PartyRsvp

---
 imports/ui/components/partyRsvp/partyRsvp.less | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 imports/ui/components/partyRsvp/partyRsvp.less

diff --git a/imports/ui/components/partyRsvp/partyRsvp.less b/imports/ui/components/partyRsvp/partyRsvp.less
new file mode 100644
index 0000000..be52d51
--- /dev/null
+++ b/imports/ui/components/partyRsvp/partyRsvp.less
@@ -0,0 +1,4 @@
+party-rsvp {
+  display: block;
+  margin: 15px 0;
+}
-- 
2.7.4


From 73ea5c85e271261b1c21e625dafc502006c455db Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:17:04 +0200
Subject: [PATCH 232/376] Step 17.26: Import PartyRsvp

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index e73e928..be384ba 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -32,3 +32,4 @@ parties-list {
 @import "../partyAdd/partyAdd.less";
 @import "../partiesMap/partiesMap.less";
 @import "../partyCreator/partyCreator.less";
+@import "../partyRsvp/partyRsvp.less";
-- 
2.7.4


From 1638219bfb257bd4ef2ad40d9a8273a16e6317cd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:17:32 +0200
Subject: [PATCH 233/376] Step 17.27: Refactor PartyRsvpsList

---
 .../components/partyRsvpsList/partyRsvpsList.html  | 36 ++++++++++++++++------
 1 file changed, 26 insertions(+), 10 deletions(-)

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.html b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
index 2e1749d..5c24b02 100644
--- a/imports/ui/components/partyRsvpsList/partyRsvpsList.html
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
@@ -1,10 +1,26 @@
-Who is coming: Yes -
-{{ (partyRsvpsList.rsvps | filter:{rsvp:'yes'}).length }}
-Maybe -
-{{ (partyRsvpsList.rsvps | filter:{rsvp:'maybe'}).length }}
-No -
-{{ (partyRsvpsList.rsvps | filter:{rsvp:'no'}).length }}
-
-<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="yes"></party-rsvp-users>
-<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="maybe"></party-rsvp-users>
-<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="no"></party-rsvp-users>
+<div class="rsvp-sum">
+  <div class="rsvp-amount">
+    <div class="amount">
+      {{ (partyRsvpsList.rsvps | filter:{rsvp:'yes'}).length || 0 }}
+    </div>
+    <div class="rsvp-title">
+      YES
+    </div>
+  </div>
+  <div class="rsvp-amount">
+    <div class="amount">
+      {{ (partyRsvpsList.rsvps | filter:{rsvp:'maybe'}).length || 0 }}
+    </div>
+    <div class="rsvp-title">
+      MAYBE
+    </div>
+  </div>
+  <div class="rsvp-amount">
+    <div class="amount">
+      {{ (partyRsvpsList.rsvps | filter:{rsvp:'no'}).length || 0 }}
+    </div>
+    <div class="rsvp-title">
+      NO
+    </div>
+  </div>
+</div>
-- 
2.7.4


From dcb393e174e53385aa0e85007610a04ff82aba6d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:17:59 +0200
Subject: [PATCH 234/376] Step 17.28: Styles for PartyRsvpsList

---
 .../components/partyRsvpsList/partyRsvpsList.less  | 24 ++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpsList/partyRsvpsList.less

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.less b/imports/ui/components/partyRsvpsList/partyRsvpsList.less
new file mode 100644
index 0000000..ca24446
--- /dev/null
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.less
@@ -0,0 +1,24 @@
+.rsvp-sum {
+  width: 160px;
+  @media (min-width: 400px) {
+    float: right;
+  }
+  @media (max-width: 400px) {
+    margin: 0 auto;
+  }
+  > .rsvp-amount {
+    display: inline-block;
+    text-align: center;
+    width: 50px;
+
+    > .amount {
+      font-weight: bold;
+      font-size: 20px;
+    }
+    > .rsvp-title {
+      font-size: 11px;
+      color: #aaa;
+      text-transform: uppercase;
+    }
+  }
+}
-- 
2.7.4


From e2b2da7b3b073b7f34baa8f500663cd96e92a0a3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:18:30 +0200
Subject: [PATCH 235/376] Step 17.29: Import PartyRsvpsList

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index be384ba..a1eac5c 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -33,3 +33,4 @@ parties-list {
 @import "../partiesMap/partiesMap.less";
 @import "../partyCreator/partyCreator.less";
 @import "../partyRsvp/partyRsvp.less";
+@import "../partyRsvpsList/partyRsvpsList.less";
-- 
2.7.4


From 000654ca2fa2a4eeeafbb3628216b76361948e2d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:19:03 +0200
Subject: [PATCH 236/376] Step 17.30: Refactor PartyUninvited

---
 imports/ui/components/partyUninvited/partyUninvited.html | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index 86d2519..e9f9e1c 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -1,10 +1,10 @@
+<h4>Users to invite:</h4>
 <ul>
-  Users to invite:
   <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
-    <div>{{ user | displayNameFilter }}</div>
-    <button ng-click="partyUninvited.invite(user)">Invite</button>
-  </li>
-  <li ng-if="(partyUninvited.users | uninvitedFilter:partyUninvited.party).length <= 0">
-    Everyone are already invited.
+    <button ng-click="partyUninvited.invite(user)" class="btn btn-primary-outline">Invite</button>
+    {{ user | displayNameFilter }}
   </li>
 </ul>
+<div class="alert alert-success" role="alert" ng-if="(partyUninvited.users | uninvitedFilter:partyUninvited.party).length <= 0">
+  Everyone are already invited.
+</div>
-- 
2.7.4


From b321b66592274e0d71438b6dad72442e2d337cf5 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:26:22 +0200
Subject: [PATCH 237/376] Step 17.31: Styles for PartyUninvited

---
 imports/ui/components/partyUninvited/partyUninvited.less | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 imports/ui/components/partyUninvited/partyUninvited.less

diff --git a/imports/ui/components/partyUninvited/partyUninvited.less b/imports/ui/components/partyUninvited/partyUninvited.less
new file mode 100644
index 0000000..52b27fe
--- /dev/null
+++ b/imports/ui/components/partyUninvited/partyUninvited.less
@@ -0,0 +1,8 @@
+party-uninvited {
+  display: block;
+
+  ul {
+    padding-left: 0;
+    list-style-type: none;
+  }
+}
-- 
2.7.4


From e68c226db16bdcf4c09ce298333218a6673eb6e0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:19:41 +0200
Subject: [PATCH 238/376] Step 17.32: Refactor PartyDetails

---
 .../ui/components/partyDetails/partyDetails.html   | 42 ++++++++++++++++------
 1 file changed, 32 insertions(+), 10 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 7354dd6..4023174 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -1,13 +1,35 @@
-The party your selected is:
-<form>
-  Party name: <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn"/>
-  Description: <input type="text" ng-model="partyDetails.party.description" ng-disabled="!partyDetails.isLoggedIn"/>
-  Public Party? <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="!partyDetails.isLoggedIn"/>
-  <button ng-click="partyDetails.save()">Save</button>
-</form>
+<div class="container-fluid">
+  <div class="row">
+    <div class="col-md-6">
+      <form>
+        <fieldset class="form-group">
+          <label>Party name</label>
+          <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn" class="form-control"/>
+        </fieldset>
 
-<button ui-sref="parties">Back</button>
+        <fieldset class="form-group">
+          <label>Description</label>
+          <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn" class="form-control"/>
+        </fieldset>
 
-<party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
+        <div class="checkbox">
+          <label>
+            <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="!partyDetails.isLoggedIn"/>
+            Public Party?
+          </label>
+        </div>
 
-<party-map location="partyDetails.party.location"></party-map>
+        <button ng-click="partyDetails.save()" type="submit" class="btn btn-primary">Save</button>
+      </form>
+    </div>
+    <div class="col-md-6">
+      <party-map location="partyDetails.party.location"></party-map>
+    </div>
+  </div>
+
+  <div class="row">
+    <div class="col-md-6">
+      <party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
+    </div>
+  </div>
+</div>
-- 
2.7.4


From 6d94060360c568335e32e100433b8d1fd5684aab Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:20:17 +0200
Subject: [PATCH 239/376] Step 17.33: Styles for PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.less | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 imports/ui/components/partyDetails/partyDetails.less

diff --git a/imports/ui/components/partyDetails/partyDetails.less b/imports/ui/components/partyDetails/partyDetails.less
new file mode 100644
index 0000000..bfea863
--- /dev/null
+++ b/imports/ui/components/partyDetails/partyDetails.less
@@ -0,0 +1,9 @@
+party-details {
+  display: block;
+
+  form {
+    margin: 25px 0;
+  }
+}
+
+@import "../partyUninvited/partyUninvited.less";
-- 
2.7.4


From 802cbb724a68ec07f90e0ae376f0d99662d9afac Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:21:01 +0200
Subject: [PATCH 240/376] Step 17.34: Styles for PartyMap

---
 imports/ui/components/partyMap/partyMap.less | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.less

diff --git a/imports/ui/components/partyMap/partyMap.less b/imports/ui/components/partyMap/partyMap.less
new file mode 100644
index 0000000..3b4bed1
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.less
@@ -0,0 +1,10 @@
+party-map {
+  display: block;
+  width: 100%;
+  margin: 25px 0;
+
+  .angular-google-map-container {
+    width: 100%;
+    height: 400px;
+  }
+}
-- 
2.7.4


From 79acb481b3a37f20cf7919089d4e1ac588628d83 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:21:22 +0200
Subject: [PATCH 241/376] Step 17.35: Remove old css

---
 imports/ui/components/partyMap/partyMap.js | 1 -
 1 file changed, 1 deletion(-)

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
index 9db5069..c062d30 100644
--- a/imports/ui/components/partyMap/partyMap.js
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -3,7 +3,6 @@ import angularMeteor from 'angular-meteor';
 import 'angular-simple-logger';
 import 'angular-google-maps';
 
-import './partyMap.css';
 import template from './partyMap.html';
 
 class PartyMap {
-- 
2.7.4


From ccdcdd59f31c12db536873baab17c6952c1be6c8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:21:43 +0200
Subject: [PATCH 242/376] Step 17.36: Delete old file

---
 imports/ui/components/partyMap/partyMap.css | 4 ----
 1 file changed, 4 deletions(-)
 delete mode 100644 imports/ui/components/partyMap/partyMap.css

diff --git a/imports/ui/components/partyMap/partyMap.css b/imports/ui/components/partyMap/partyMap.css
deleted file mode 100644
index f4b49f5..0000000
--- a/imports/ui/components/partyMap/partyMap.css
+++ /dev/null
@@ -1,4 +0,0 @@
-.angular-google-map-container {
-  height: 400px;
-  width: 400px;
-}
-- 
2.7.4


From c9166ba308de5eaeae33d175bdd70f631774be68 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:22:35 +0200
Subject: [PATCH 243/376] Step 17.37: Import PartyMap

---
 imports/ui/components/partyDetails/partyDetails.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.less b/imports/ui/components/partyDetails/partyDetails.less
index bfea863..a42c467 100644
--- a/imports/ui/components/partyDetails/partyDetails.less
+++ b/imports/ui/components/partyDetails/partyDetails.less
@@ -7,3 +7,4 @@ party-details {
 }
 
 @import "../partyUninvited/partyUninvited.less";
+@import "../partyMap/partyMap.less";
-- 
2.7.4


From 118d17ce7554b72be9ac15985084ea5f508661fa Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:23:50 +0200
Subject: [PATCH 244/376] Step 17.38: Import missing files

---
 imports/ui/components/socially/socially.less | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/components/socially/socially.less b/imports/ui/components/socially/socially.less
index eec0480..3eabc12 100644
--- a/imports/ui/components/socially/socially.less
+++ b/imports/ui/components/socially/socially.less
@@ -1,3 +1,8 @@
 socially {
   display: block;
 }
+
+
+@import "../navigation/navigation.less";
+@import "../partiesList/partiesList.less";
+@import "../partyDetails/partyDetails.less";
-- 
2.7.4


From d52095d4429c5bc1234f14452a2af3fd52becb92 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 01:32:24 +0200
Subject: [PATCH 245/376] Step 17.39: Add checking methods

---
 imports/ui/components/partyRsvp/partyRsvp.js | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/imports/ui/components/partyRsvp/partyRsvp.js b/imports/ui/components/partyRsvp/partyRsvp.js
index 17aeb99..522cc38 100644
--- a/imports/ui/components/partyRsvp/partyRsvp.js
+++ b/imports/ui/components/partyRsvp/partyRsvp.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import _ from 'underscore';
 
 import { Meteor } from 'meteor/meteor';
 
@@ -9,14 +10,23 @@ class PartyRsvp {
   yes() {
     this.answer('yes');
   }
+  isYes() {
+    return this.isAnswer('yes');
+  }
 
   maybe() {
     this.answer('maybe');
   }
+  isMaybe() {
+    return this.isAnswer('maybe');
+  }
 
   no() {
     this.answer('no');
   }
+  isNo() {
+    return this.isAnswer('no');
+  }
 
   answer(answer) {
     Meteor.call('rsvp', this.party._id, answer, (error) => {
@@ -27,6 +37,14 @@ class PartyRsvp {
       }
     });
   }
+  isAnswer(answer) {
+    if(this.party) {
+      return !!_.findWhere(this.party.rsvps, {
+        user: Meteor.userId(),
+        rsvp: answer
+      });
+    }
+  }
 }
 
 const name = 'partyRsvp';
-- 
2.7.4


From 89ff8f6c4b320c621e54beb1fcf237a44c77ace0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:26:23 +0200
Subject: [PATCH 246/376] Step 17.40: Remove unused partyRsvpUsers

---
 imports/ui/components/partyRsvpUsers/partyRsvpUsers.html | 5 -----
 1 file changed, 5 deletions(-)
 delete mode 100644 imports/ui/components/partyRsvpUsers/partyRsvpUsers.html

diff --git a/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html
deleted file mode 100644
index 445d426..0000000
--- a/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html
+++ /dev/null
@@ -1,5 +0,0 @@
-<div ng-repeat="rsvp in partyRsvpUsers.rsvps | filter:{ rsvp: partyRsvpUsers.type }">
-  {{ partyRsvpUsers.getUserById(rsvp.user) | displayNameFilter }}
-  -
-  {{ partyRsvpUsers.type }}
-</div>
-- 
2.7.4


From c2de9fc8126e837ceaa839f2d481534de22f14ee Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:26:40 +0200
Subject: [PATCH 247/376] Step 17.41: Remove unused partyUnanswered

---
 .../partyUnanswered/partyUnanswered.html           |  5 ---
 .../components/partyUnanswered/partyUnanswered.js  | 39 ----------------------
 2 files changed, 44 deletions(-)
 delete mode 100644 imports/ui/components/partyUnanswered/partyUnanswered.html
 delete mode 100644 imports/ui/components/partyUnanswered/partyUnanswered.js

diff --git a/imports/ui/components/partyUnanswered/partyUnanswered.html b/imports/ui/components/partyUnanswered/partyUnanswered.html
deleted file mode 100644
index ecc1b45..0000000
--- a/imports/ui/components/partyUnanswered/partyUnanswered.html
+++ /dev/null
@@ -1,5 +0,0 @@
-<ul>
-  <li ng-repeat="invitedUser in partyUnanswered.getUnanswered()">
-    {{ partyUnanswered.getUserById(invitedUser) | displayNameFilter }}
-  </li>
-</ul>
diff --git a/imports/ui/components/partyUnanswered/partyUnanswered.js b/imports/ui/components/partyUnanswered/partyUnanswered.js
deleted file mode 100644
index 39f2115..0000000
--- a/imports/ui/components/partyUnanswered/partyUnanswered.js
+++ /dev/null
@@ -1,39 +0,0 @@
-import angular from 'angular';
-import angularMeteor from 'angular-meteor';
-import _ from 'underscore';
-
-import { Meteor } from 'meteor/meteor';
-
-import template from './partyUnanswered.html';
-import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
-
-class PartyUnanswered {
-  getUnanswered() {
-    if (!this.party || !this.party.invited) {
-      return;
-    }
-
-    return this.party.invited.filter((user) => {
-      return !_.findWhere(this.party.rsvps, { user });
-    });
-  }
-
-  getUserById(userId) {
-    return Meteor.users.findOne(userId)
-  }
-}
-
-const name = 'partyUnanswered';
-
-// create a module
-export default angular.module(name, [
-  angularMeteor,
-  DisplayNameFilter
-]).component(name, {
-  template,
-  controllerAs: name,
-  bindings: {
-    party: '<'
-  },
-  controller: PartyUnanswered
-});
-- 
2.7.4


From 93f2ed9525dfda723672cab37262e73691992af0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:27:20 +0200
Subject: [PATCH 248/376] Step 17.42: Remove PartyUnanswered

---
 imports/ui/components/partiesList/partiesList.js | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index a8e8e0f..ec99584 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -14,7 +14,6 @@ import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
 import { name as PartyRsvpsList } from '../partyRsvpsList/partyRsvpsList';
-import { name as PartyUnanswered } from '../partyUnanswered/partyUnanswered';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -82,8 +81,7 @@ export default angular.module(name, [
   PartyRemove,
   PartyCreator,
   PartyRsvp,
-  PartyRsvpsList,
-  PartyUnanswered
+  PartyRsvpsList
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 4bdedb6cfdcb92a90d95adf7618367d583084f07 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:27:38 +0200
Subject: [PATCH 249/376] Step 17.43: Remove PartyRsvpUsers

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.js | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.js b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
index c1ebd92..755c9f9 100644
--- a/imports/ui/components/partyRsvpsList/partyRsvpsList.js
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
@@ -2,7 +2,6 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import template from './partyRsvpsList.html';
-import { name as PartyRsvpUsers } from '../partyRsvpUsers/partyRsvpUsers';
 
 class PartyRsvpsList { }
 
@@ -10,8 +9,7 @@ const name = 'partyRsvpsList';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor,
-  PartyRsvpUsers
+  angularMeteor
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From b7e089ef0a91c034b4f9afc13ecc5ee3445d57f0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:37:40 +0200
Subject: [PATCH 250/376] Step 18.1: Uninstall `bootstrap`

---
 package.json | 1 -
 1 file changed, 1 deletion(-)

diff --git a/package.json b/package.json
index 158bf82..af5599d 100644
--- a/package.json
+++ b/package.json
@@ -12,7 +12,6 @@
     "angular-ui-router": "^0.2.18",
     "angular-simple-logger": "^0.1.7",
     "angular-utils-pagination": "^0.11.1",
-    "bootstrap": "^4.0.0-alpha.2",
     "meteor-node-stubs": "~0.2.0",
     "underscore": "^1.8.3"
   },
-- 
2.7.4


From 750a9e65f6b86f39999c3625bd405a93fb7b2838 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:38:13 +0200
Subject: [PATCH 251/376] Step 18.2: Install `angular-material`

---
 package.json | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/package.json b/package.json
index af5599d..8971ed8 100644
--- a/package.json
+++ b/package.json
@@ -7,7 +7,11 @@
   },
   "dependencies": {
     "angular": "^1.5.3",
+    "angular-animate": "^1.5.3",
+    "angular-aria": "^1.5.3",
     "angular-google-maps": "^2.3.2",
+    "angular-material": "^1.0.7",
+    "angular-messages": "^1.5.3",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
     "angular-simple-logger": "^0.1.7",
-- 
2.7.4


From af1561e100ef8fe08d0571193637714efdb32c47 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:38:56 +0200
Subject: [PATCH 252/376] Step 18.3: Add css

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index d4505ca..4a914a1 100644
--- a/client/index.html
+++ b/client/index.html
@@ -4,7 +4,7 @@
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
   <title>Socially</title>
-  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
+  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.0.7/angular-material.min.css">
 </head>
 <body>
   <socially></socially>
-- 
2.7.4


From b30b235b62f7bc16251874f963cd276ce2cf0a72 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:31:01 +0200
Subject: [PATCH 253/376] Step 18.4: Remove bootstrap from main.js

---
 client/main.js | 1 -
 1 file changed, 1 deletion(-)

diff --git a/client/main.js b/client/main.js
index 52cb827..06731e1 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,5 +1,4 @@
 import angular from 'angular';
-import 'bootstrap/dist/css/bootstrap.css';
 
 import { Meteor } from 'meteor/meteor';
 
-- 
2.7.4


From a0514f9c6951dc4e974d27bb3511031082080b40 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:39:53 +0200
Subject: [PATCH 254/376] Step 18.5: Add ngMaterial to Socially

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index dec6060..e692001 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import ngMaterial from 'angular-material';
 import uiRouter from 'angular-ui-router';
 
 import template from './socially.html';
@@ -14,6 +15,7 @@ const name = 'socially';
 // create a module
 export default angular.module(name, [
   angularMeteor,
+  ngMaterial,
   uiRouter,
   PartiesList,
   PartyDetails,
-- 
2.7.4


From ae1e75ad3813440a7fefb5b3bcb73652cf91d2f4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:41:34 +0200
Subject: [PATCH 255/376] Step 18.6: Clean up Socially template

---
 imports/ui/components/socially/socially.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 2e91050..7fdb2de 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1,3 +1,3 @@
-<navigation class="navbar navbar-static-top navbar-dark bg-inverse"></navigation>
+<navigation></navigation>
 
-<div ui-view="" class="container-fluid"></div>
+<div ui-view=""></div>
-- 
2.7.4


From e6a2b318b567ace1ac7d07f7df2c76e7c71b1485 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:43:06 +0200
Subject: [PATCH 256/376] Step 18.7: Refactor Navigation

---
 imports/ui/components/navigation/navigation.html | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

diff --git a/imports/ui/components/navigation/navigation.html b/imports/ui/components/navigation/navigation.html
index 2bcae64..0b1d8a6 100644
--- a/imports/ui/components/navigation/navigation.html
+++ b/imports/ui/components/navigation/navigation.html
@@ -1,6 +1,10 @@
-<div class="fluid-container">
-  <div class="navbar-header">
-    <a href="/parties" class="navbar-brand">Socially</a>
-    <login-buttons class="navbar-brand"></login-buttons>
+<md-toolbar>
+  <div class="md-toolbar-tools">
+    <h2>
+      <span ui-sref="parties">
+        Socially
+      </span>
+    </h2>
+    <login-buttons></login-buttons>
   </div>
-</div>
+</md-toolbar>
-- 
2.7.4


From 34a5e547a8841f03c36dbe41eca2580d20034afd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:43:40 +0200
Subject: [PATCH 257/376] Step 18.8: Add space before loginButtons

---
 imports/ui/components/navigation/navigation.less | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/navigation/navigation.less b/imports/ui/components/navigation/navigation.less
index 4035b7b..87b8777 100644
--- a/imports/ui/components/navigation/navigation.less
+++ b/imports/ui/components/navigation/navigation.less
@@ -1,3 +1,5 @@
 navigation {
-  display: block;
+  login-buttons {
+    margin-left: 15px;
+  }
 }
-- 
2.7.4


From 43496895eea8cf1d694e7a8a5321a34d59e628eb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:44:33 +0200
Subject: [PATCH 258/376] Step 18.9: Refactor PartiesList

---
 imports/ui/components/partiesList/partiesList.html | 99 ++++++++++------------
 1 file changed, 44 insertions(+), 55 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 29c4c69..b6772eb 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,65 +1,54 @@
-<div class="container-fluid">
-  <div class="row">
-    <div class="col-md-12">
-      <party-add ng-show="partiesList.isLoggedIn"></party-add>
+<div layout="column" layout-padding>
+  <party-add ng-show="partiesList.isLoggedIn"></party-add>
+  <div ng-hide="partiesList.isLoggedIn">
+    <i>Log in to create a party!</i>
+  </div>
 
-      <div class="alert alert-warning" role="alert" ng-hide="partiesList.isLoggedIn">
-        <strong>Warning!</strong>
-        Log in to create a party!
-      </div>
-    </div>
+  <div flex>
+    <h2 class="md-display-1">List of the parties:</h2>
   </div>
-  <div class="row">
-    <div class="col-md-12">
-      <h2>List of parties:</h2>
-      <form class="form-inline">
-        <div class="form-group">
-          <input type="search" ng-model="partiesList.searchText" placeholder="Search" class="form-control"/>
-        </div>
-        <parties-sort class="form-group" on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
-      </form>
-    </div>
+
+  <div flex layout="row" layout-padding>
+    <md-input-container>
+      <label>Search</label>
+      <input ng-model="partiesList.searchText">
+    </md-input-container>
+
+    <parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
   </div>
-  <div class="row">
-    <div class="col-md-6">
-      <ul class="parties">
-        <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
-          <div class="row">
-            <div class="col-sm-8">
-              <h3 class="party-name">
-                <a ui-sref="partyDetails({ partyId: party._id })">{{party.name}}</a>
-              </h3>
-              <p class="party-description">
-                {{party.description}}
-              </p>
-            </div>
-            <div class="col-sm-4">
-              <party-remove party="party" ng-show="partiesList.isOwner(party)"></party-remove>
-            </div>
-          </div>
-          <div class="row">
-            <div class="col-md-12">
-              <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
-              <div class="alert alert-warning" role="alert" ng-hide="partiesList.isLoggedIn">
-                <strong>Warning!</strong>
-                <i>Sign in to RSVP for this party.</i>
-              </div>
-            </div>
-          </div>
-          <div class="row">
-            <div class="col-md-4">
-              <party-creator party="party"></party-creator>
-            </div>
-            <div class="col-md-8">
-              <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
-            </div>
+
+  <div layout="column" layout-gt-sm="row">
+    <div flex="50">
+      <md-card dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
+        <md-card-title>
+          <md-card-title-text>
+            <span class="md-headline" ui-sref="partyDetails({ partyId: party._id })">
+              {{party.name}}
+              <party-remove party="party"></party-remove>
+            </span>
+            <span class="md-subhead">{{party.description}}</span>
+          </md-card-title-text>
+        </md-card-title>
+        <md-card-content>
+          <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
+
+          <party-unanswered party="party" ng-if="!party.public"></party-unanswered>
+          <div ng-if="party.public">
+            Everyone is invited
           </div>
-        </li>
-      </ul>
 
+          <party-creator party="party"></party-creator>
+        </md-card-content>
+        <md-card-actions>
+          <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
+          <div ng-hide="partiesList.isLoggedIn">
+            <i>Sign in to RSVP for this party.</i>
+          </div>
+        </md-card-actions>
+      </md-card>
       <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
     </div>
-    <div class="col-md-6">
+    <div flex="50">
       <parties-map parties="partiesList.parties"></parties-map>
     </div>
   </div>
-- 
2.7.4


From f5dbb232dff7ba04c3191a5ad6918f9ab058a723 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:45:55 +0200
Subject: [PATCH 259/376] Step 18.10: Leave only one definition

---
 imports/ui/components/partiesList/partiesList.less | 35 ++--------------------
 1 file changed, 2 insertions(+), 33 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index a1eac5c..ba0839b 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -1,36 +1,5 @@
 parties-list {
-  display: block;
-  padding: 25px 0;
-
-  ul.parties {
-    padding-left: 0;
-    list-style-type: none;
-
-    > li {
-      padding: 15px;
-      background-color: #fff;
-      margin: 15px 0;
-      border: 3px solid #eaeaea;
-
-     .party-name {
-       margin-top: 0px;
-       margin-bottom: 20px;
-       a {
-         text-decoration: none !important;
-         font-weight: 400;
-       }
-     }
-     .party-description {
-       font-weight: 300;
-       padding-left: 18px;
-       font-size: 14px;
-     }
-    }
+  [ui-sref] {
+    cursor: pointer;
   }
 }
-
-@import "../partyAdd/partyAdd.less";
-@import "../partiesMap/partiesMap.less";
-@import "../partyCreator/partyCreator.less";
-@import "../partyRsvp/partyRsvp.less";
-@import "../partyRsvpsList/partyRsvpsList.less";
-- 
2.7.4


From be2623ff0ce35c34a04b558e594c92af243fcdf1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:46:45 +0200
Subject: [PATCH 260/376] Step 18.11: Refactor PartiesMap

---
 imports/ui/components/partiesMap/partiesMap.html | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/imports/ui/components/partiesMap/partiesMap.html b/imports/ui/components/partiesMap/partiesMap.html
index 870b2f7..a488738 100644
--- a/imports/ui/components/partiesMap/partiesMap.html
+++ b/imports/ui/components/partiesMap/partiesMap.html
@@ -1,6 +1,3 @@
-<h4>
-  See all the parties:
-</h4>
 <div class="angular-google-map-container">
   <ui-gmap-google-map center="partiesMap.map.center" zoom="partiesMap.map.zoom">
     <ui-gmap-markers models="partiesMap.parties" coords="'location'" fit="true" idkey="'_id'" doRebuildAll="true"></ui-gmap-markers>
-- 
2.7.4


From 077f9d2489db26ef5c3a761d76856347e7e74aab Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:47:31 +0200
Subject: [PATCH 261/376] Step 18.12: Styles for PartiesMap

---
 imports/ui/components/partiesMap/partiesMap.less | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesMap/partiesMap.less b/imports/ui/components/partiesMap/partiesMap.less
index 020e970..b69b834 100644
--- a/imports/ui/components/partiesMap/partiesMap.less
+++ b/imports/ui/components/partiesMap/partiesMap.less
@@ -1,6 +1,6 @@
 parties-map {
   display: block;
-  margin: 15px 5px;
+  padding: 10px;
 
   .angular-google-map-container {
     width: 100%;
-- 
2.7.4


From 602837babcd1fb7af2e9a2274be668a40d446030 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:13:36 +0200
Subject: [PATCH 262/376] Step 18.13: Import in PartiesList

---
 imports/ui/components/partiesList/partiesList.less | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index ba0839b..d3f7da4 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -3,3 +3,5 @@ parties-list {
     cursor: pointer;
   }
 }
+
+@import "../partiesMap/partiesMap.less";
-- 
2.7.4


From 7c062b45f0d34875883f82c2a8450cdb1591d75c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:48:05 +0200
Subject: [PATCH 263/376] Step 18.14: Refactor PartiesSort

---
 imports/ui/components/partiesSort/partiesSort.html | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)

diff --git a/imports/ui/components/partiesSort/partiesSort.html b/imports/ui/components/partiesSort/partiesSort.html
index b2a52b3..0b7a94e 100644
--- a/imports/ui/components/partiesSort/partiesSort.html
+++ b/imports/ui/components/partiesSort/partiesSort.html
@@ -1,4 +1,10 @@
-<select ng-model="partiesSort.order" ng-change="partiesSort.changed()" class="form-control">
-  <option value="1">Ascending</option>
-  <option value="-1">Descending</option>
-</select>
+<md-input-container>
+  <md-select ng-model="partiesSort.order" ng-change="partiesSort.changed()">
+    <md-option value="1">
+      Ascending
+    </md-option>
+    <md-option value="-1">
+      Descending
+    </md-option>
+  </md-select>
+</md-input-container>
-- 
2.7.4


From d51e9a5d85eb7c6183bf3c27bff7d3ac4a6a4d04 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:48:41 +0200
Subject: [PATCH 264/376] Step 18.15: Refactor PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.html | 26 ++++++++++++++------------
 1 file changed, 14 insertions(+), 12 deletions(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index 7c4d284..6e504f0 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -1,20 +1,22 @@
-<form>
-  <div class="form-group">
+<div layout="column" layout-padding>
+  <md-input-container>
     <label>
       Party Name:
     </label>
-    <input type="text" ng-model="partyAdd.party.name" class="form-control"/>
-  </div>
-  <div class="form-group">
+    <input type="text" ng-model="partyAdd.party.name"/>
+  </md-input-container>
+  <md-input-container>
     <label>
       Description:
     </label>
-    <input type="text" ng-model="partyAdd.party.description" class="form-control"/>
+    <input type="text" ng-model="partyAdd.party.description"/>
+  </md-input-container>
+  <div flex>
+    <md-checkbox ng-model="partyAdd.party.public" aria-label="Public Party?">
+      Public Party?
+    </md-checkbox>
   </div>
-  <div class="checkbox">
-    <label>
-      <input type="checkbox" ng-model="partyAdd.party.public"/> Public Party?
-    </label>
+  <div flex>
+    <md-button ng-click="partyAdd.submit()" class="md-raised">Add Party!</md-button>
   </div>
-  <button ng-click="partyAdd.submit()" class="btn btn-success">Add Party!</button>
-</form>
+</div>
-- 
2.7.4


From 163160c5254194aaa810a9303bd5b51532f5b20a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:49:18 +0200
Subject: [PATCH 265/376] Step 18.16: Remove styles for PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.less | 10 ----------
 1 file changed, 10 deletions(-)
 delete mode 100644 imports/ui/components/partyAdd/partyAdd.less

diff --git a/imports/ui/components/partyAdd/partyAdd.less b/imports/ui/components/partyAdd/partyAdd.less
deleted file mode 100644
index 90b24c1..0000000
--- a/imports/ui/components/partyAdd/partyAdd.less
+++ /dev/null
@@ -1,10 +0,0 @@
-party-add {
-  display: block;
-}
-
-party-add > form {
-  padding: 15px;
-  margin-bottom: 25px;
-  background-color: #fff;
-  border: 3px solid #EAEAEC;
-}
-- 
2.7.4


From 26459a7aeec2bc7f707456b9ad7f3c0385328295 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:50:00 +0200
Subject: [PATCH 266/376] Step 18.17: Refactor PartyCreator

---
 imports/ui/components/partyCreator/partyCreator.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyCreator/partyCreator.html b/imports/ui/components/partyCreator/partyCreator.html
index 077739d..de986fb 100644
--- a/imports/ui/components/partyCreator/partyCreator.html
+++ b/imports/ui/components/partyCreator/partyCreator.html
@@ -1,5 +1,5 @@
 <p>
   <small>
-    <i class="fa fa-user fa-lg"></i> {{ partyCreator.creator | displayNameFilter }}
+    Posted by {{ partyCreator.creator | displayNameFilter }}
   </small>
 </p>
-- 
2.7.4


From c7e1f5a7a3baa035268e024ca59dad2819afb3ae Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 02:50:35 +0200
Subject: [PATCH 267/376] Step 18.18: Remove partyCreator.less

---
 imports/ui/components/partyCreator/partyCreator.less | 6 ------
 1 file changed, 6 deletions(-)
 delete mode 100644 imports/ui/components/partyCreator/partyCreator.less

diff --git a/imports/ui/components/partyCreator/partyCreator.less b/imports/ui/components/partyCreator/partyCreator.less
deleted file mode 100644
index 4679f1f..0000000
--- a/imports/ui/components/partyCreator/partyCreator.less
+++ /dev/null
@@ -1,6 +0,0 @@
-party-creator {
-  i.fa {
-    margin-left: 5px;
-    margin-right: 10px;
-  }
-}
-- 
2.7.4


From a9a96fe8071324176248df31220f04c1a1391fb4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:08:43 +0200
Subject: [PATCH 268/376] Step 18.19: Add `material-design-icons`

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +--
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 4e35175..f249f54 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ tmeasday:publish-counts
 check
 email
 less
+planettraining:material-design-icons
diff --git a/.meteor/versions b/.meteor/versions
index 8c637d3..d943453 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -67,9 +67,9 @@ oauth2@1.1.7
 observe-sequence@1.0.11
 ordered-dict@1.0.7
 pbastowski:angular-babel@1.3.2
+planettraining:material-design-icons@2.2.0
 promise@0.6.7
 random@1.0.9
-reactive-dict@1.1.5
 rate-limit@1.0.2
 reactive-dict@1.1.5
 reactive-var@1.0.9
@@ -77,7 +77,6 @@ reload@1.1.8
 retry@1.0.7
 routepolicy@1.0.10
 sanjo:jasmine@1.0.1
-session@1.1.3
 service-configuration@1.0.7
 session@1.1.3
 sha@1.0.5
-- 
2.7.4


From c1c1b6fc9e5a99203cca458593069173b6a7b6de Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:10:01 +0200
Subject: [PATCH 269/376] Step 18.20: Set icons

---
 imports/ui/components/socially/socially.js | 20 +++++++++++++++++++-
 1 file changed, 19 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index e692001..cad243b 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -29,12 +29,30 @@ export default angular.module(name, [
   .config(config)
   .run(run);
 
-function config($locationProvider, $urlRouterProvider) {
+function config($locationProvider, $urlRouterProvider, $mdIconProvider) {
   'ngInject';
 
   $locationProvider.html5Mode(true);
 
   $urlRouterProvider.otherwise('/parties');
+
+  const iconPath =  '/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/';
+
+  $mdIconProvider
+    .iconSet('social',
+      iconPath + 'svg-sprite-social.svg')
+    .iconSet('action',
+      iconPath + 'svg-sprite-action.svg')
+    .iconSet('communication',
+      iconPath + 'svg-sprite-communication.svg')
+    .iconSet('content',
+      iconPath + 'svg-sprite-content.svg')
+    .iconSet('toggle',
+      iconPath + 'svg-sprite-toggle.svg')
+    .iconSet('navigation',
+      iconPath + 'svg-sprite-navigation.svg')
+    .iconSet('image',
+      iconPath + 'svg-sprite-image.svg');
 }
 
 function run($rootScope, $state) {
-- 
2.7.4


From 52a7e6c119a5459c8db60c917236c54feb19555e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:10:41 +0200
Subject: [PATCH 270/376] Step 18.21: Refactor PartyRemove

---
 imports/ui/components/partyRemove/partyRemove.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyRemove/partyRemove.html b/imports/ui/components/partyRemove/partyRemove.html
index ebe46ea..fc1206c 100644
--- a/imports/ui/components/partyRemove/partyRemove.html
+++ b/imports/ui/components/partyRemove/partyRemove.html
@@ -1 +1 @@
-<button type="button" class="close" aria-label="Close" ng-click="partyRemove.remove()"><span aria-hidden="true">&times;</span></button>
+<md-icon md-svg-icon="content:ic_clear_24px" ng-click="partyRemove.remove()"></md-icon>
-- 
2.7.4


From 2db3c384ff67a7db34d2cd46083db403744e1ff5 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:11:20 +0200
Subject: [PATCH 271/376] Step 18.22: Styles for PartyRemove

---
 imports/ui/components/partyRemove/partyRemove.less | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/partyRemove/partyRemove.less

diff --git a/imports/ui/components/partyRemove/partyRemove.less b/imports/ui/components/partyRemove/partyRemove.less
new file mode 100644
index 0000000..d7ad1f1
--- /dev/null
+++ b/imports/ui/components/partyRemove/partyRemove.less
@@ -0,0 +1,3 @@
+party-remove {
+  float: right;
+}
-- 
2.7.4


From 212a3e703c2d70a606dd27fcafc1478c4d0e65fb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:12:08 +0200
Subject: [PATCH 272/376] Step 18.23: Import to PartiesList

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index d3f7da4..26a3d6b 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -5,3 +5,4 @@ parties-list {
 }
 
 @import "../partiesMap/partiesMap.less";
+@import "../partyRemove/partyRemove.less";
-- 
2.7.4


From 4f3e34c2715881877e7d8d7db662a065a146bf98 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:17:34 +0200
Subject: [PATCH 273/376] Step 18.24: Refactor PartyRsvp

---
 imports/ui/components/partyRsvp/partyRsvp.html | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partyRsvp/partyRsvp.html b/imports/ui/components/partyRsvp/partyRsvp.html
index e4c078c..ec6302b 100644
--- a/imports/ui/components/partyRsvp/partyRsvp.html
+++ b/imports/ui/components/partyRsvp/partyRsvp.html
@@ -1,3 +1,5 @@
-<input type="button" value="I'm going!" ng-click="partyRsvp.yes()" class="btn btn-default" ng-class="{'btn-primary' : partyRsvp.isYes()}"/>
-<input type="button" value="Maybe" ng-click="partyRsvp.maybe()" class="btn btn-default" ng-class="{'btn-primary' : partyRsvp.isMaybe()}"/>
-<input type="button" value="No" ng-click="partyRsvp.no()" class="btn btn-default" ng-class="{'btn-primary' : partyRsvp.isNo()}"/>
+<div layout="row" layout-align="end center">
+  <md-button ng-click="partyRsvp.yes()" ng-class="{'md-primary' : partyRsvp.isYes()}">I'm going!</md-button>
+  <md-button ng-click="partyRsvp.maybe()" ng-class="{'md-primary' : partyRsvp.isMaybe()}">Maybe</md-button>
+  <md-button ng-click="partyRsvp.no()" ng-class="{'md-primary' : partyRsvp.isNo()}">No</md-button>
+</div>
-- 
2.7.4


From 076121453f604e665b59ed627063a5edfb8dcfca Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:18:08 +0200
Subject: [PATCH 274/376] Step 18.25: Remove styles

---
 imports/ui/components/partyRsvp/partyRsvp.less | 4 ----
 1 file changed, 4 deletions(-)
 delete mode 100644 imports/ui/components/partyRsvp/partyRsvp.less

diff --git a/imports/ui/components/partyRsvp/partyRsvp.less b/imports/ui/components/partyRsvp/partyRsvp.less
deleted file mode 100644
index be52d51..0000000
--- a/imports/ui/components/partyRsvp/partyRsvp.less
+++ /dev/null
@@ -1,4 +0,0 @@
-party-rsvp {
-  display: block;
-  margin: 15px 0;
-}
-- 
2.7.4


From 0115b0ff19d078e68d953420be339b94f3289316 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:19:01 +0200
Subject: [PATCH 275/376] Step 18.26: Refactor PartyUninvited

---
 .../components/partyUninvited/partyUninvited.html  | 22 ++++++++++++----------
 1 file changed, 12 insertions(+), 10 deletions(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index e9f9e1c..84b3eaf 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -1,10 +1,12 @@
-<h4>Users to invite:</h4>
-<ul>
-  <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
-    <button ng-click="partyUninvited.invite(user)" class="btn btn-primary-outline">Invite</button>
-    {{ user | displayNameFilter }}
-  </li>
-</ul>
-<div class="alert alert-success" role="alert" ng-if="(partyUninvited.users | uninvitedFilter:partyUninvited.party).length <= 0">
-  Everyone are already invited.
-</div>
+<h4 class="md-headline">
+  Users to invite:
+</h4>
+
+<md-list>
+  <md-list-item ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party" ng-click="partyUninvited.invite(user)">
+    <p>{{ user | displayNameFilter }}</p>
+  </md-list-item>
+  <md-list-item ng-if="(partyUninvited.users | uninvitedFilter:partyUninvited.party).length <= 0">
+    Everyone are already invited.
+  </md-list-item>
+</md-list>
-- 
2.7.4


From 359da019e61152cce736dadf5d9961388158256c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:19:24 +0200
Subject: [PATCH 276/376] Step 18.27: Remove unused styles

---
 imports/ui/components/partyUninvited/partyUninvited.less | 8 --------
 1 file changed, 8 deletions(-)
 delete mode 100644 imports/ui/components/partyUninvited/partyUninvited.less

diff --git a/imports/ui/components/partyUninvited/partyUninvited.less b/imports/ui/components/partyUninvited/partyUninvited.less
deleted file mode 100644
index 52b27fe..0000000
--- a/imports/ui/components/partyUninvited/partyUninvited.less
+++ /dev/null
@@ -1,8 +0,0 @@
-party-uninvited {
-  display: block;
-
-  ul {
-    padding-left: 0;
-    list-style-type: none;
-  }
-}
-- 
2.7.4


From 280eca20b597517c86a27959cd9b9d680ee6cfde Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:20:28 +0200
Subject: [PATCH 277/376] Step 18.28: Add PartyRsvpsList less to PartiesList

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index 26a3d6b..6ac87dc 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -6,3 +6,4 @@ parties-list {
 
 @import "../partiesMap/partiesMap.less";
 @import "../partyRemove/partyRemove.less";
+@import "../partyRsvpsList/partyRsvpsList.less";
-- 
2.7.4


From dbb69b83b0e9e1d4c934bacf59ad5188e130f356 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:21:23 +0200
Subject: [PATCH 278/376] Step 18.29: Update styles of PartyMap

---
 imports/ui/components/partyMap/partyMap.less | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/imports/ui/components/partyMap/partyMap.less b/imports/ui/components/partyMap/partyMap.less
index 3b4bed1..62f1643 100644
--- a/imports/ui/components/partyMap/partyMap.less
+++ b/imports/ui/components/partyMap/partyMap.less
@@ -1,7 +1,6 @@
 party-map {
   display: block;
-  width: 100%;
-  margin: 25px 0;
+  padding: 10px;
 
   .angular-google-map-container {
     width: 100%;
-- 
2.7.4


From 23d03060fc01063a8ac2296b6b0523d7765fa29c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:23:22 +0200
Subject: [PATCH 279/376] Step 18.30: Refactor PartyDetails

---
 .../ui/components/partyDetails/partyDetails.html   | 51 ++++++++++------------
 1 file changed, 22 insertions(+), 29 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 4023174..59fe896 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -1,35 +1,28 @@
-<div class="container-fluid">
-  <div class="row">
-    <div class="col-md-6">
-      <form>
-        <fieldset class="form-group">
-          <label>Party name</label>
-          <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn" class="form-control"/>
-        </fieldset>
+<div layout="column" layout-padding>
+  <div layout="column" layout-gt-sm="row"  layout-padding>
+    <form flex="50" layout="column">
+      <md-input-container>
+        <label>Party name</label>
+        <input ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn">
+      </md-input-container>
 
-        <fieldset class="form-group">
-          <label>Description</label>
-          <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn" class="form-control"/>
-        </fieldset>
+      <md-input-container>
+        <label>Description</label>
+        <input ng-model="partyDetails.party.description" ng-disabled="!partyDetails.isLoggedIn">
+      </md-input-container>
 
-        <div class="checkbox">
-          <label>
-            <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="!partyDetails.isLoggedIn"/>
-            Public Party?
-          </label>
-        </div>
+      <div>
+        <md-checkbox ng-model="partyDetails.party.public" ng-disabled="!partyDetails.isLoggedIn" aria-label="Public Party?">
+          Public Party?
+        </md-checkbox>
+      </div>
 
-        <button ng-click="partyDetails.save()" type="submit" class="btn btn-primary">Save</button>
-      </form>
-    </div>
-    <div class="col-md-6">
-      <party-map location="partyDetails.party.location"></party-map>
-    </div>
+      <div>
+        <md-button ng-click="partyDetails.save()" class="md-primary md-raised">Save</md-button>
+      </div>
+    </form>
+    <party-map flex="50" location="partyDetails.party.location"></party-map>
   </div>
 
-  <div class="row">
-    <div class="col-md-6">
-      <party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
-    </div>
-  </div>
+  <party-uninvited flex party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
 </div>
-- 
2.7.4


From cfd6a211bc174cd646d8e18497e339ebcbd2b113 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:24:01 +0200
Subject: [PATCH 280/376] Step 18.31: Leave only PartyMap inside PartyDetails
 less

---
 imports/ui/components/partyDetails/partyDetails.less | 9 ---------
 1 file changed, 9 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.less b/imports/ui/components/partyDetails/partyDetails.less
index a42c467..bb42a69 100644
--- a/imports/ui/components/partyDetails/partyDetails.less
+++ b/imports/ui/components/partyDetails/partyDetails.less
@@ -1,10 +1 @@
-party-details {
-  display: block;
-
-  form {
-    margin: 25px 0;
-  }
-}
-
-@import "../partyUninvited/partyUninvited.less";
 @import "../partyMap/partyMap.less";
-- 
2.7.4


From 9f29ce3f6a590d7826cedd709684361956ca25f9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:43:44 +0200
Subject: [PATCH 281/376] Step 18.32: Create view for PartyAddButton

---
 imports/ui/components/partyAddButton/partyAddButton.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/partyAddButton/partyAddButton.html

diff --git a/imports/ui/components/partyAddButton/partyAddButton.html b/imports/ui/components/partyAddButton/partyAddButton.html
new file mode 100644
index 0000000..6e37857
--- /dev/null
+++ b/imports/ui/components/partyAddButton/partyAddButton.html
@@ -0,0 +1,3 @@
+<md-button class="md-fab" aria-label="Add new party" ng-click="partyAddButton.open($event)">
+  <md-icon md-svg-icon="content:ic_add_24px"></md-icon>
+</md-button>
-- 
2.7.4


From 7f6685c01d1bfde1a52892bf4f260dc01dd2eec6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:45:15 +0200
Subject: [PATCH 282/376] Step 18.33: Create PartyAddButton component

---
 .../ui/components/partyAddButton/partyAddButton.js | 45 ++++++++++++++++++++++
 1 file changed, 45 insertions(+)
 create mode 100644 imports/ui/components/partyAddButton/partyAddButton.js

diff --git a/imports/ui/components/partyAddButton/partyAddButton.js b/imports/ui/components/partyAddButton/partyAddButton.js
new file mode 100644
index 0000000..cadd70c
--- /dev/null
+++ b/imports/ui/components/partyAddButton/partyAddButton.js
@@ -0,0 +1,45 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import buttonTemplate from './partyAddButton.html';
+import modalTemplate from './partyAddModal.html';
+import { name as PartyAdd } from '../partyAdd/partyAdd';
+
+class PartyAddButton {
+  constructor($mdDialog, $mdMedia) {
+    'ngInject';
+
+    this.$mdDialog = $mdDialog;
+    this.$mdMedia = $mdMedia
+  }
+
+  open(event) {
+    this.$mdDialog.show({
+      controller($mdDialog) {
+        'ngInject';
+
+        this.close = () => {
+          $mdDialog.hide();
+        }
+      },
+      controllerAs: 'partyAddModal',
+      template: modalTemplate,
+      targetEvent: event,
+      parent: angular.element(document.body),
+      clickOutsideToClose: true,
+      fullscreen: this.$mdMedia('sm') || this.$mdMedia('xs')
+    });
+  }
+}
+
+const name = 'partyAddButton';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  PartyAdd
+]).component(name, {
+  template: buttonTemplate,
+  controllerAs: name,
+  controller: PartyAddButton
+});
-- 
2.7.4


From 71645011b91bc68934fcc880459c34695816f4f7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:46:03 +0200
Subject: [PATCH 283/376] Step 18.34: Add view for modal window

---
 imports/ui/components/partyAddButton/partyAddModal.html | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
 create mode 100644 imports/ui/components/partyAddButton/partyAddModal.html

diff --git a/imports/ui/components/partyAddButton/partyAddModal.html b/imports/ui/components/partyAddButton/partyAddModal.html
new file mode 100644
index 0000000..3b490ec
--- /dev/null
+++ b/imports/ui/components/partyAddButton/partyAddModal.html
@@ -0,0 +1,16 @@
+<md-dialog aria-label="New party" ng-cloak>
+  <md-toolbar>
+    <div class="md-toolbar-tools">
+      <h2>New party</h2>
+      <span flex></span>
+      <md-button ng-click="partyAddModal.close()">
+        Close
+      </md-button>
+    </div>
+  </md-toolbar>
+  <md-dialog-content>
+    <div class="md-dialog-content">
+      <party-add done="partyAddModal.close()"></party-add>
+    </div>
+  </md-dialog-content>
+</md-dialog>
-- 
2.7.4


From 4caf1205cc9dc7c87d7f836ff5fc0d03606d20ea Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:46:27 +0200
Subject: [PATCH 284/376] Step 18.35: Add some style

---
 imports/ui/components/partyAddButton/partyAddButton.less | 7 +++++++
 1 file changed, 7 insertions(+)
 create mode 100644 imports/ui/components/partyAddButton/partyAddButton.less

diff --git a/imports/ui/components/partyAddButton/partyAddButton.less b/imports/ui/components/partyAddButton/partyAddButton.less
new file mode 100644
index 0000000..73828f6
--- /dev/null
+++ b/imports/ui/components/partyAddButton/partyAddButton.less
@@ -0,0 +1,7 @@
+party-add-button {
+  .md-fab {
+    position: fixed;
+    right: 15px;
+    bottom: 15px;
+  }
+}
-- 
2.7.4


From 683f7cdeff44a1197732d4075338d30d858f12c1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:47:55 +0200
Subject: [PATCH 285/376] Step 18.36: Implement `done` expression to PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index 4c9052a..ddef484 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -14,6 +14,11 @@ class PartyAdd {
   submit() {
     this.party.owner = Meteor.user()._id;
     Parties.insert(this.party);
+
+    if(this.done) {
+      this.done();
+    }
+
     this.reset();
   }
 
@@ -29,6 +34,9 @@ export default angular.module(name, [
   angularMeteor
 ]).component(name, {
   template,
+  bindings: {
+    done: '&?'
+  },
   controllerAs: name,
   controller: PartyAdd
 });
-- 
2.7.4


From b9b0ad25a6c7312cc3066c9b8bd111bff4f7197b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:48:44 +0200
Subject: [PATCH 286/376] Step 18.37: Add PartyAddButton to PartiesList

---
 imports/ui/components/partiesList/partiesList.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index ec99584..17996c3 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -9,7 +9,7 @@ import template from './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartiesMap } from '../partiesMap/partiesMap';
-import { name as PartyAdd } from '../partyAdd/partyAdd';
+import { name as PartyAddButton } from '../partyAddButton/partyAddButton';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
@@ -77,7 +77,7 @@ export default angular.module(name, [
   utilsPagination,
   PartiesSort,
   PartiesMap,
-  PartyAdd,
+  PartyAddButton,
   PartyRemove,
   PartyCreator,
   PartyRsvp,
-- 
2.7.4


From cd55b6ccbfc9797f4d4b4bcc7f5891604156c218 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:51:45 +0200
Subject: [PATCH 287/376] Step 18.38: Implement PartyAddButton

---
 imports/ui/components/partiesList/partiesList.html | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index b6772eb..12987b3 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,8 +1,5 @@
 <div layout="column" layout-padding>
-  <party-add ng-show="partiesList.isLoggedIn"></party-add>
-  <div ng-hide="partiesList.isLoggedIn">
-    <i>Log in to create a party!</i>
-  </div>
+  <party-add-button ng-show="partiesList.isLoggedIn"></party-add-button>
 
   <div flex>
     <h2 class="md-display-1">List of the parties:</h2>
-- 
2.7.4


From 7acb77c8b610794bf89feeef92e66491406f1a73 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 11:51:59 +0200
Subject: [PATCH 288/376] Step 18.39: Import styles

---
 imports/ui/components/partiesList/partiesList.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index 6ac87dc..b0bc5dc 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -6,4 +6,5 @@ parties-list {
 
 @import "../partiesMap/partiesMap.less";
 @import "../partyRemove/partyRemove.less";
+@import "../partyAddButton/partyAddButton.less";
 @import "../partyRsvpsList/partyRsvpsList.less";
-- 
2.7.4


From 5d0e6193ad64a4184312d215570e91e613e0cbd0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:25:09 +0200
Subject: [PATCH 289/376] Step 18.40: Create view for Auth

---
 imports/ui/components/auth/auth.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/auth/auth.html

diff --git a/imports/ui/components/auth/auth.html b/imports/ui/components/auth/auth.html
new file mode 100644
index 0000000..28f7a45
--- /dev/null
+++ b/imports/ui/components/auth/auth.html
@@ -0,0 +1,6 @@
+<div layout="row">
+  <md-button flex ui-sref="login" ng-hide="auth.isLoggedIn">Login</md-button>
+  <md-button flex ui-sref="register" ng-hide="auth.isLoggedIn">Sign up</md-button>
+  <md-button flex ng-click="auth.logout()" ng-show="auth.isLoggedIn">Logout</md-button>
+  <div ng-show="auth.isLoggedIn">{{ auth.currentUser | displayNameFilter }}</div>
+</div>
-- 
2.7.4


From 87bf57134dc740178033ceaef714fefd03417646 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:25:49 +0200
Subject: [PATCH 290/376] Step 18.41: Create Auth component

---
 imports/ui/components/auth/auth.js | 41 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 41 insertions(+)
 create mode 100644 imports/ui/components/auth/auth.js

diff --git a/imports/ui/components/auth/auth.js b/imports/ui/components/auth/auth.js
new file mode 100644
index 0000000..faffdb3
--- /dev/null
+++ b/imports/ui/components/auth/auth.js
@@ -0,0 +1,41 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+import { Accounts } from 'meteor/accounts-base';
+
+import template from './auth.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+const name = 'auth';
+
+class Auth {
+  constructor($scope, $reactive) {
+    'ngInject';
+
+    $reactive(this).attach($scope);
+
+    this.helpers({
+      isLoggedIn() {
+        return !!Meteor.userId();
+      },
+      currentUser() {
+        return Meteor.user();
+      }
+    });
+  }
+
+  logout() {
+    Accounts.logout();
+  }
+}
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  template,
+  controllerAs: name,
+  controller: Auth
+});
-- 
2.7.4


From c741efeee99a814efb31d34b8bcbea3e887ba584 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:42:53 +0200
Subject: [PATCH 291/376] Step 18.42: View for Login

---
 imports/ui/components/login/login.html | 72 ++++++++++++++++++++++++++++++++++
 1 file changed, 72 insertions(+)
 create mode 100644 imports/ui/components/login/login.html

diff --git a/imports/ui/components/login/login.html b/imports/ui/components/login/login.html
new file mode 100644
index 0000000..64ea544
--- /dev/null
+++ b/imports/ui/components/login/login.html
@@ -0,0 +1,72 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1">
+          Sign in
+        </h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">
+          Use existing account</p>
+      </div>
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_google_24px" style="color: #DC4A38;"></md-icon>
+          <span>
+            Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_facebook_24px" style="color: #3F62B4;"></md-icon>
+          <span>Facebook
+          </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_twitter_24px" style="color: #27AAE2;"></md-icon>
+          <span>Twitter
+          </span>
+        </md-button>
+      </div>
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">
+          Sign in with your email</p>
+      </div>
+
+      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label>
+            Email
+          </label>
+          <input type="text" ng-model="login.credentials.email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container>
+          <label>
+            Password
+          </label>
+          <input type="password" ng-model="login.credentials.password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="space-between center">
+          <a class="md-button" href="/password">Forgot password?</a>
+          <md-button class="md-raised md-primary" ng-click="login.login()" aria-label="login" ng-disabled="login.loginForm.$invalid()">Sign In
+          </md-button>
+        </div>
+      </form>
+      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ login.error }}</p>
+      </md-toolbar>
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/register">Need an account?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
-- 
2.7.4


From f346fa26b2d867f7f24af73615a74ad2ea7d281e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:44:02 +0200
Subject: [PATCH 292/376] Step 18.43: Create Login

---
 imports/ui/components/login/login.js | 61 ++++++++++++++++++++++++++++++++++++
 1 file changed, 61 insertions(+)
 create mode 100644 imports/ui/components/login/login.js

diff --git a/imports/ui/components/login/login.js b/imports/ui/components/login/login.js
new file mode 100644
index 0000000..4ae9c9e
--- /dev/null
+++ b/imports/ui/components/login/login.js
@@ -0,0 +1,61 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './login.html';
+
+import { name as Register } from '../register/register';
+
+class Login {
+  constructor($scope, $reactive, $state) {
+    'ngInject';
+
+    this.$state = $state;
+
+    $reactive(this).attach($scope);
+
+    this.credentials = {
+      email: '',
+      password: ''
+    };
+
+    this.error = '';
+  }
+
+  login() {
+    Meteor.loginWithPassword(this.credentials.email, this.credentials.password,
+      this.$bindToContext((err) => {
+        if (err) {
+          this.error = err;
+        } else {
+          this.$state.go('parties');
+        }
+      })
+    );
+  }
+}
+
+const name = 'login';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  uiRouter
+])
+  .component(name, {
+    template,
+    controllerAs: name,
+    controller: Login
+  })
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+
+  $stateProvider.state('login', {
+    url: '/login',
+    template: '<login></login>'
+  });
+}
-- 
2.7.4


From f933c34d39f2b91d6fec9cf5dd9b1fde7e32eb98 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:44:39 +0200
Subject: [PATCH 293/376] Step 18.44: Add Login to Auth

---
 imports/ui/components/auth/auth.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/auth/auth.js b/imports/ui/components/auth/auth.js
index faffdb3..e3290b8 100644
--- a/imports/ui/components/auth/auth.js
+++ b/imports/ui/components/auth/auth.js
@@ -6,6 +6,7 @@ import { Accounts } from 'meteor/accounts-base';
 
 import template from './auth.html';
 import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+import { name as Login } from '../login/login';
 
 const name = 'auth';
 
@@ -33,7 +34,8 @@ class Auth {
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  DisplayNameFilter
+  DisplayNameFilter,
+  Login
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 9f202b5f91ce054c7b1111efed5d05d68f6ca088 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:45:38 +0200
Subject: [PATCH 294/376] Step 18.45: View for Register

---
 imports/ui/components/register/register.html | 72 ++++++++++++++++++++++++++++
 1 file changed, 72 insertions(+)
 create mode 100644 imports/ui/components/register/register.html

diff --git a/imports/ui/components/register/register.html b/imports/ui/components/register/register.html
new file mode 100644
index 0000000..37b42c6
--- /dev/null
+++ b/imports/ui/components/register/register.html
@@ -0,0 +1,72 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1">
+          Register a new account</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Use your email?</p>
+      </div>
+
+      <form name="registerForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container >
+          <label>
+            Email
+          </label>
+          <input type="text" ng-model="register.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container >
+          <label>
+            Password
+          </label>
+          <input type="password" ng-model="register.credentials.password" placeholder="password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="register.register()" aria-label="login" ng-disabled="register.registerForm.$invalid()">Register</md-button>
+        </div>
+      </form>
+
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">
+          Want to use an existing account?
+        </p>
+      </div>
+
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_google_24px" style="color: #DC4A38;"></md-icon>
+          <span>
+            Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_facebook_24px" style="color: #3F62B4;"></md-icon>
+          <span>Facebook
+          </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_twitter_24px" style="color: #27AAE2;"></md-icon>
+          <span>Twitter
+          </span>
+        </md-button>
+      </div>
+      <md-toolbar ng-show="register.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ register.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Already a user?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
-- 
2.7.4


From eeb5a70d2d3f18bee327a786a973f9694b4fc7da Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:46:15 +0200
Subject: [PATCH 295/376] Step 18.46: Create Register

---
 imports/ui/components/register/register.js | 58 ++++++++++++++++++++++++++++++
 1 file changed, 58 insertions(+)
 create mode 100644 imports/ui/components/register/register.js

diff --git a/imports/ui/components/register/register.js b/imports/ui/components/register/register.js
new file mode 100644
index 0000000..ab4ae94
--- /dev/null
+++ b/imports/ui/components/register/register.js
@@ -0,0 +1,58 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
+
+import { Accounts } from 'meteor/accounts-base';
+
+import template from './register.html';
+
+class Register {
+  constructor($scope, $reactive, $state) {
+    'ngInject';
+
+    this.$state = $state;
+
+    $reactive(this).attach($scope);
+
+    this.credentials = {
+      email: '',
+      password: ''
+    };
+
+    this.error = '';
+  }
+
+  register() {
+    Accounts.createUser(this.credentials,
+      this.$bindToContext((err) => {
+        if (err) {
+          this.error = err;
+        } else {
+          this.$state.go('parties');
+        }
+      })
+    );
+  }
+}
+
+const name = 'register';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  uiRouter
+])
+  .component(name, {
+    template,
+    controllerAs: name,
+    controller: Register
+  })
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+  $stateProvider.state('register', {
+    url: '/register',
+    template: '<register></register>'
+  });
+}
-- 
2.7.4


From a8248fcb2356284ab1422da9fe6a68baa110b2d8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:46:55 +0200
Subject: [PATCH 296/376] Step 18.47: Add Register to Auth

---
 imports/ui/components/auth/auth.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/auth/auth.js b/imports/ui/components/auth/auth.js
index e3290b8..871e2fd 100644
--- a/imports/ui/components/auth/auth.js
+++ b/imports/ui/components/auth/auth.js
@@ -7,6 +7,7 @@ import { Accounts } from 'meteor/accounts-base';
 import template from './auth.html';
 import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
 import { name as Login } from '../login/login';
+import { name as Register } from '../register/register';
 
 const name = 'auth';
 
@@ -35,7 +36,8 @@ class Auth {
 export default angular.module(name, [
   angularMeteor,
   DisplayNameFilter,
-  Login
+  Login,
+  Register
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From bb2ec6593daea4c584f5b35265491933acea5d37 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:47:29 +0200
Subject: [PATCH 297/376] Step 18.48: View for Password

---
 imports/ui/components/password/password.html | 40 ++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)
 create mode 100644 imports/ui/components/password/password.html

diff --git a/imports/ui/components/password/password.html b/imports/ui/components/password/password.html
new file mode 100644
index 0000000..94df2b0
--- /dev/null
+++ b/imports/ui/components/password/password.html
@@ -0,0 +1,40 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Reset Password</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Enter your email so we can send you a reset link</p>
+      </div>
+
+      <form name="resetForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="password.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="password.reset()" aria-label="reset"
+                     ng-disabled="password.resetForm.$invalid()">Send Email
+          </md-button>
+        </div>
+      </form>
+
+      <md-toolbar ng-show="password.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ password.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Sign in</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
-- 
2.7.4


From e3107782c3951083073fa7dbdad5ed290d4042f8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:48:03 +0200
Subject: [PATCH 298/376] Step 18.49: Create Password

---
 imports/ui/components/password/password.js | 56 ++++++++++++++++++++++++++++++
 1 file changed, 56 insertions(+)
 create mode 100644 imports/ui/components/password/password.js

diff --git a/imports/ui/components/password/password.js b/imports/ui/components/password/password.js
new file mode 100644
index 0000000..c417f95
--- /dev/null
+++ b/imports/ui/components/password/password.js
@@ -0,0 +1,56 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
+
+import { Accounts } from 'meteor/accounts-base';
+
+import template from './password.html';
+
+class Register {
+  constructor($scope, $reactive, $state) {
+    'ngInject';
+
+    this.$state = $state;
+
+    $reactive(this).attach($scope);
+
+    this.credentials = {
+      email: ''
+    };
+
+    this.error = '';
+  }
+
+  reset() {
+    Accounts.forgotPassword(this.credentials, this.$bindToContext((err) => {
+      if (err) {
+        this.error = err;
+      } else {
+        this.$state.go('parties');
+      }
+    }));
+  }
+}
+
+const name = 'password';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  uiRouter
+])
+  .component(name, {
+    template,
+    controllerAs: name,
+    controller: Register
+  })
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+
+  $stateProvider.state('password', {
+    url: '/password',
+    template: '<password></password>'
+  });
+}
-- 
2.7.4


From 750851220ca7aa478e18ab26ec54d555ee067e53 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:48:33 +0200
Subject: [PATCH 299/376] Step 18.50: Add Password to Auth

---
 imports/ui/components/auth/auth.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/auth/auth.js b/imports/ui/components/auth/auth.js
index 871e2fd..a87dd5e 100644
--- a/imports/ui/components/auth/auth.js
+++ b/imports/ui/components/auth/auth.js
@@ -8,6 +8,7 @@ import template from './auth.html';
 import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
 import { name as Login } from '../login/login';
 import { name as Register } from '../register/register';
+import { name as Password } from '../password/password';
 
 const name = 'auth';
 
@@ -37,7 +38,8 @@ export default angular.module(name, [
   angularMeteor,
   DisplayNameFilter,
   Login,
-  Register
+  Register,
+  Password
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 4d435863a5c297d8fc26b74c9d3bbc2d4b5e2412 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:50:12 +0200
Subject: [PATCH 300/376] Step 18.51: Add Auth to Socially

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index cad243b..21940eb 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -7,6 +7,7 @@ import template from './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
 import { name as PartyDetails } from '../partyDetails/partyDetails';
 import { name as Navigation } from '../navigation/navigation';
+import { name as Auth } from '../auth/auth';
 
 class Socially {}
 
@@ -20,6 +21,7 @@ export default angular.module(name, [
   PartiesList,
   PartyDetails,
   Navigation,
+  Auth,
   'accounts.ui'
 ]).component(name, {
   template,
-- 
2.7.4


From 99c587d7467b1243f4998b876fbba9cd58012164 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:50:46 +0200
Subject: [PATCH 301/376] Step 18.52: Implement Auth

---
 imports/ui/components/navigation/navigation.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/navigation/navigation.html b/imports/ui/components/navigation/navigation.html
index 0b1d8a6..2d81bc4 100644
--- a/imports/ui/components/navigation/navigation.html
+++ b/imports/ui/components/navigation/navigation.html
@@ -5,6 +5,7 @@
         Socially
       </span>
     </h2>
-    <login-buttons></login-buttons>
+    <span flex></span>
+    <auth></auth>
   </div>
 </md-toolbar>
-- 
2.7.4


From 7825ebbaa2fb78d95788d7259742bacc795035d9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:51:45 +0200
Subject: [PATCH 302/376] Step 18.53: Remove .less of Navigation

---
 imports/ui/components/navigation/navigation.less | 5 -----
 1 file changed, 5 deletions(-)
 delete mode 100644 imports/ui/components/navigation/navigation.less

diff --git a/imports/ui/components/navigation/navigation.less b/imports/ui/components/navigation/navigation.less
deleted file mode 100644
index 87b8777..0000000
--- a/imports/ui/components/navigation/navigation.less
+++ /dev/null
@@ -1,5 +0,0 @@
-navigation {
-  login-buttons {
-    margin-left: 15px;
-  }
-}
-- 
2.7.4


From 7f28ec452148389c72d1704ffc1914deca1996a9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 03:52:12 +0200
Subject: [PATCH 303/376] Step 18.54: Remove import statement

---
 imports/ui/components/socially/socially.less | 2 --
 1 file changed, 2 deletions(-)

diff --git a/imports/ui/components/socially/socially.less b/imports/ui/components/socially/socially.less
index 3eabc12..742f92d 100644
--- a/imports/ui/components/socially/socially.less
+++ b/imports/ui/components/socially/socially.less
@@ -2,7 +2,5 @@ socially {
   display: block;
 }
 
-
-@import "../navigation/navigation.less";
 @import "../partiesList/partiesList.less";
 @import "../partyDetails/partyDetails.less";
-- 
2.7.4


From ef98fe529980b284568ed5543fdc8829caef1197 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:38:56 +0200
Subject: [PATCH 304/376] Step 20.1: Add `jalik:ufs`

---
 .meteor/packages | 1 +
 .meteor/versions | 2 ++
 2 files changed, 3 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index f249f54..3fd16fb 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -29,3 +29,4 @@ check
 email
 less
 planettraining:material-design-icons
+jalik:ufs
diff --git a/.meteor/versions b/.meteor/versions
index d943453..ab0ed70 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -42,12 +42,14 @@ html-tools@1.0.9
 htmljs@1.0.9
 http@1.1.5
 id-map@1.0.7
+jalik:ufs@0.5.3
 jquery@1.11.8
 launch-screen@1.0.11
 less@2.5.6
 livedata@1.0.18
 localstorage@1.0.7
 logging@1.0.12
+matb33:collection-hooks@0.7.15
 meteor@1.1.14
 meteor-base@1.0.4
 minifier-css@1.1.11
-- 
2.7.4


From 33a6719b669c74d4a8aa49b8711bf585e60b3c94 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:40:52 +0200
Subject: [PATCH 305/376] Step 20.2: Add `jalik:ufs-gridfs`

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 3fd16fb..ff02119 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -30,3 +30,4 @@ email
 less
 planettraining:material-design-icons
 jalik:ufs
+jalik:ufs-gridfs
diff --git a/.meteor/versions b/.meteor/versions
index ab0ed70..8d115df 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -43,6 +43,7 @@ htmljs@1.0.9
 http@1.1.5
 id-map@1.0.7
 jalik:ufs@0.5.3
+jalik:ufs-gridfs@0.1.1
 jquery@1.11.8
 launch-screen@1.0.11
 less@2.5.6
-- 
2.7.4


From bc4977a7b5a00720508e8a5790203cf9896cd75a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:48:58 +0200
Subject: [PATCH 306/376] Step 20.3: Create Images and Thumbs collections

---
 imports/api/images/collection.js | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 imports/api/images/collection.js

diff --git a/imports/api/images/collection.js b/imports/api/images/collection.js
new file mode 100644
index 0000000..a522111
--- /dev/null
+++ b/imports/api/images/collection.js
@@ -0,0 +1,21 @@
+import { Meteor } from 'meteor/meteor';
+import { Mongo } from 'meteor/mongo';
+
+export const Images = new Mongo.Collection('images');
+export const Thumbs = new Mongo.Collection('thumbs');
+
+function loggedIn(userId) {
+  return !!userId;
+}
+
+Thumbs.allow({
+  insert: loggedIn,
+  update: loggedIn,
+  remove: loggedIn
+});
+
+Images.allow({
+  insert: loggedIn,
+  update: loggedIn,
+  remove: loggedIn
+});
-- 
2.7.4


From 7b2709f1b3c0bf9c7110a8b0fc06f2303fdb4812 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:50:11 +0200
Subject: [PATCH 307/376] Step 20.4: Create ThumbsStore and ImagesStore

---
 imports/api/images/store.js | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 imports/api/images/store.js

diff --git a/imports/api/images/store.js b/imports/api/images/store.js
new file mode 100644
index 0000000..58462c1
--- /dev/null
+++ b/imports/api/images/store.js
@@ -0,0 +1,18 @@
+import { UploadFS } from 'meteor/jalik:ufs';
+import { Images, Thumbs } from './collection';
+
+export const ThumbsStore = new UploadFS.store.GridFS({
+  collection: Thumbs,
+  name: 'thumbs'
+});
+
+export const ImagesStore = new UploadFS.store.GridFS({
+  collection: Images,
+  name: 'images',
+  filter: new UploadFS.Filter({
+    contentTypes: ['image/*']
+  }),
+  copyTo: [
+    ThumbsStore
+  ]
+});
-- 
2.7.4


From 84a91acbdad5b2eb7f6c0081592740c89dd05527 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:50:57 +0200
Subject: [PATCH 308/376] Step 20.5: Create main export file of Images and
 Thumbs

---
 imports/api/images/index.js | 2 ++
 1 file changed, 2 insertions(+)
 create mode 100644 imports/api/images/index.js

diff --git a/imports/api/images/index.js b/imports/api/images/index.js
new file mode 100644
index 0000000..9c18361
--- /dev/null
+++ b/imports/api/images/index.js
@@ -0,0 +1,2 @@
+export * from './collection';
+export * from './store';
-- 
2.7.4


From d5dafd4de84368de6f6102b3f7e329a7b03462dd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:52:30 +0200
Subject: [PATCH 309/376] Step 20.6: Resize images

---
 imports/api/images/store.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/imports/api/images/store.js b/imports/api/images/store.js
index 58462c1..a0fa6d6 100644
--- a/imports/api/images/store.js
+++ b/imports/api/images/store.js
@@ -3,7 +3,19 @@ import { Images, Thumbs } from './collection';
 
 export const ThumbsStore = new UploadFS.store.GridFS({
   collection: Thumbs,
-  name: 'thumbs'
+  name: 'thumbs',
+  transformWrite(from, to, fileId, file) {
+    // Resize to 32x32
+    const gm = require('gm');
+
+    gm(from, file.name)
+      .resize(32, 32)
+      .gravity('Center')
+      .extent(32, 32)
+      .quality(75)
+      .stream()
+      .pipe(to);
+  }
 });
 
 export const ImagesStore = new UploadFS.store.GridFS({
-- 
2.7.4


From b74611aedb054ca28f96e690844abf92c7766a28 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:54:06 +0200
Subject: [PATCH 310/376] Step 20.7: Install `gm`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 8971ed8..459c03c 100644
--- a/package.json
+++ b/package.json
@@ -16,6 +16,7 @@
     "angular-ui-router": "^0.2.18",
     "angular-simple-logger": "^0.1.7",
     "angular-utils-pagination": "^0.11.1",
+    "gm": "^1.22.0",
     "meteor-node-stubs": "~0.2.0",
     "underscore": "^1.8.3"
   },
-- 
2.7.4


From b07511aba46a2a72978daf6a38cdd319d52e08ad Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:58:21 +0200
Subject: [PATCH 311/376] Step 20.8: Create view for PartyUpload

---
 imports/ui/components/partyUpload/partyUpload.html | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 imports/ui/components/partyUpload/partyUpload.html

diff --git a/imports/ui/components/partyUpload/partyUpload.html b/imports/ui/components/partyUpload/partyUpload.html
new file mode 100644
index 0000000..d53d6c7
--- /dev/null
+++ b/imports/ui/components/partyUpload/partyUpload.html
@@ -0,0 +1,9 @@
+<div layout="column">
+  <div>
+      <div>Click here to select image</div>
+      <div>
+        <strong>OR</strong>
+      </div>
+      <div>You can also drop image to here</div>
+  </div>
+</div>
-- 
2.7.4


From ce29ae0e1fcb308e02f2ca1b60caa5b81409f704 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 12:59:42 +0200
Subject: [PATCH 312/376] Step 20.9: Create PartyUpload component

---
 imports/ui/components/partyUpload/partyUpload.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
 create mode 100644 imports/ui/components/partyUpload/partyUpload.js

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
new file mode 100644
index 0000000..571b3c1
--- /dev/null
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -0,0 +1,19 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import template from './partyUpload.html';
+
+class PartyUpload {}
+
+const name = 'partyUpload';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  controllerAs: name,
+  controller: PartyUpload
+});
-- 
2.7.4


From 28b82cc597786f06269308fd2cb6e0a64b88c67b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:01:32 +0200
Subject: [PATCH 313/376] Step 20.10: Add to PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index ddef484..47f09fe 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -5,6 +5,7 @@ import { Meteor } from 'meteor/meteor';
 
 import template from './partyAdd.html';
 import { Parties } from '../../../api/parties';
+import { name as PartyUpload } from '../partyUpload/partyUpload';
 
 class PartyAdd {
   constructor() {
@@ -31,7 +32,8 @@ const name = 'partyAdd';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  PartyUpload
 ]).component(name, {
   template,
   bindings: {
-- 
2.7.4


From 1ffa747836d29c02923f76c8610258c1d702f15c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:03:51 +0200
Subject: [PATCH 314/376] Step 20.11: Implement to the view

---
 imports/ui/components/partyAdd/partyAdd.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index 6e504f0..8946e6d 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -19,4 +19,5 @@
   <div flex>
     <md-button ng-click="partyAdd.submit()" class="md-raised">Add Party!</md-button>
   </div>
+  <party-upload files="partyAdd.party.images"></party-upload>
 </div>
-- 
2.7.4


From 79b2c6712ed02d5917751180201a8a7a29f69abc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:05:32 +0200
Subject: [PATCH 315/376] Step 20.12: install `ng-file-upload`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 459c03c..0484324 100644
--- a/package.json
+++ b/package.json
@@ -18,6 +18,7 @@
     "angular-utils-pagination": "^0.11.1",
     "gm": "^1.22.0",
     "meteor-node-stubs": "~0.2.0",
+    "ng-file-upload": "^12.0.4",
     "underscore": "^1.8.3"
   },
   "devDependencies": {
-- 
2.7.4


From 84cf68011182842d6c3ed6a45eede7e456b18c16 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:08:06 +0200
Subject: [PATCH 316/376] Step 20.13: Add as a dependency

---
 imports/ui/components/partyUpload/partyUpload.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index 571b3c1..d4b7c6e 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import ngFileUpload from 'ng-file-upload';
 
 import { Meteor } from 'meteor/meteor';
 
@@ -11,7 +12,8 @@ const name = 'partyUpload';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  ngFileUpload
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From a49cbbf6f397881ac8085e2720c11b08651e4d5e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:09:13 +0200
Subject: [PATCH 317/376] Step 20.14: Add ngf-drop to the view

---
 imports/ui/components/partyUpload/partyUpload.html | 21 +++++++++++++++------
 1 file changed, 15 insertions(+), 6 deletions(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.html b/imports/ui/components/partyUpload/partyUpload.html
index d53d6c7..70e5af3 100644
--- a/imports/ui/components/partyUpload/partyUpload.html
+++ b/imports/ui/components/partyUpload/partyUpload.html
@@ -1,9 +1,18 @@
 <div layout="column">
-  <div>
-      <div>Click here to select image</div>
-      <div>
-        <strong>OR</strong>
-      </div>
-      <div>You can also drop image to here</div>
+  <div ngf-drop
+    ngf-select
+    ngf-change="partyUpload.addImages($files)"
+    ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}"
+    class="drop-box"
+    ngf-multiple="false"
+    ngf-allow-dir="false"
+    ngf-accept="'image/*'"
+    ngf-drop-available="true"
+    ng-hide="partyUpload.cropImgSrc">
+    <div>Click here to select image</div>
+    <div>
+      <strong>OR</strong>
+    </div>
+    <div>You can also drop image to here</div>
   </div>
 </div>
-- 
2.7.4


From bbf475ffd213f079e7a60b64ca710778d35f4387 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:12:52 +0200
Subject: [PATCH 318/376] Step 20.15: Handle file selection

---
 imports/ui/components/partyUpload/partyUpload.js | 25 +++++++++++++++++++++++-
 1 file changed, 24 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index d4b7c6e..7ad01f9 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -6,7 +6,30 @@ import { Meteor } from 'meteor/meteor';
 
 import template from './partyUpload.html';
 
-class PartyUpload {}
+class PartyUpload {
+  constructor($scope, $reactive) {
+    'ngInject';
+
+    $reactive(this).attach($scope);
+  }
+
+  addImages(files) {
+    if (files.length) {
+      this.currentFile = files[0];
+
+      const reader = new FileReader;
+
+      reader.onload = this.$bindToContext((e) => {
+        this.cropImgSrc = e.target.result;
+        this.myCroppedImage = '';
+      });
+
+      reader.readAsDataURL(files[0]);
+    } else {
+      this.cropImgSrc = undefined;
+    }
+  }
+}
 
 const name = 'partyUpload';
 
-- 
2.7.4


From baa09f09b4e1d67f1da0a3921302e90e2c9f3ac0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:15:21 +0200
Subject: [PATCH 319/376] Step 20.16: Add style

---
 imports/ui/components/partyUpload/partyUpload.less | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
 create mode 100644 imports/ui/components/partyUpload/partyUpload.less

diff --git a/imports/ui/components/partyUpload/partyUpload.less b/imports/ui/components/partyUpload/partyUpload.less
new file mode 100644
index 0000000..987a853
--- /dev/null
+++ b/imports/ui/components/partyUpload/partyUpload.less
@@ -0,0 +1,16 @@
+party-upload {
+  .drop-box {
+    background: #F8F8F8;
+    border: 5px dashed #DDD;
+    text-align: center;
+    padding: 25px;
+    margin-left: 10px;
+    margin-bottom: 20px;
+  }
+  .drop-box.dragover {
+    border: 5px dashed blue;
+  }
+  .drop-box.dragover-err {
+    border: 5px dashed red;
+  }
+}
-- 
2.7.4


From 83aa66e043c001febd479097901bc6d90525e896 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:15:42 +0200
Subject: [PATCH 320/376] Step 20.17: Import in PartyAdd

---
 imports/ui/components/partyAdd/partyAdd.less | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/partyAdd/partyAdd.less

diff --git a/imports/ui/components/partyAdd/partyAdd.less b/imports/ui/components/partyAdd/partyAdd.less
new file mode 100644
index 0000000..18bfd78
--- /dev/null
+++ b/imports/ui/components/partyAdd/partyAdd.less
@@ -0,0 +1 @@
+@import "../partyUpload/partyUpload.less";
-- 
2.7.4


From 79234c367b4b918ff2b6bee4abf4c55ba796f356 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:16:18 +0200
Subject: [PATCH 321/376] Step 20.18: Import in PartyAddButton

---
 imports/ui/components/partyAddButton/partyAddButton.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyAddButton/partyAddButton.less b/imports/ui/components/partyAddButton/partyAddButton.less
index 73828f6..1b95052 100644
--- a/imports/ui/components/partyAddButton/partyAddButton.less
+++ b/imports/ui/components/partyAddButton/partyAddButton.less
@@ -5,3 +5,4 @@ party-add-button {
     bottom: 15px;
   }
 }
+@import "../partyAdd/partyAdd.less";
-- 
2.7.4


From b45ecc66da453aa0882254d83b08c104ac5dd1e6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:17:27 +0200
Subject: [PATCH 322/376] Step 20.19: Install `ng-img-crop`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 0484324..1ebcbea 100644
--- a/package.json
+++ b/package.json
@@ -19,6 +19,7 @@
     "gm": "^1.22.0",
     "meteor-node-stubs": "~0.2.0",
     "ng-file-upload": "^12.0.4",
+    "ng-img-crop": "^0.2.0",
     "underscore": "^1.8.3"
   },
   "devDependencies": {
-- 
2.7.4


From e3c4dc0800a393e131ce7f8bf842a5a068784bbb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:27:50 +0200
Subject: [PATCH 323/376] Step 20.20: Add ngImgCrop

---
 imports/ui/components/partyUpload/partyUpload.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index 7ad01f9..94f2de1 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -1,6 +1,9 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import ngFileUpload from 'ng-file-upload';
+import 'ng-img-crop/compile/minified/ng-img-crop';
+import 'ng-img-crop/compile/minified/ng-img-crop.css';
+
 
 import { Meteor } from 'meteor/meteor';
 
@@ -36,7 +39,8 @@ const name = 'partyUpload';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  ngFileUpload
+  ngFileUpload,
+  'ngImgCrop'
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From d03fcef2268a849951e7f9fb4d0e8d614e1e7af1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:31:51 +0200
Subject: [PATCH 324/376] Step 20.21: Use ngImgCrop

---
 imports/ui/components/partyUpload/partyUpload.html | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/imports/ui/components/partyUpload/partyUpload.html b/imports/ui/components/partyUpload/partyUpload.html
index 70e5af3..2dd38e9 100644
--- a/imports/ui/components/partyUpload/partyUpload.html
+++ b/imports/ui/components/partyUpload/partyUpload.html
@@ -15,4 +15,18 @@
     </div>
     <div>You can also drop image to here</div>
   </div>
+  <div ng-show="partyUpload.cropImgSrc" layout="column" class="ng-crop">
+    <div>
+      <h3>Edit &amp; crop</h3>
+      <md-button ng-click="partyUpload.save()" class="md-primary">
+        Save Image
+      </md-button>
+      <md-button ng-click="partyUpload.reset()">
+        Cancel
+      </md-button>
+    </div>
+    <div class="ng-crop-container">
+      <img-crop image="partyUpload.cropImgSrc" result-image="partyUpload.myCroppedImage" area-type="square"></img-crop>
+    </div>
+  </div>
 </div>
-- 
2.7.4


From ed3c8dadc5b753d32ec095e2ba0d65fae870eab7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 13:32:11 +0200
Subject: [PATCH 325/376] Step 20.22: Add styles

---
 imports/ui/components/partyUpload/partyUpload.less | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/imports/ui/components/partyUpload/partyUpload.less b/imports/ui/components/partyUpload/partyUpload.less
index 987a853..645cee2 100644
--- a/imports/ui/components/partyUpload/partyUpload.less
+++ b/imports/ui/components/partyUpload/partyUpload.less
@@ -13,4 +13,13 @@ party-upload {
   .drop-box.dragover-err {
     border: 5px dashed red;
   }
+  .ng-crop {
+    h3 {
+      margin-top: 0;
+    }
+  }
+  .ng-crop-container {
+    width: 400px;
+    height: 225px;
+  }
 }
-- 
2.7.4


From af85d51c1a0dda0ecd6e1d22cd3f7b81bca91995 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:02:41 +0200
Subject: [PATCH 326/376] Step 20.23: Add dataURLToBlob helper

---
 imports/api/images/helpers.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 imports/api/images/helpers.js

diff --git a/imports/api/images/helpers.js b/imports/api/images/helpers.js
new file mode 100644
index 0000000..23f1350
--- /dev/null
+++ b/imports/api/images/helpers.js
@@ -0,0 +1,31 @@
+/**
+ * Converts DataURL to Blob object
+ *
+ * https://github.com/ebidel/filer.js/blob/master/src/filer.js#L137
+ *
+ * @param  {String} dataURL
+ * @return {Blob}
+ */
+export function dataURLToBlob(dataURL) {
+    const BASE64_MARKER = ';base64,';
+
+    if (dataURL.indexOf(BASE64_MARKER) === -1) {
+      const parts = dataURL.split(',');
+      const contentType = parts[0].split(':')[1];
+      const raw = decodeURIComponent(parts[1]);
+
+      return new Blob([raw], {type: contentType});
+    }
+
+    const parts = dataURL.split(BASE64_MARKER);
+    const contentType = parts[0].split(':')[1];
+    const raw = window.atob(parts[1]);
+    const rawLength = raw.length;
+    const uInt8Array = new Uint8Array(rawLength);
+
+    for (let i = 0; i < rawLength; ++i) {
+      uInt8Array[i] = raw.charCodeAt(i);
+    }
+
+    return new Blob([uInt8Array], {type: contentType});
+}
-- 
2.7.4


From f92ebf8b406d6515d597b982855f25a99be00efd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:05:04 +0200
Subject: [PATCH 327/376] Step 20.24: Add blobToArrayBuffer helper

---
 imports/api/images/helpers.js | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)

diff --git a/imports/api/images/helpers.js b/imports/api/images/helpers.js
index 23f1350..448f932 100644
--- a/imports/api/images/helpers.js
+++ b/imports/api/images/helpers.js
@@ -29,3 +29,26 @@ export function dataURLToBlob(dataURL) {
 
     return new Blob([uInt8Array], {type: contentType});
 }
+
+/**
+ * Converts Blob object to ArrayBuffer
+ *
+ * @param  {Blob}       blob          Source file
+ * @param  {Function}   callback      Success callback with converted object as a first argument
+ * @param  {Function}   errorCallback Error callback with error as a first argument
+ */
+export function blobToArrayBuffer(blob, callback, errorCallback) {
+  const reader = new FileReader();
+
+  reader.onload = (e) => {
+    callback(e.target.result);
+  };
+
+  reader.onerror = (e) => {
+    if (errorCallback) {
+      errorCallback(e);
+    }
+  };
+
+  reader.readAsArrayBuffer(blob);
+}
-- 
2.7.4


From 88297a7fe0df76249d05e47d060aabce9d50146a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:08:29 +0200
Subject: [PATCH 328/376] Step 20.25: Create `upload` method

---
 imports/api/images/methods.js | 33 +++++++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)
 create mode 100644 imports/api/images/methods.js

diff --git a/imports/api/images/methods.js b/imports/api/images/methods.js
new file mode 100644
index 0000000..e634901
--- /dev/null
+++ b/imports/api/images/methods.js
@@ -0,0 +1,33 @@
+import { UploadFS } from 'meteor/jalik:ufs';
+import { ImagesStore } from './store';
+import { dataURLToBlob, blobToArrayBuffer } from './helpers';
+
+/**
+ * Uploads a new file
+ *
+ * @param  {String}   dataUrl [description]
+ * @param  {String}   name    [description]
+ * @param  {Function} resolve [description]
+ * @param  {Function} reject  [description]
+ */
+export function upload(dataUrl, name, resolve, reject) {
+  // convert to Blob
+  const blob = dataURLToBlob(dataUrl);
+  blob.name = name;
+
+  // pick from an object only: name, type and size
+  const file = _.pick(blob, 'name', 'type', 'size');
+
+  // convert to ArrayBuffer
+  blobToArrayBuffer(blob, (data) => {
+    const upload = new UploadFS.Uploader({
+      data,
+      file,
+      store: ImagesStore,
+      onError: reject,
+      onComplete: resolve
+    });
+
+    upload.start();
+  }, reject);
+}
-- 
2.7.4


From 08319419ec5b32a095532ff8837943c657d5b192 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:08:56 +0200
Subject: [PATCH 329/376] Step 20.26: Export methods

---
 imports/api/images/index.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/api/images/index.js b/imports/api/images/index.js
index 9c18361..74293fe 100644
--- a/imports/api/images/index.js
+++ b/imports/api/images/index.js
@@ -1,2 +1,3 @@
 export * from './collection';
 export * from './store';
+export * from './methods';
-- 
2.7.4


From 70bd5a52b2e07ea247973d31334d0354f3f74a8a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:15:15 +0200
Subject: [PATCH 330/376] Step 20.27: Implement `save` and `reset` methods

---
 imports/ui/components/partyUpload/partyUpload.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index 94f2de1..7dd2bd1 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -8,12 +8,15 @@ import 'ng-img-crop/compile/minified/ng-img-crop.css';
 import { Meteor } from 'meteor/meteor';
 
 import template from './partyUpload.html';
+import { upload } from '../../../api/images';
 
 class PartyUpload {
   constructor($scope, $reactive) {
     'ngInject';
 
     $reactive(this).attach($scope);
+
+    this.uploaded = [];
   }
 
   addImages(files) {
@@ -32,6 +35,20 @@ class PartyUpload {
       this.cropImgSrc = undefined;
     }
   }
+
+  save() {
+    upload(this.myCroppedImage, this.currentFile.name, this.$bindToContext((file) => {
+      this.uploaded.push(file);
+      this.reset();
+    }), (e) => {
+      console.log('Oops, something went wrong', e);
+    });
+  }
+
+  reset() {
+    this.cropImgSrc = undefined;
+    this.myCroppedImage = '';
+  }
 }
 
 const name = 'partyUpload';
-- 
2.7.4


From 669216aa3934bd6c7fa30d237135c49a29ca92f8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:16:03 +0200
Subject: [PATCH 331/376] Step 20.28: Import Images on server side

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.js b/server/main.js
index 1acdc6c..2b47936 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1,3 +1,4 @@
 import '../imports/startup/fixtures';
 import '../imports/api/parties';
 import '../imports/api/users';
+import '../imports/api/images';
-- 
2.7.4


From 5ff5fd0b6a62629daec19df812167529b6406ca9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:21:33 +0200
Subject: [PATCH 332/376] Step 20.29: Display uploaded images

---
 imports/ui/components/partyUpload/partyUpload.html | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/components/partyUpload/partyUpload.html b/imports/ui/components/partyUpload/partyUpload.html
index 2dd38e9..124bfdb 100644
--- a/imports/ui/components/partyUpload/partyUpload.html
+++ b/imports/ui/components/partyUpload/partyUpload.html
@@ -29,4 +29,9 @@
       <img-crop image="partyUpload.cropImgSrc" result-image="partyUpload.myCroppedImage" area-type="square"></img-crop>
     </div>
   </div>
+  <div layout="row" class="images-container-title">
+    <div class="party-image-container" ng-class="{'main-image': $index === 0}" ng-repeat="thumb in partyUpload.thumbs">
+      <img ng-src="{{ thumb.url }}"/>
+    </div>
+  </div>
 </div>
-- 
2.7.4


From a6ce2e646502bb244c6f89c6894d9aca304f237d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:22:36 +0200
Subject: [PATCH 333/376] Step 20.30: Add styles

---
 imports/ui/components/partyUpload/partyUpload.less | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/imports/ui/components/partyUpload/partyUpload.less b/imports/ui/components/partyUpload/partyUpload.less
index 645cee2..f781c1c 100644
--- a/imports/ui/components/partyUpload/partyUpload.less
+++ b/imports/ui/components/partyUpload/partyUpload.less
@@ -22,4 +22,20 @@ party-upload {
     width: 400px;
     height: 225px;
   }
+  .images-container-title {
+    padding-bottom: 30px;
+  }
+  .party-image-container {
+    position: relative;
+    margin-right: 10px;
+    max-height: 200px;
+    max-width: 200px;
+    img {
+      max-height: 100%;
+      max-width: 100%;
+    }
+  }
+  .main-image {
+    border: 2px solid #ddd;
+  }
 }
-- 
2.7.4


From 41373984541b3974f7401866a66982831667a3d3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:24:09 +0200
Subject: [PATCH 334/376] Step 20.31: Add `thumbs` and `images` publications

---
 imports/api/images/publish.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 imports/api/images/publish.js

diff --git a/imports/api/images/publish.js b/imports/api/images/publish.js
new file mode 100644
index 0000000..5949c72
--- /dev/null
+++ b/imports/api/images/publish.js
@@ -0,0 +1,17 @@
+import { Meteor } from 'meteor/meteor';
+import { Thumbs, Images } from './collection';
+
+if (Meteor.isServer) {
+  Meteor.publish('thumbs', function(ids) {
+    return Thumbs.find({
+      originalStore: 'images',
+      originalId: {
+        $in: ids
+      }
+    });
+  });
+
+  Meteor.publish('images', function() {
+    return Images.find({});
+  });
+}
-- 
2.7.4


From 694b8d9d6a90357f1686a0b7df4c5684129900f2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:24:36 +0200
Subject: [PATCH 335/376] Step 20.32: Import publications

---
 imports/api/images/index.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/api/images/index.js b/imports/api/images/index.js
index 74293fe..57692b3 100644
--- a/imports/api/images/index.js
+++ b/imports/api/images/index.js
@@ -1,3 +1,4 @@
+import './publish';
 export * from './collection';
 export * from './store';
 export * from './methods';
-- 
2.7.4


From 339ed43160e2c5c841d19d90b64096d0430169d4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:29:08 +0200
Subject: [PATCH 336/376] Step 20.33: Implement thumbnails

---
 imports/ui/components/partyUpload/partyUpload.js | 23 ++++++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index 7dd2bd1..100b85a 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -8,7 +8,7 @@ import 'ng-img-crop/compile/minified/ng-img-crop.css';
 import { Meteor } from 'meteor/meteor';
 
 import template from './partyUpload.html';
-import { upload } from '../../../api/images';
+import { Thumbs, upload } from '../../../api/images';
 
 class PartyUpload {
   constructor($scope, $reactive) {
@@ -17,6 +17,21 @@ class PartyUpload {
     $reactive(this).attach($scope);
 
     this.uploaded = [];
+
+    this.subscribe('thumbs', () => [
+      this.getReactively('files', true) || []
+    ]);
+
+    this.helpers({
+      thumbs() {
+        return Thumbs.find({
+          originalStore: 'images',
+          originalId: {
+            $in: this.getReactively('files', true) || []
+          }
+        });
+      }
+    });
   }
 
   addImages(files) {
@@ -39,6 +54,12 @@ class PartyUpload {
   save() {
     upload(this.myCroppedImage, this.currentFile.name, this.$bindToContext((file) => {
       this.uploaded.push(file);
+
+      if (!this.files || !this.files.length) {
+        this.files = [];
+      }
+      this.files.push(file._id);
+
       this.reset();
     }), (e) => {
       console.log('Oops, something went wrong', e);
-- 
2.7.4


From 269d94ed00ed2be4cec8281a8cdedb2084421c6b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:32:41 +0200
Subject: [PATCH 337/376] Step 20.34: Install `angular-sortable-view`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 1ebcbea..ffe3f6d 100644
--- a/package.json
+++ b/package.json
@@ -15,6 +15,7 @@
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
     "angular-simple-logger": "^0.1.7",
+    "angular-sortable-view": "0.0.15",
     "angular-utils-pagination": "^0.11.1",
     "gm": "^1.22.0",
     "meteor-node-stubs": "~0.2.0",
-- 
2.7.4


From b173b3bc5038f3cb6c3dfdf519605b1e194d2b23 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:33:09 +0200
Subject: [PATCH 338/376] Step 20.35: Add as a dependency

---
 imports/ui/components/partyUpload/partyUpload.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index 100b85a..237ac4d 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -1,6 +1,7 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import ngFileUpload from 'ng-file-upload';
+import 'angular-sortable-view';
 import 'ng-img-crop/compile/minified/ng-img-crop';
 import 'ng-img-crop/compile/minified/ng-img-crop.css';
 
@@ -78,7 +79,8 @@ const name = 'partyUpload';
 export default angular.module(name, [
   angularMeteor,
   ngFileUpload,
-  'ngImgCrop'
+  'ngImgCrop',
+  'angular-sortable-view'
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 44994ffa1da29ff06106a5a5ee53ee78bd324ca3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 14:33:31 +0200
Subject: [PATCH 339/376] Step 20.36: Use directives on thumbnails

---
 imports/ui/components/partyUpload/partyUpload.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partyUpload/partyUpload.html b/imports/ui/components/partyUpload/partyUpload.html
index 124bfdb..14a3704 100644
--- a/imports/ui/components/partyUpload/partyUpload.html
+++ b/imports/ui/components/partyUpload/partyUpload.html
@@ -29,9 +29,9 @@
       <img-crop image="partyUpload.cropImgSrc" result-image="partyUpload.myCroppedImage" area-type="square"></img-crop>
     </div>
   </div>
-  <div layout="row" class="images-container-title">
-    <div class="party-image-container" ng-class="{'main-image': $index === 0}" ng-repeat="thumb in partyUpload.thumbs">
-      <img ng-src="{{ thumb.url }}"/>
+  <div layout="row" class="images-container-title" sv-root sv-part="partyUpload.thumbs">
+    <div sv-element class="party-image-container" ng-class="{'main-image': $index === 0}" ng-repeat="thumb in partyUpload.thumbs">
+      <img draggable="false" ng-src="{{ thumb.url }}"/>
     </div>
   </div>
 </div>
-- 
2.7.4


From 9d8d5ce1c6af474f6a85559f59831caf6d9d3f72 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 15:33:07 +0200
Subject: [PATCH 340/376] Step 20.37: Define two-way data binding `files`

---
 imports/ui/components/partyUpload/partyUpload.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyUpload/partyUpload.js b/imports/ui/components/partyUpload/partyUpload.js
index 237ac4d..400368e 100644
--- a/imports/ui/components/partyUpload/partyUpload.js
+++ b/imports/ui/components/partyUpload/partyUpload.js
@@ -83,6 +83,9 @@ export default angular.module(name, [
   'angular-sortable-view'
 ]).component(name, {
   template,
+  bindings: {
+    files: '=?'
+  },
   controllerAs: name,
   controller: PartyUpload
 });
-- 
2.7.4


From f1b0286c9d8d43a78426a3b6138daf242e63488b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 15:33:24 +0200
Subject: [PATCH 341/376] Step 20.38: Create view for PartyImage

---
 imports/ui/components/partyImage/partyImage.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/partyImage/partyImage.html

diff --git a/imports/ui/components/partyImage/partyImage.html b/imports/ui/components/partyImage/partyImage.html
new file mode 100644
index 0000000..719c4a3
--- /dev/null
+++ b/imports/ui/components/partyImage/partyImage.html
@@ -0,0 +1 @@
+<img ng-src="{{partyImage.mainImage.url}}"/>
-- 
2.7.4


From b19299797345347fc2368eb9dd35c093de1bc167 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 15:33:39 +0200
Subject: [PATCH 342/376] Step 20.39: Create PartyImage component

---
 imports/ui/components/partyImage/partyImage.js | 37 ++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)
 create mode 100644 imports/ui/components/partyImage/partyImage.js

diff --git a/imports/ui/components/partyImage/partyImage.js b/imports/ui/components/partyImage/partyImage.js
new file mode 100644
index 0000000..5b636b8
--- /dev/null
+++ b/imports/ui/components/partyImage/partyImage.js
@@ -0,0 +1,37 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import template from './partyImage.html';
+import { Images } from '../../../api/images';
+
+class PartyImage {
+  constructor($scope, $reactive) {
+    'ngInject';
+    $reactive(this).attach($scope);
+
+    this.helpers({
+      mainImage() {
+        const images = this.getReactively('images', true);
+        if (images) {
+          return Images.findOne({
+            _id: images[0]
+          });
+        }
+      }
+    });
+  }
+}
+
+const name = 'partyImage';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  template,
+  bindings: {
+    images: '<'
+  },
+  controllerAs: name,
+  controller: PartyImage
+});
-- 
2.7.4


From 2390c871e04d6b93e363cceba98bb7757d22fcee Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 15:33:58 +0200
Subject: [PATCH 343/376] Step 20.40: Implement PartyImage in PartiesList

---
 imports/ui/components/partiesList/partiesList.html | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 12987b3..de5d229 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -25,6 +25,11 @@
             </span>
             <span class="md-subhead">{{party.description}}</span>
           </md-card-title-text>
+          <md-card-title-media ng-if="party.images">
+            <div class="md-media-lg card-media">
+              <party-image images="party.images"></party-image>
+            </div>
+          </md-card-title-media>
         </md-card-title>
         <md-card-content>
           <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
-- 
2.7.4


From 3881adc42c2d7736f16d58193eab29adb60a4359 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Wed, 13 Apr 2016 15:34:24 +0200
Subject: [PATCH 344/376] Step 20.41: Add PartyImage to PartiesList and
 subscribe to `images`

---
 imports/ui/components/partiesList/partiesList.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 17996c3..9e90e1f 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -14,6 +14,7 @@ import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
 import { name as PartyRsvpsList } from '../partyRsvpsList/partyRsvpsList';
+import { name as PartyImage } from '../partyImage/partyImage';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -36,6 +37,7 @@ class PartiesList {
     ]);
 
     this.subscribe('users');
+    this.subscribe('images');
 
     this.helpers({
       parties() {
@@ -81,7 +83,8 @@ export default angular.module(name, [
   PartyRemove,
   PartyCreator,
   PartyRsvp,
-  PartyRsvpsList
+  PartyRsvpsList,
+  PartyImage
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 037e59b95ffee276326032b1ad6a05d8bf082c9a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:41:02 +0200
Subject: [PATCH 345/376] Step 21.1: Add mobile platform

---
 .meteor/platforms | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/.meteor/platforms b/.meteor/platforms
index efeba1b..0b0ddcc 100644
--- a/.meteor/platforms
+++ b/.meteor/platforms
@@ -1,2 +1,3 @@
-server
+android
 browser
+server
-- 
2.7.4


From 7c8390b26f835c844108ad166f84f15b68fbf206 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:43:34 +0200
Subject: [PATCH 346/376] Step 21.2: Move login.html to web.html

---
 imports/ui/components/login/web.html | 70 ++++++++++++++++++++++++++++++++++++
 1 file changed, 70 insertions(+)
 create mode 100644 imports/ui/components/login/web.html

diff --git a/imports/ui/components/login/web.html b/imports/ui/components/login/web.html
new file mode 100644
index 0000000..1ac5b6f
--- /dev/null
+++ b/imports/ui/components/login/web.html
@@ -0,0 +1,70 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1">
+          Sign in
+        </h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">
+          Use existing account</p>
+      </div>
+
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_google_24px" style="color: #DC4A38;"></md-icon>
+          <span>Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_facebook_24px" style="color: #3F62B4;"></md-icon>
+          <span>Facebook</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="social:ic_twitter_24px" style="color: #27AAE2;"></md-icon>
+          <span>Twitter</span>
+        </md-button>
+      </div>
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">
+          Sign in with your email</p>
+      </div>
+
+      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label>
+            Email
+          </label>
+          <input type="text" ng-model="login.credentials.email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container>
+          <label>
+            Password
+          </label>
+          <input type="password" ng-model="login.credentials.password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="space-between center">
+          <a class="md-button" href="/password">Forgot password?</a>
+          
+          <md-button class="md-raised md-primary" ng-click="login.login()" aria-label="login" ng-disabled="login.loginForm.$invalid()">Sign In
+          </md-button>
+        </div>
+      </form>
+
+      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ login.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/register">Need an account?</a>
+      </div>
+    </div>
+  </md-whiteframe>
+</md-content>
-- 
2.7.4


From 3e0d4a625a74378c30e94a8195c0d51861769145 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:45:56 +0200
Subject: [PATCH 347/376] Step 21.3: Add mobile view

---
 imports/ui/components/login/mobile.html | 27 +++++++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 imports/ui/components/login/mobile.html

diff --git a/imports/ui/components/login/mobile.html b/imports/ui/components/login/mobile.html
new file mode 100644
index 0000000..112ba9e
--- /dev/null
+++ b/imports/ui/components/login/mobile.html
@@ -0,0 +1,27 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <!-- header -->
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1">
+          Login
+        </h3>
+      </div>
+    </md-toolbar>
+
+    <!-- content -->
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <!-- display an error -->
+      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ login.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+
+      <!-- other actions -->
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/password">Forgot password?</a>
+      </div>
+    </div>
+  </md-whiteframe>
+</md-content>
-- 
2.7.4


From 43d80c932a443d61510c40235e27618cdea86bb6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:47:15 +0200
Subject: [PATCH 348/376] Step 21.4: Move Login class to web.js

---
 imports/ui/components/login/web.js | 30 ++++++++++++++++++++++++++++++
 1 file changed, 30 insertions(+)
 create mode 100644 imports/ui/components/login/web.js

diff --git a/imports/ui/components/login/web.js b/imports/ui/components/login/web.js
new file mode 100644
index 0000000..bc7b752
--- /dev/null
+++ b/imports/ui/components/login/web.js
@@ -0,0 +1,30 @@
+import { Meteor } from 'meteor/meteor';
+
+export class Login {
+  constructor($scope, $reactive, $state) {
+    'ngInject';
+
+    this.$state = $state;
+
+    $reactive(this).attach($scope);
+
+    this.credentials = {
+      email: '',
+      password: ''
+    };
+
+    this.error = '';
+  }
+
+  login() {
+    Meteor.loginWithPassword(this.credentials.email, this.credentials.password,
+      this.$bindToContext((err) => {
+        if (err) {
+          this.error = err;
+        } else {
+          this.$state.go('parties');
+        }
+      })
+    );
+  }
+}
-- 
2.7.4


From 04dd87fc7fb1e60f06c401a42301bd1f0b713c11 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:48:39 +0200
Subject: [PATCH 349/376] Step 21.5: Create controller for mobile

---
 imports/ui/components/login/mobile.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/login/mobile.js

diff --git a/imports/ui/components/login/mobile.js b/imports/ui/components/login/mobile.js
new file mode 100644
index 0000000..792f38c
--- /dev/null
+++ b/imports/ui/components/login/mobile.js
@@ -0,0 +1 @@
+export class Login {}
-- 
2.7.4


From 82ef3e0d4add0a6f6f50271bf861c95740049fba Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:49:48 +0200
Subject: [PATCH 350/376] Step 21.6: Refactor login.js

---
 imports/ui/components/login/login.js | 42 +++++++-----------------------------
 1 file changed, 8 insertions(+), 34 deletions(-)

diff --git a/imports/ui/components/login/login.js b/imports/ui/components/login/login.js
index 4ae9c9e..376fcaf 100644
--- a/imports/ui/components/login/login.js
+++ b/imports/ui/components/login/login.js
@@ -4,40 +4,14 @@ import uiRouter from 'angular-ui-router';
 
 import { Meteor } from 'meteor/meteor';
 
-import template from './login.html';
-
-import { name as Register } from '../register/register';
-
-class Login {
-  constructor($scope, $reactive, $state) {
-    'ngInject';
-
-    this.$state = $state;
-
-    $reactive(this).attach($scope);
-
-    this.credentials = {
-      email: '',
-      password: ''
-    };
-
-    this.error = '';
-  }
-
-  login() {
-    Meteor.loginWithPassword(this.credentials.email, this.credentials.password,
-      this.$bindToContext((err) => {
-        if (err) {
-          this.error = err;
-        } else {
-          this.$state.go('parties');
-        }
-      })
-    );
-  }
-}
+import webTemplate from './web.html';
+import { Login as LoginWeb } from './web';
+import mobileTemplate from './mobile.html';
+import { Login as LoginMobile } from './mobile';
 
 const name = 'login';
+const template = Meteor.isCordova ? mobileTemplate : webTemplate;
+const controller = Meteor.isCordova ? LoginMobile : LoginWeb;
 
 // create a module
 export default angular.module(name, [
@@ -46,8 +20,8 @@ export default angular.module(name, [
 ])
   .component(name, {
     template,
-    controllerAs: name,
-    controller: Login
+    controller,
+    controllerAs: name
   })
   .config(config);
 
-- 
2.7.4


From e80d624456fadb8d304bbc865dabadabe83f1a00 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:50:03 +0200
Subject: [PATCH 351/376] Step 21.7: Remove login.html

---
 imports/ui/components/login/login.html | 72 ----------------------------------
 1 file changed, 72 deletions(-)
 delete mode 100644 imports/ui/components/login/login.html

diff --git a/imports/ui/components/login/login.html b/imports/ui/components/login/login.html
deleted file mode 100644
index 64ea544..0000000
--- a/imports/ui/components/login/login.html
+++ /dev/null
@@ -1,72 +0,0 @@
-<md-content layout="row" layout-align="center start" layout-fill layout-margin>
-
-  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
-
-    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
-      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
-        <h3 class="md-display-1">
-          Sign in
-        </h3>
-      </div>
-    </md-toolbar>
-
-    <div layout="column" layout-fill layout-margin layout-padding>
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2">
-          Use existing account</p>
-      </div>
-      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="social:ic_google_24px" style="color: #DC4A38;"></md-icon>
-          <span>
-            Google</span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="social:ic_facebook_24px" style="color: #3F62B4;"></md-icon>
-          <span>Facebook
-          </span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="social:ic_twitter_24px" style="color: #27AAE2;"></md-icon>
-          <span>Twitter
-          </span>
-        </md-button>
-      </div>
-      <md-divider class="inset"></md-divider>
-
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2">
-          Sign in with your email</p>
-      </div>
-
-      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
-        <md-input-container>
-          <label>
-            Email
-          </label>
-          <input type="text" ng-model="login.credentials.email" aria-label="email" required/>
-        </md-input-container>
-        <md-input-container>
-          <label>
-            Password
-          </label>
-          <input type="password" ng-model="login.credentials.password" aria-label="password" required/>
-        </md-input-container>
-        <div layout="row" layout-align="space-between center">
-          <a class="md-button" href="/password">Forgot password?</a>
-          <md-button class="md-raised md-primary" ng-click="login.login()" aria-label="login" ng-disabled="login.loginForm.$invalid()">Sign In
-          </md-button>
-        </div>
-      </form>
-      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
-        <p class="md-body-1">{{ login.error }}</p>
-      </md-toolbar>
-      <md-divider></md-divider>
-      <div layout="row" layout-align="center">
-        <a class="md-button" href="/register">Need an account?</a>
-      </div>
-
-    </div>
-
-  </md-whiteframe>
-</md-content>
-- 
2.7.4


From b02137fbfc370ce79dca7e4867cf58da0c389198 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:52:54 +0200
Subject: [PATCH 352/376] Step 21.8: Add `okland:accounts-phone`

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index ff02119..0e55f70 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -31,3 +31,4 @@ less
 planettraining:material-design-icons
 jalik:ufs
 jalik:ufs-gridfs
+mys:accounts-phone
diff --git a/.meteor/versions b/.meteor/versions
index 8d115df..925f99d 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -68,6 +68,7 @@ oauth@1.1.8
 oauth1@1.1.7
 oauth2@1.1.7
 observe-sequence@1.0.11
+mys:accounts-phone@0.0.21
 ordered-dict@1.0.7
 pbastowski:angular-babel@1.3.2
 planettraining:material-design-icons@2.2.0
-- 
2.7.4


From 314d61a563c68debfff294e349f18d6e6b79c192 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:56:24 +0200
Subject: [PATCH 353/376] Step 21.9: Add phone verification method

---
 imports/ui/components/login/mobile.js | 28 +++++++++++++++++++++++++++-
 1 file changed, 27 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/login/mobile.js b/imports/ui/components/login/mobile.js
index 792f38c..c201eb2 100644
--- a/imports/ui/components/login/mobile.js
+++ b/imports/ui/components/login/mobile.js
@@ -1 +1,27 @@
-export class Login {}
+import { Accounts } from 'meteor/accounts-base';
+
+export class Login {
+  constructor($scope, $reactive) {
+    'ngInject';
+
+    $reactive(this).attach($scope);
+
+    this.isStepTwo = false;
+    this.phoneNumber = '';
+    this.verificationCode = '';
+    this.error = '';
+  }
+
+  verifyPhone() {
+    Accounts.requestPhoneVerification(this.phoneNumber, this.$bindToContext((err) => {
+      if (err) {
+        // display also reason of Meteor.Error
+        this.error = err.reason || err;
+      } else {
+        this.error = '';
+        // move to code verification
+        this.isStepTwo = true;
+      }
+    }));
+  }
+}
-- 
2.7.4


From b4c541a052564ea841f3064551ec74f8a41ff63b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 20:57:40 +0200
Subject: [PATCH 354/376] Step 21.10: Add phone verification form

---
 imports/ui/components/login/mobile.html | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/login/mobile.html b/imports/ui/components/login/mobile.html
index 112ba9e..0b889a7 100644
--- a/imports/ui/components/login/mobile.html
+++ b/imports/ui/components/login/mobile.html
@@ -4,13 +4,22 @@
     <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
       <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
         <h3 class="md-display-1">
-          Login
+          Login with SMS
         </h3>
       </div>
     </md-toolbar>
 
     <!-- content -->
     <div layout="column" layout-fill layout-margin layout-padding>
+      <!-- step 1: phone verification -->
+      <form ng-show="!login.isStepTwo" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <input type="text" ng-model="login.phoneNumber" placeholder="phone"/>
+        </md-input-container>
+        <md-button class="md-raised md-primary" ng-click="login.verifyPhone()" aria-label="login" ng-disabled="!login.phoneNumber">Send SMS
+        </md-button>
+      </form>
+      
       <!-- display an error -->
       <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
         <p class="md-body-1">{{ login.error }}</p>
-- 
2.7.4


From 88c069178712b4e5b75a59a701697a0e2f5783cd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 21:00:05 +0200
Subject: [PATCH 355/376] Step 21.11: Add code verification method

---
 imports/ui/components/login/mobile.js | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/login/mobile.js b/imports/ui/components/login/mobile.js
index c201eb2..798d563 100644
--- a/imports/ui/components/login/mobile.js
+++ b/imports/ui/components/login/mobile.js
@@ -1,9 +1,11 @@
 import { Accounts } from 'meteor/accounts-base';
 
 export class Login {
-  constructor($scope, $reactive) {
+  constructor($scope, $reactive, $state) {
     'ngInject';
 
+    this.$state = $state;
+
     $reactive(this).attach($scope);
 
     this.isStepTwo = false;
@@ -24,4 +26,15 @@ export class Login {
       }
     }));
   }
+
+  verifyCode() {
+    Accounts.verifyPhone(this.phoneNumber, this.verificationCode, this.$bindToContext((err) => {
+      if (err) {
+        this.error = err.reason || err;
+      } else {
+        // redirect to parties list
+        this.$state.go('parties');
+      }
+    }));
+  }
 }
-- 
2.7.4


From 11c2faf82635355d51555ce320b92ffd7e956b1f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 14 Apr 2016 21:01:13 +0200
Subject: [PATCH 356/376] Step 21.12: Add code verification form

---
 imports/ui/components/login/mobile.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/login/mobile.html b/imports/ui/components/login/mobile.html
index 0b889a7..e93c1d5 100644
--- a/imports/ui/components/login/mobile.html
+++ b/imports/ui/components/login/mobile.html
@@ -19,7 +19,15 @@
         <md-button class="md-raised md-primary" ng-click="login.verifyPhone()" aria-label="login" ng-disabled="!login.phoneNumber">Send SMS
         </md-button>
       </form>
-      
+      <!-- step 2: code verification -->
+      <form ng-show="login.isStepTwo" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <input type="text" ng-model="login.verificationCode" placeholder="code"/>
+        </md-input-container>
+        <md-button class="md-raised md-primary" ng-click="login.verifyCode()" aria-label="login" ng-disabled="!login.verificationCode">Verify Code
+        </md-button>
+      </form>
+
       <!-- display an error -->
       <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
         <p class="md-body-1">{{ login.error }}</p>
-- 
2.7.4


From ef258f7cf4142e9b11f2ecf1ca9aaa8f7f9cf9e8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 10:58:52 +0200
Subject: [PATCH 357/376] Step 22.1: Install `ionic-sdk`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index ffe3f6d..4c15c16 100644
--- a/package.json
+++ b/package.json
@@ -18,6 +18,7 @@
     "angular-sortable-view": "0.0.15",
     "angular-utils-pagination": "^0.11.1",
     "gm": "^1.22.0",
+    "ionic-sdk": "^1.2.4",
     "meteor-node-stubs": "~0.2.0",
     "ng-file-upload": "^12.0.4",
     "ng-img-crop": "^0.2.0",
-- 
2.7.4


From 08f0eb1139d71aa1d9db18e157b99c65937d5886 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 10:59:31 +0200
Subject: [PATCH 358/376] Step 22.2: Install `angular-sanitize`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 4c15c16..056163e 100644
--- a/package.json
+++ b/package.json
@@ -14,6 +14,7 @@
     "angular-messages": "^1.5.3",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^0.2.18",
+    "angular-sanitize": "^1.5.5",
     "angular-simple-logger": "^0.1.7",
     "angular-sortable-view": "0.0.15",
     "angular-utils-pagination": "^0.11.1",
-- 
2.7.4


From f0917930ef8604ae573f1dbb9b3b51fefeabb23d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 11:08:38 +0200
Subject: [PATCH 359/376] Step 22.3: ngSanitize as a dependency

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 21940eb..ada6751 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -1,6 +1,7 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import ngMaterial from 'angular-material';
+import ngSanitize from 'angular-sanitize';
 import uiRouter from 'angular-ui-router';
 
 import template from './socially.html';
@@ -17,6 +18,7 @@ const name = 'socially';
 export default angular.module(name, [
   angularMeteor,
   ngMaterial,
+  ngSanitize,
   uiRouter,
   PartiesList,
   PartyDetails,
-- 
2.7.4


From d667dba889bfd429debaacf45771d6bbc4ab6f63 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 11:48:44 +0200
Subject: [PATCH 360/376] Step 22.4: Import ionic and add as a dependency

---
 imports/ui/components/socially/socially.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index ada6751..f72bc21 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -3,6 +3,8 @@ import angularMeteor from 'angular-meteor';
 import ngMaterial from 'angular-material';
 import ngSanitize from 'angular-sanitize';
 import uiRouter from 'angular-ui-router';
+import 'ionic-sdk/release/js/ionic';
+import 'ionic-sdk/release/js/ionic-angular';
 
 import template from './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
@@ -24,7 +26,8 @@ export default angular.module(name, [
   PartyDetails,
   Navigation,
   Auth,
-  'accounts.ui'
+  'accounts.ui',
+  'ionic'
 ]).component(name, {
   template,
   controllerAs: name,
-- 
2.7.4


From 83c557f1586e1a8783c59cb63d3e34fe2ba0086d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 11:49:08 +0200
Subject: [PATCH 361/376] Step 22.5: Import ionic styles

---
 imports/ui/components/socially/socially.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index f72bc21..ac7ac39 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -5,6 +5,7 @@ import ngSanitize from 'angular-sanitize';
 import uiRouter from 'angular-ui-router';
 import 'ionic-sdk/release/js/ionic';
 import 'ionic-sdk/release/js/ionic-angular';
+import 'ionic-sdk/release/css/ionic.css';
 
 import template from './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
-- 
2.7.4


From 0b1b55e858cf1fe37da98dbdc00ffdc1abf00f12 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 11:50:26 +0200
Subject: [PATCH 362/376] Step 22.6: Create view of Socially for web

---
 imports/ui/components/socially/web.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/socially/web.html

diff --git a/imports/ui/components/socially/web.html b/imports/ui/components/socially/web.html
new file mode 100644
index 0000000..7fdb2de
--- /dev/null
+++ b/imports/ui/components/socially/web.html
@@ -0,0 +1,3 @@
+<navigation></navigation>
+
+<div ui-view=""></div>
-- 
2.7.4


From ba16ebf88c5cafadd34caf455b9c51a4f5370f6b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 11:51:02 +0200
Subject: [PATCH 363/376] Step 22.7: Create mobile view

---
 imports/ui/components/socially/mobile.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/socially/mobile.html

diff --git a/imports/ui/components/socially/mobile.html b/imports/ui/components/socially/mobile.html
new file mode 100644
index 0000000..b0de4a9
--- /dev/null
+++ b/imports/ui/components/socially/mobile.html
@@ -0,0 +1,3 @@
+<ion-nav-bar class="bar-positive" align-title="center">
+</ion-nav-bar>
+<ion-nav-view></ion-nav-view>
-- 
2.7.4


From ade99bed15cd06ee3d521f08adb9c9c5d780b05d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 11:53:48 +0200
Subject: [PATCH 364/376] Step 22.8: Implement web and mobile views

---
 imports/ui/components/socially/socially.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index ac7ac39..ff140a5 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -7,7 +7,10 @@ import 'ionic-sdk/release/js/ionic';
 import 'ionic-sdk/release/js/ionic-angular';
 import 'ionic-sdk/release/css/ionic.css';
 
-import template from './socially.html';
+import { Meteor } from 'meteor/meteor';
+
+import webTemplate from './web.html';
+import mobileTemplate from './mobile.html';
 import { name as PartiesList } from '../partiesList/partiesList';
 import { name as PartyDetails } from '../partyDetails/partyDetails';
 import { name as Navigation } from '../navigation/navigation';
@@ -16,6 +19,7 @@ import { name as Auth } from '../auth/auth';
 class Socially {}
 
 const name = 'socially';
+const template = Meteor.isCordova ? mobileTemplate : webTemplate;
 
 // create a module
 export default angular.module(name, [
-- 
2.7.4


From 5f409f749c54b8ad69b4e9382321b4ebda6d301f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:17:24 +0200
Subject: [PATCH 365/376] Step 22.9: Remove old view

---
 imports/ui/components/socially/socially.html | 3 ---
 1 file changed, 3 deletions(-)
 delete mode 100644 imports/ui/components/socially/socially.html

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
deleted file mode 100644
index 7fdb2de..0000000
--- a/imports/ui/components/socially/socially.html
+++ /dev/null
@@ -1,3 +0,0 @@
-<navigation></navigation>
-
-<div ui-view=""></div>
-- 
2.7.4


From af259048db9c6163fd03651e2593fab5fa7e34ef Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:18:14 +0200
Subject: [PATCH 366/376] Step 22.10: Add title

---
 imports/ui/components/socially/mobile.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/socially/mobile.html b/imports/ui/components/socially/mobile.html
index b0de4a9..7751a6f 100644
--- a/imports/ui/components/socially/mobile.html
+++ b/imports/ui/components/socially/mobile.html
@@ -1,3 +1,6 @@
 <ion-nav-bar class="bar-positive" align-title="center">
+  <ion-nav-title>
+    Socially
+  </ion-nav-title>
 </ion-nav-bar>
 <ion-nav-view></ion-nav-view>
-- 
2.7.4


From cfb7b072d4d37183916eafbb1c9a48cb135b9699 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:19:33 +0200
Subject: [PATCH 367/376] Step 22.11: Create web view of PartiesList

---
 imports/ui/components/partiesList/web.html | 57 ++++++++++++++++++++++++++++++
 1 file changed, 57 insertions(+)
 create mode 100644 imports/ui/components/partiesList/web.html

diff --git a/imports/ui/components/partiesList/web.html b/imports/ui/components/partiesList/web.html
new file mode 100644
index 0000000..de5d229
--- /dev/null
+++ b/imports/ui/components/partiesList/web.html
@@ -0,0 +1,57 @@
+<div layout="column" layout-padding>
+  <party-add-button ng-show="partiesList.isLoggedIn"></party-add-button>
+
+  <div flex>
+    <h2 class="md-display-1">List of the parties:</h2>
+  </div>
+
+  <div flex layout="row" layout-padding>
+    <md-input-container>
+      <label>Search</label>
+      <input ng-model="partiesList.searchText">
+    </md-input-container>
+
+    <parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
+  </div>
+
+  <div layout="column" layout-gt-sm="row">
+    <div flex="50">
+      <md-card dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
+        <md-card-title>
+          <md-card-title-text>
+            <span class="md-headline" ui-sref="partyDetails({ partyId: party._id })">
+              {{party.name}}
+              <party-remove party="party"></party-remove>
+            </span>
+            <span class="md-subhead">{{party.description}}</span>
+          </md-card-title-text>
+          <md-card-title-media ng-if="party.images">
+            <div class="md-media-lg card-media">
+              <party-image images="party.images"></party-image>
+            </div>
+          </md-card-title-media>
+        </md-card-title>
+        <md-card-content>
+          <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
+
+          <party-unanswered party="party" ng-if="!party.public"></party-unanswered>
+          <div ng-if="party.public">
+            Everyone is invited
+          </div>
+
+          <party-creator party="party"></party-creator>
+        </md-card-content>
+        <md-card-actions>
+          <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
+          <div ng-hide="partiesList.isLoggedIn">
+            <i>Sign in to RSVP for this party.</i>
+          </div>
+        </md-card-actions>
+      </md-card>
+      <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+    </div>
+    <div flex="50">
+      <parties-map parties="partiesList.parties"></parties-map>
+    </div>
+  </div>
+</div>
-- 
2.7.4


From df926f8796cd6f21a3a8773df0901eda11778c6a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:20:02 +0200
Subject: [PATCH 368/376] Step 22.12: Remove old view

---
 imports/ui/components/partiesList/partiesList.html | 57 ----------------------
 1 file changed, 57 deletions(-)
 delete mode 100644 imports/ui/components/partiesList/partiesList.html

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
deleted file mode 100644
index de5d229..0000000
--- a/imports/ui/components/partiesList/partiesList.html
+++ /dev/null
@@ -1,57 +0,0 @@
-<div layout="column" layout-padding>
-  <party-add-button ng-show="partiesList.isLoggedIn"></party-add-button>
-
-  <div flex>
-    <h2 class="md-display-1">List of the parties:</h2>
-  </div>
-
-  <div flex layout="row" layout-padding>
-    <md-input-container>
-      <label>Search</label>
-      <input ng-model="partiesList.searchText">
-    </md-input-container>
-
-    <parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
-  </div>
-
-  <div layout="column" layout-gt-sm="row">
-    <div flex="50">
-      <md-card dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
-        <md-card-title>
-          <md-card-title-text>
-            <span class="md-headline" ui-sref="partyDetails({ partyId: party._id })">
-              {{party.name}}
-              <party-remove party="party"></party-remove>
-            </span>
-            <span class="md-subhead">{{party.description}}</span>
-          </md-card-title-text>
-          <md-card-title-media ng-if="party.images">
-            <div class="md-media-lg card-media">
-              <party-image images="party.images"></party-image>
-            </div>
-          </md-card-title-media>
-        </md-card-title>
-        <md-card-content>
-          <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
-
-          <party-unanswered party="party" ng-if="!party.public"></party-unanswered>
-          <div ng-if="party.public">
-            Everyone is invited
-          </div>
-
-          <party-creator party="party"></party-creator>
-        </md-card-content>
-        <md-card-actions>
-          <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
-          <div ng-hide="partiesList.isLoggedIn">
-            <i>Sign in to RSVP for this party.</i>
-          </div>
-        </md-card-actions>
-      </md-card>
-      <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-    </div>
-    <div flex="50">
-      <parties-map parties="partiesList.parties"></parties-map>
-    </div>
-  </div>
-</div>
-- 
2.7.4


From 88c4e69b8bbe008e4d3b6456c47e00ce2f6c8132 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:20:56 +0200
Subject: [PATCH 369/376] Step 22.13: Create mobile view

---
 imports/ui/components/partiesList/mobile.html | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 imports/ui/components/partiesList/mobile.html

diff --git a/imports/ui/components/partiesList/mobile.html b/imports/ui/components/partiesList/mobile.html
new file mode 100644
index 0000000..c2c838a
--- /dev/null
+++ b/imports/ui/components/partiesList/mobile.html
@@ -0,0 +1,22 @@
+<ion-view hide-back-button="true">
+  <ion-content padding="true" class="has-header">
+    <div class="list">
+      <div class="card" ng-repeat="party in partiesList.parties">
+        <div class="item">
+          <h2>
+            {{party.name}}
+          </h2>
+          <p>
+            {{party.description}}
+          </p>
+        </div>
+
+        <div class="item item-image">
+          <party-image images="party.images"></party-image>
+        </div>
+
+        <party-rsvps-list class="item" rsvps="party.rsvps"></party-rsvps-list>
+      </div>
+    </div>
+  </ion-content>
+</ion-view>
-- 
2.7.4


From 437bc3bb67f2fc5552edc460f762928e6f622f95 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:21:54 +0200
Subject: [PATCH 370/376] Step 22.14: Implement new views

---
 imports/ui/components/partiesList/partiesList.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 9e90e1f..df916d9 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -4,8 +4,10 @@ import uiRouter from 'angular-ui-router';
 import utilsPagination from 'angular-utils-pagination';
 
 import { Counts } from 'meteor/tmeasday:publish-counts';
+import { Meteor } from 'meteor/meteor';
 
-import template from './partiesList.html';
+import webTemplate from './web.html';
+import mobileTemplate from './mobile.html';
 import { Parties } from '../../../api/parties';
 import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartiesMap } from '../partiesMap/partiesMap';
@@ -71,6 +73,7 @@ class PartiesList {
 }
 
 const name = 'partiesList';
+const template = Meteor.isCordova ? mobileTemplate : webTemplate;
 
 // create a module
 export default angular.module(name, [
-- 
2.7.4


From 3242b93c5212b58a3d0c4bab09ad01cd93f80f8b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:22:45 +0200
Subject: [PATCH 371/376] Step 22.15: Remove top margin of the first card

---
 imports/ui/components/partiesList/partiesList.less | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.less b/imports/ui/components/partiesList/partiesList.less
index b0bc5dc..08e59d6 100644
--- a/imports/ui/components/partiesList/partiesList.less
+++ b/imports/ui/components/partiesList/partiesList.less
@@ -2,6 +2,10 @@ parties-list {
   [ui-sref] {
     cursor: pointer;
   }
+
+  .list > .card:first-child {
+    margin-top: 0;
+  }
 }
 
 @import "../partiesMap/partiesMap.less";
-- 
2.7.4


From 68db85626a19ebecfef5e3ec32634a97e64d0756 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:25:39 +0200
Subject: [PATCH 372/376] Step 22.16: Create DisplayImageFilter

---
 imports/ui/filters/displayImageFilter.js | 26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)
 create mode 100644 imports/ui/filters/displayImageFilter.js

diff --git a/imports/ui/filters/displayImageFilter.js b/imports/ui/filters/displayImageFilter.js
new file mode 100644
index 0000000..aa2dfda
--- /dev/null
+++ b/imports/ui/filters/displayImageFilter.js
@@ -0,0 +1,26 @@
+import angular from 'angular';
+
+import { Meteor } from 'meteor/meteor';
+
+const name = 'displayImageFilter';
+
+function DisplayImageFilter(image) {
+  if (!image) {
+    return image;
+  }
+
+  // leave it as it is for the web view
+  if (!Meteor.isCordova) {
+    return image.url;
+  }
+
+  // create new path of an image
+  const path = `ufs/${image.store}/${image._id}/${image.name}`;
+  return Meteor.absoluteUrl(path);
+}
+
+// create a module
+export default angular.module(name, [])
+  .filter(name, () => {
+    return DisplayImageFilter;
+  });
-- 
2.7.4


From ae26c2d57314ecae1d48702f4ec95528aacc0c3b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:26:55 +0200
Subject: [PATCH 373/376] Step 22.17: Add new filter to PartyImage

---
 imports/ui/components/partyImage/partyImage.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyImage/partyImage.js b/imports/ui/components/partyImage/partyImage.js
index 5b636b8..64384c0 100644
--- a/imports/ui/components/partyImage/partyImage.js
+++ b/imports/ui/components/partyImage/partyImage.js
@@ -3,6 +3,7 @@ import angularMeteor from 'angular-meteor';
 
 import template from './partyImage.html';
 import { Images } from '../../../api/images';
+import { name as DisplayImageFilter } from '../../filters/displayImageFilter';
 
 class PartyImage {
   constructor($scope, $reactive) {
@@ -26,7 +27,8 @@ const name = 'partyImage';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  DisplayImageFilter
 ]).component(name, {
   template,
   bindings: {
-- 
2.7.4


From 9779629575eba0c990ef01cba70cf3f3aa9bb847 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 25 Apr 2016 15:27:28 +0200
Subject: [PATCH 374/376] Step 22.18: Implement DisplayImageFilter

---
 imports/ui/components/partyImage/partyImage.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyImage/partyImage.html b/imports/ui/components/partyImage/partyImage.html
index 719c4a3..04693e3 100644
--- a/imports/ui/components/partyImage/partyImage.html
+++ b/imports/ui/components/partyImage/partyImage.html
@@ -1 +1 @@
-<img ng-src="{{partyImage.mainImage.url}}"/>
+<img ng-src="{{partyImage.mainImage | displayImageFilter}}"/>
-- 
2.7.4


From 479cc738fe868a028ad3ad30ad8084928e074d41 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 10:27:29 +0200
Subject: [PATCH 375/376] Add README

---
 README.md | 61 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 61 insertions(+)
 create mode 100644 README.md

diff --git a/README.md b/README.md
new file mode 100644
index 0000000..95fd557
--- /dev/null
+++ b/README.md
@@ -0,0 +1,61 @@
+# meteor-angular-socially - [Tutorial's site](http://angular-meteor.com/tutorialIntro)
+angular-meteor example and tutorial app.
+
+The tutorial starts at branch 'step_00' till the last step.
+
+The master branch is always equal to the last step.
+
+Here is the deployed final version - http://socially-step22.meteor.com/
+
+Please contribute to the tutorial.
+Pull request the master branch to add new features or pull request specific step to improve that step.
+
+Our goal in this tutorial is to add more steps as we go along, to cover as many use cases as possible.
+
+Thanks @MilosStanic for writing step 18 on angular-material
+
+An example with the `controller as` syntax can be found in [this branch](https://github.com/Urigo/meteor-angular-socially/tree/step_12_controller_as_vm).
+
+# angular-meteor University! <a href="http://angularjs.meteor.com/"><img src="http://angular-meteor.com/images/logo.png" /></a>  
+
+The angular-meteor university is a community learning experiment, we would like to create a similar experience to the [hueniversity](https://github.com/hueniverse/hueniversity)
+
+
+[![Join the chat at https://gitter.im/Urigo/angular-meteor](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/Urigo/angular-meteor?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)
+
+The first assignments will be to rewrite the tutorial steps, and follow the latest angular-meteor API , in a more [consistent style](https://github.com/johnpapa/angular-styleguide).
+We also hope the community will propose better solutions than the current ones.
+When we will catch up with the latest steps we will create new steps.
+
+### What am I going to learn?
+You will learn how to build a full stack application using meteor and angular. It will start with the basics and move on to the more advanced topic such as users and authentication, application architecture, reactivity, mobile app, ionic, working with files, Angular Server, ES6 and more.
+
+
+### What do I need to know?
+You should feel comfortable writing simple functions in JavaScript, working with GitHub, using basic git commands, have a basic familiarity with mongoDB, and be able to pick up new subjects by reading tutorials and documentation.
+
+### How advanced is this course?
+We'll start from the basics and make our way to the most advanced topics. The way this course is structured, you can choose which assignments to participate in, so more experienced developers can "sit out" or help others during the basic assignments and participate when it gets to areas they are not as strong in. However, since teaching is one of the most effective ways to learn, we believe that participating early will improve the existing skills of advanced developers.
+The assignment will include just enough information to get you going, but you will need to do most of the learning on your own by using the wide range of online resources available. However, the real benefit of this process will come from the code review of your Pull Request. This is where expert developers will review your work and provide you specific and actionable feedback.
+
+### How does it work?
+First, read the [Code of Conduct](https://github.com/Urigo/meteor-angular-socially/blob/master/COC.md) !
+
+Simple, you start by forking this repo.
+Every few days a new issue will be posted with an [`assignment` label](https://github.com/Urigo/meteor-angular-socially/labels/assignment)
+. If you would like to participate in the assignment, try to solve it and when you are done, submit a Pull Request back to this repo to the `step_NUMBER_u` branch. Make sure your code complies with the [John Papa Angular Style Guide](https://github.com/johnpapa/angular-styleguide).
+While you wait for the assignment to close, take a look at what others are submitting and see if you can improve your own solution (borrow ideas, add tests, write examples, update the documentation). If you see ways in which others can improve their solution, please don’t hesitate to comment on their Pull Request.
+Each assignment will have a final submission date. When the issue expires, one of the Pull Requests submitted will be picked and merged and published as the new tutorial step. Any follow up assignments will be based on the merged code.
+Before starting the next assignment, make sure [your fork matches the current](https://github.com/Urigo/meteor-angular-socially/blob/master/guides/git.md ) assignment step branch (`step_NUMBER_u`) since only one Pull Request can be accepted.
+
+### How can I help?
+
+There are lots of way you can help make this experiment succeed and help shape a new format for teaching development skills:
+Submit Pull Requests to improve this readme, add examples, write quick tutorials on how to work with git, etc.
+Add new steps to angular-meteor-socially tutorial.
+Look for issues with a [help wanted label](https://github.com/Urigo/meteor-angular-socially/labels/help%20wanted) and help with those.
+Randomly pick submitted Pull Request and review them, offering advice and helping others improve their skills.
+Submit Pull Request or open issues with proposals for [angular-meteor](https://github.com/Urigo/angular-meteor)
+
+### Anything else?
+[Open an issue](https://github.com/Urigo/meteor-angular-socially/issues/new), it's free.
-- 
2.7.4


From 2d2ffebc58aa5b2e5969fa77277ef1ba39644db4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Mon, 11 Apr 2016 10:28:34 +0200
Subject: [PATCH 376/376] Add EDIT_THIS_TUTORIAL.md

---
 EDIT_THIS_TUTORIAL.md | 192 ++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 192 insertions(+)
 create mode 100644 EDIT_THIS_TUTORIAL.md

diff --git a/EDIT_THIS_TUTORIAL.md b/EDIT_THIS_TUTORIAL.md
new file mode 100644
index 0000000..b0f831a
--- /dev/null
+++ b/EDIT_THIS_TUTORIAL.md
@@ -0,0 +1,192 @@
+## How to edit this tutorial?
+
+First, you need to understand how this tutorial works and the importance of the commits.
+This tutorial is based on [Meteor's tutorial tools](http://meteor-tutorial-tools.readthedocs.org/en/latest/) and use it's tools to create a simple diff-boxes for code changes accross the commit.
+
+So the very first thing you need to know it that this specific tutorial is used in [Angular1 Meteor tutorials](http://www.angular-meteor.com/tutorials/socially/angular1/bootstrapping) and every diff box you see there is generated automatically from the commits in this repository.
+
+So what is the flow?
+- Create commits with specific format - the format in use in this repository and in Meteor tutorial tools is:
+
+  ````Step XX.XX: TEXT_TEXT_TEXT````
+
+  (where XX.XX are numbers that relates to the step in the tutorial you write, and TEXT_TEXT_TEXT is the title of the generated diffbox you will get).
+
+- Generate PATCH file, as described [here](http://meteor-tutorial-tools.readthedocs.org/en/latest/new-tutorial/), it's just running a simple `git` command that generates a file from all of you commits in the repository.
+
+- Create a Meteor tutorial app and define the tutorial objects - also described [here](http://meteor-tutorial-tools.readthedocs.org/en/latest/new-tutorial/).
+
+- Write your tutorial and use the `diffBox` helper to generate the actual HTML of the DiffBox.
+
+**Note that commit without the speical format are also legal, but won't be available for creating diff-box!**
+
+## How to add new steps to the tutorial?
+
+Adding new steps to your tutorial is easy, just get the latest version of the repository, and do your changes and commit them.
+It is recomended to make only ONE CHANGE in ONE FILE in ONE COMMIT, which means that after you make a simple change in only one file, commit that single file with a commit message with the right format, for example:
+
+` Step 10.12: This is new!`
+
+I recomend to perform multiple commit to your local repository, and just after you sure that they are fine, to `git push` them to the remote repository, because it is much easier to make change in the local repository.
+
+## How to undo my lastest commit?
+
+So you done a commit and you are not so sure about the change you made, or the order of it? you can just undo your lastest commit with the following command:
+
+` git reset HEAD~1`
+
+Note that the files you changes goes back to be uncommited change, and if it's a new file it will be removed from git and new you need to `git add` it again.
+
+## How to edit existing commits?
+
+So this is there it becomes interesting - we want to keep the order of the commits as it should be in the tutorial.
+
+Let's understand it with this order of commits:
+
+````
+Step 1.4: Create a new service
+Step 1.3: Create a new view
+Step 1.2: Create a new component
+Step 1.1: Add the application dependencies
+Step 1.0: Create new application
+````
+
+So now we created our tutorial, and we noticed that we have a bug in `Step 1.2` - our instinct is to go to the latest commit (most updated state of the repository) and add a new commit, and this will be the result:
+
+````
+Fix for step 1.2
+Step 1.4: Create a new service
+Step 1.3: Create a new view
+Step 1.2: Create a new component
+Step 1.1: Add the application dependencies
+Step 1.0: Create new application
+````
+
+So now we have a commit on top of the rest of the commit and if we get the lastest repository commit - everything will work great and we will have the bug fixed we just applied.
+
+This is good for regular applications or projects - but in case of a tutorial it isn't good at all - if we generate the diff box for the commit with `Step 1.2` we will see the code with the bug!
+
+So as you might already understand - we need to edit the actual `Step 1.2` commit, without adding new commits!
+
+In order to edit existing commits, we need to get the actual commit with the bug, edit it, keep the same commit message and the same commit id and then generate a new PATCH file.
+
+This might sound complicated but it isn't, it just requires from you to know how to use some `git` commands and basic `vi` commands. I also recommend to use [SourceTree](https://www.sourcetreeapp.com/) - it's great Git GUI tool, but it is not enough and note that you **must** know how to use the command line git.
+
+
+So let's edit the commit:
+
+- Go the the project's repository after you clone it, make sure you all up-to-date (`git pull`) and make sure that you do not have any commits that you did not pushed, or any other uncomitted changes! (**This is VERY important**)
+- Find the commit id you want to edit, you can simply do it in SourceTree. For example, here:
+![1](http://s10.postimg.org/qs4f1d2nd/image.png)
+
+- So in our case, we want to edit commit id `d002ba8`, so we need to go back in time and to set our local repository to that commit. This done by running the following command:
+
+````
+  git rebase -i d002ba8~1
+````
+
+- Now you will get the Interactive Rebase screen of git - you will see your commit in the first line:
+
+![2](http://s8.postimg.org/sz0avbymt/Screen_Shot_2016_02_08_at_16_42_51.png)
+
+
+- Notice the `pick` near you commit? great! we want to edit that commit, so use your `vi` skills and change the word `pick` to `edit`, than exit and save your changes in `vi` (ESC, `:`, and then `wq!`).
+
+- Great, now you in edit mode, and the repository is set to the commit you want to edit! ** so now make your changes to the file / files **
+
+- Done with that file? Great. to keep the original commit and apply the changes to it, run:
+
+`  git commit --all --no-edit --amend`
+
+That command will commit **all** the files you changed, without **edit the commit message**, and it will **amend** you changes into the original commit.
+
+- So now you are done with the changes and updating the commit, you will need to add the next commits on top of the new commit you edited. so you need to continue with the rebase process, do it by running:
+
+`  git rebase --continue`
+
+And if you noticed in any step on the change the you made a mistake, you can always abort the rebase by running:
+
+`  git rebase --abort`
+
+- In some cases, this is the last step, but in most of the times, you notice that after you continue the rebase operation, git stops and tells you that you have to merge because of conflicts. This makes sense - you changed a file in some point of the repository, but the commits that comes next, also changes it and it depends on the previous version of the file.
+
+- So in order to merge your conflict, I recommend to open your working directory in WebStorm, right click on the root of your project, and select "Git > Resolve Conflicts":
+![3](http://s12.postimg.org/4yxlr4llp/Screen_Shot_2016_02_08_at_16_58_04.png)
+
+- In the next screen, resolve you conflicts and ** DO NOT MAKE ANY GIT ACTION FROM WEBSTORM**
+
+- Now go back to the command line, and run: `git rebase --continue`, and you will get a screen that tells you to modify your commit message, you can just ignore it and save it as-is (ESC, `:` and then `wq!`).
+
+- If it's compilicated file that changes a lot of time, you might have multiple merges that needed to be done!
+- And you are done now! you just need to update your remote repository with the changes, but in order to do it, you need to `git push` with the `--force` flag, because now that you changed the history of you commits, the repositories no longer match! So run `git push --force origin YOUR_BRANCH` (replace YOUR_BRANCH with the branch you want to push to, **be carful! if you do not specify it, you will push it to the master and you might override the whole repo!**
+
+## How to only edit the commit message?
+
+So if you know how to edit commint (read the previous explaination), changing a commit message is much easier.
+
+You just need to perform the same `git rebase` as in the previous question, and instead of using `edit`, use `reword` (or just `r`), note that you can do it to multiple commits in the same time.
+
+Then you will see the commit message in the git shell screen, just change it and then exit and save from the vi.
+
+Then just continue the rebase (`git rebase --continue`) and push it.
+
+## How to remove entire commit?
+
+You just need to perform the same `git rebase` as in the previous question, and in the `vi` screen you get, just removed the entire line of the commit you want to remove (vi shortcut: `dd`), and then continue the rebase.
+
+## How to split commit into two or more commits?
+
+Splitting commits is a tricky one - there are some ways to to it, but I recommend to undo the commit if you still can (if it's the last one) and do it again in splitted commits.
+
+But if you can't undo it, you can still solve this issue:
+
+- Do `git rebase` to your commit minus two commits, that means for example: `git rebase d0021ab~2` (note the 2 instead of 1 in the end of the line), now the commit you want to split will be second in the commits list.
+- Remove the commit you want to split by removing it's line (vi shortcut: `dd`).
+- Go to the first commit in the list now (which is the commit that comes before the one you want to split), and set it to `edit` mode.
+- Now make you changes in a different commits, instead of one, perform them manually, and to commit each single change, use: `git commit --all` (Note that we did not use `amend` flag so we do not change the commit we set to edit mode!), and in that screen that opens, set the commit message. do that for each one of the commits.
+- Now just continue your rebase with `git rebase --continue` and finish it like any other change you made in the git history.
+
+## How to handle Meteor packages and versions?
+
+Actually, changing versions and packages in Meteor app should be the same, but there is a file that Meteor manages by it self, called `.meteor/versions` - this file contains the versions of all the packages you use in your app.
+
+So if you `git rebase` to specific commit and modify the packages or update a package version, make sure to run your app as you used to (for example: `meteor`) and wait until Meteor done with the build - in this point, a new `.meteor/versions` file will be generated, so make sure that you commit and update it aswell.
+
+But now you will notice that in every step that you done some change with the packages, you have a conflict and you have to merge - this merge will be very hard to perform because of two generated files with a lot of lines and versions of packages - you do not have to deal with it that way!
+
+First, mark the `.meteor/versions` file as resolved conflict (does matter it's content right now) , and then set the content of the file to empty content.
+
+Now run your app and wait for it to finish the build, and you will notice that Meteor generated the correct and updates `versions` file! Just commit that file now and continue the rebase!
+
+
+## How to create a new tutorial app?
+
+Creating a new tutorial described [here](http://meteor-tutorial-tools.readthedocs.org/en/latest/new-tutorial/).
+
+## Another goods
+
+#### Step tag and step diff
+
+So after creating a few steps in your tutorial, you can create a link that shown that entire diff between two steps (not sub-steps!), the actual does not related to the tutorial tools but very useful if you want to provide your users the ability to see the whole changes for each step of the tutorial.
+
+So in order to do that, make sure you create a Git Tag for each steps you finish (In the last commit of the step), you can do it with SourceTree or in GitHub, it does not matter.
+
+So after adding more that one step and one tag, you can add to your tutotial link to page that shows the entire diff, for example:
+
+https://github.com/Urigo/meteor-angular-socially/compare/step_01...step_02
+
+This link shows the entire diff between the tag `step_01` and `step_02`.
+
+Note that after each change you made in the commits that required a force `push`, you need to create the tags again!
+
+#### Download link for a step
+
+Another good you get is the ability to get a link to download the entire tutorial example, so users can jump to step and start it from there with the updated code!
+
+To do that, just add a link in your tutorial, like this:
+
+https://github.com/Urigo/meteor-angular-socially/archive/step_21.zip
+
+You need ofcourse to change the repository url, and replace `step_21` with the name of the tag you created (explained in the previous section).
+
+Thanks it! now you can just download the entire project in each step!
-- 
2.7.4

